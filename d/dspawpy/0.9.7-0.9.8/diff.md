# Comparing `tmp/dspawpy-0.9.7-py3-none-any.whl.zip` & `tmp/dspawpy-0.9.8-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,22 +1,22 @@
-Zip file size: 73209 bytes, number of entries: 20
--rw-rw-rw-  2.0 fat       23 b- defN 23-Jun-02 08:47 dspawpy/__init__.py
--rw-rw-rw-  2.0 fat    29208 b- defN 23-May-23 06:07 dspawpy/plot.py
+Zip file size: 75131 bytes, number of entries: 20
+-rw-rw-rw-  2.0 fat       23 b- defN 23-Jun-09 09:28 dspawpy/__init__.py
+-rw-rw-rw-  2.0 fat    30667 b- defN 23-Jun-09 09:28 dspawpy/plot.py
 -rw-rw-rw-  2.0 fat        0 b- defN 23-Apr-04 06:32 dspawpy/analysis/__init__.py
--rw-rw-rw-  2.0 fat    23645 b- defN 23-Jun-02 08:45 dspawpy/analysis/aimdtools.py
+-rw-rw-rw-  2.0 fat    24367 b- defN 23-Jun-09 09:28 dspawpy/analysis/aimdtools.py
 -rw-rw-rw-  2.0 fat    20152 b- defN 23-May-23 06:07 dspawpy/analysis/vacf.py
 -rw-rw-rw-  2.0 fat        0 b- defN 23-May-23 06:07 dspawpy/diffusion/__init__.py
--rw-rw-rw-  2.0 fat     3270 b- defN 23-Jun-02 08:39 dspawpy/diffusion/neb.py
--rw-rw-rw-  2.0 fat    53498 b- defN 23-Jun-02 08:45 dspawpy/diffusion/nebtools.py
+-rw-rw-rw-  2.0 fat     4028 b- defN 23-Jun-09 09:28 dspawpy/diffusion/neb.py
+-rw-rw-rw-  2.0 fat    56939 b- defN 23-Jun-09 09:28 dspawpy/diffusion/nebtools.py
 -rw-rw-rw-  2.0 fat    11045 b- defN 23-May-23 06:07 dspawpy/diffusion/pathfinder.py
 -rw-rw-rw-  2.0 fat        0 b- defN 23-Apr-04 08:25 dspawpy/io/__init__.py
--rw-rw-rw-  2.0 fat    53355 b- defN 23-May-23 06:07 dspawpy/io/read.py
+-rw-rw-rw-  2.0 fat    54091 b- defN 23-Jun-09 09:28 dspawpy/io/read.py
 -rw-rw-rw-  2.0 fat     7721 b- defN 23-May-23 06:07 dspawpy/io/read_json.py
--rw-rw-rw-  2.0 fat     9880 b- defN 23-May-23 06:07 dspawpy/io/structure.py
--rw-rw-rw-  2.0 fat    25239 b- defN 23-May-23 06:07 dspawpy/io/utils.py
--rw-rw-rw-  2.0 fat    26180 b- defN 23-Jun-02 08:46 dspawpy/io/write.py
+-rw-rw-rw-  2.0 fat    10317 b- defN 23-Jun-09 08:47 dspawpy/io/structure.py
+-rw-rw-rw-  2.0 fat    27299 b- defN 23-Jun-09 09:28 dspawpy/io/utils.py
+-rw-rw-rw-  2.0 fat    29663 b- defN 23-Jun-09 09:28 dspawpy/io/write.py
 -rw-rw-rw-  2.0 fat     1761 b- defN 23-May-23 06:07 dspawpy/io/write_json.py
--rw-rw-rw-  2.0 fat     3075 b- defN 23-Jun-02 08:47 dspawpy-0.9.7.dist-info/METADATA
--rw-rw-rw-  2.0 fat       92 b- defN 23-Jun-02 08:47 dspawpy-0.9.7.dist-info/WHEEL
--rw-rw-rw-  2.0 fat        8 b- defN 23-Jun-02 08:47 dspawpy-0.9.7.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     1582 b- defN 23-Jun-02 08:47 dspawpy-0.9.7.dist-info/RECORD
-20 files, 269734 bytes uncompressed, 70659 bytes compressed:  73.8%
+-rw-rw-rw-  2.0 fat     4282 b- defN 23-Jun-09 09:29 dspawpy-0.9.8.dist-info/METADATA
+-rw-rw-rw-  2.0 fat       92 b- defN 23-Jun-09 09:29 dspawpy-0.9.8.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat        8 b- defN 23-Jun-09 09:29 dspawpy-0.9.8.dist-info/top_level.txt
+?rw-rw-r--  2.0 fat     1583 b- defN 23-Jun-09 09:29 dspawpy-0.9.8.dist-info/RECORD
+20 files, 284038 bytes uncompressed, 72581 bytes compressed:  74.4%
```

## zipnote {}

```diff
@@ -42,20 +42,20 @@
 
 Filename: dspawpy/io/write.py
 Comment: 
 
 Filename: dspawpy/io/write_json.py
 Comment: 
 
-Filename: dspawpy-0.9.7.dist-info/METADATA
+Filename: dspawpy-0.9.8.dist-info/METADATA
 Comment: 
 
-Filename: dspawpy-0.9.7.dist-info/WHEEL
+Filename: dspawpy-0.9.8.dist-info/WHEEL
 Comment: 
 
-Filename: dspawpy-0.9.7.dist-info/top_level.txt
+Filename: dspawpy-0.9.8.dist-info/top_level.txt
 Comment: 
 
-Filename: dspawpy-0.9.7.dist-info/RECORD
+Filename: dspawpy-0.9.8.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## dspawpy/__init__.py

```diff
@@ -1 +1 @@
-__version__ = "0.9.7"
+__version__ = "0.9.8"
```

## dspawpy/plot.py

```diff
@@ -16,15 +16,15 @@
     task: str = "potential",
     axis=2,
     smooth=False,
     smooth_frac=0.8,
     raw=False,
     **kwargs,
 ):
-    """绘制沿着某个轴向的物理量平均值曲线
+    r"""绘制沿着某个轴向的物理量平均值曲线
 
     Parameters
     ----------
     datafile : str or list or np.ndarray
         h5或json文件路径或包含任意这些文件的文件夹，默认 'potential.h5'
     task: str
         任务类型，可以是 'rho', 'potential', 'elf', 'pcharge', 'boundcharge'
@@ -43,16 +43,19 @@
     -------
     axes: matplotlib.axes._subplots.AxesSubplot
         可传递给其他函数进行进一步处理
 
     Examples
     --------
     >>> from dspawpy.plot import average_along_axis
-    # 读取 potential.h5 文件中的数据，绘图并保存原始绘图数据到csv文件
-    >>> average_along_axis(datafile='potential.h5', task='potential', axis=2, smooth=True, smooth_frac=0.8, raw=True)
+
+    读取 potential.h5 文件中的数据，绘图并保存原始绘图数据到csv文件
+
+    >>> average_along_axis(datafile='/data/home/hzw1002/dspawpy_repo/test/2.7/potential.h5', task='potential', axis=2, smooth=True, smooth_frac=0.8, raw=True)
+    <module 'matplotlib.pyplot' from '/data/home/hzw1002/anaconda3/lib/python3.9/site-packages/matplotlib/pyplot.py'>
     """
     assert task.lower() in [
         "rho",
         "potential",
         "elf",
         "pcharge",
         "boundcharge",
@@ -139,50 +142,60 @@
 
     return plt
 
 
 def plot_aimd(
     datafile: str = "aimd.h5",
     show: bool = True,
-    figName: str = "aimd.png",
+    figname: str = "aimd.png",
     flags_str="12345",
     raw=False,
 ):
-    """AIMD任务完成后，绘制关键物理量的收敛过程图
+    r"""AIMD任务完成后，绘制关键物理量的收敛过程图
 
     aimd.h5 -> aimd.png
 
     Parameters
     ----------
     datafile : str or list
         h5文件位置. 例如 'aimd.h5' 或 ['aimd.h5', 'aimd2.h5']
     show : bool
         是否展示交互界面. 默认 False
-    figName : str
+    figname : str
         保存的图片路径. 默认 'aimd.h5'
     flags_str : str
         子图编号.
         1. 动能
         2. 总能
         3. 压力
         4. 温度
         5. 体积
     raw : bool
         是否输出原始数据到csv文件
 
     Returns
     ----------
-    figName : str
+    figname : str
         图片路径，默认 'aimd.png'
 
     Examples
     ----------
     >>> from dspawpy.plot import plot_aimd
-    # 读取 aimd.h5 文件内容，画出动能、总能、温度、体积的收敛过程图，并保存相应数据到 rawaimd_*.csv 中
-    >>> plot_aimd(datafile='aimd.h5', flags_str='1245', raw=True)
+
+    读取 aimd.h5 文件内容，画出动能、总能、温度、体积的收敛过程图，并保存相应数据到 rawaimd_*.csv 中
+
+    >>> plot_aimd(datafile='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5', flags_str='1245', raw=False, show=False, figname=None)
+    正在处理子图1
+     reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
+    正在处理子图2
+     reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
+    正在处理子图4
+     reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
+    正在处理子图5
+     reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     """
     # 处理用户读取，按顺序去重
     temp = set()
     flags = [x for x in flags_str if x not in temp and (temp.add(x) or True)]
     if " " in flags:  # remove space
         flags.remove(" ")
 
@@ -211,26 +224,29 @@
         elif flag == "3":
             axes[i].set_ylabel("Pressure Kinetic (kbar)")
         elif flag == "4":
             axes[i].set_ylabel("Temperature (K)")
         else:
             axes[i].set_ylabel("Volume (Angstrom^3)")
 
-    fig.tight_layout()
-    plt.savefig(figName)
+    plt.tight_layout()
+    # save and show
+    if figname:
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
+        plt.savefig(figname)
+        print(f"--> 图片已保存为 {os.path.abspath(figname)}")
     if show:
         plt.show()
 
-    print(f"--> 图片已保存为 {os.path.abspath(figName)}")
-
 
 def plot_bandunfolding(
     datafile: str = "band.h5", ef=0.0, de=0.05, dele=0.06, raw=False
 ):
-    """能带反折叠任务完成后，读取 h5 或 json 文件数据绘图
+    r"""能带反折叠任务完成后，读取 h5 或 json 文件数据绘图
 
     band.h5/band.json -> bandunfolding.png
 
     Parameters
     ----------
     datafile : str
         h5或json文件路径或包含任意这些文件的文件夹，默认 'band.h5'
@@ -246,19 +262,21 @@
     Returns
     -------
     axes: matplotlib.axes._subplots.AxesSubplot
         可传递给其他函数进行进一步处理
 
     Examples
     --------
+
+    绘图并保存原始数据到rawbandunfolding.csv
+
     >>> from dspawpy.plot import plot_bandunfolding
-    # 直接绘图
-    >>> plot_bandunfolding("band.h5")
-    # 绘图并保存原始数据到rawbandunfolding.csv
-    >>> plot_bandunfolding("band.h5", raw=True)
+    >>> plot_bandunfolding("/data/home/hzw1002/dspawpy_repo/test/2.22/band.h5", raw=True)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.22/band.h5...
+    <module 'matplotlib.pyplot' from '/data/home/hzw1002/anaconda3/lib/python3.9/site-packages/matplotlib/pyplot.py'>
     """
     # search datafile in the given directory
     if os.path.isdir(datafile):
         directory = datafile  # specified datafile is actually a directory
         print("您指定了一个文件夹，正在查找相关h5或json文件...")
         if os.path.exists(os.path.join(directory, "band.h5")):
             datafile = os.path.join(directory, "band.h5")
@@ -266,19 +284,27 @@
         elif os.path.exists(os.path.join(directory, "band.json")):
             datafile = os.path.join(directory, "band.json")
             print("Reading band.json...")
         else:
             raise FileNotFoundError("未找到band.h5/band.json文件！")
 
     if datafile.endswith(".h5"):
-        band = load_h5(datafile)
-        number_of_band = band["/BandInfo/NumberOfBand"][0]
-        number_of_kpoints = band["/BandInfo/NumberOfKpoints"][0]
-        data = band["/UnfoldingBandInfo/Spin1/UnfoldingBand"]
-        weight = band["/UnfoldingBandInfo/Spin1/Weight"]
+        # band = load_h5(datafile)
+        import h5py
+
+        print(f"Reading {os.path.abspath(datafile)}...")
+        f = h5py.File(datafile, "r")
+        number_of_band = np.array(f["/BandInfo/NumberOfBand"])[0]
+        # number_of_band = band["/BandInfo/NumberOfBand"][0]
+        number_of_kpoints = np.array(f["/BandInfo/NumberOfKpoints"])[0]
+        # number_of_kpoints = band["/BandInfo/NumberOfKpoints"][0]
+        data = np.array(f["/UnfoldingBandInfo/Spin1/UnfoldingBand"])
+        # data = band["/UnfoldingBandInfo/Spin1/UnfoldingBand"]
+        weight = np.array(f["/UnfoldingBandInfo/Spin1/Weight"])
+        # weight = band["/UnfoldingBandInfo/Spin1/Weight"]
     elif datafile.endswith(".json"):
         with open(datafile, "r") as f:
             band = json.load(f)
         number_of_band = band["BandInfo"]["NumberOfBand"]
         number_of_kpoints = band["BandInfo"]["NumberOfKpoints"]
         data = band["UnfoldingBandInfo"]["Spin1"]["UnfoldingBand"]
         weight = band["UnfoldingBandInfo"]["Spin1"]["Weight"]
@@ -330,19 +356,20 @@
     Returns
     -------
     axes: matplotlib.axes._subplots.AxesSubplot
         可传递给其他函数进行进一步处理
 
     Examples
     --------
+
+    绘图并保存原始数据到rawoptical.csv
+
     >>> from dspawpy.plot import plot_optical
-    # 直接绘图
-    >>> plot_optical("optical.h5", "AbsorptionCoefficient", 0)
-    # 绘图并保存原始数据到rawoptical.csv
-    >>> plot_optical("optical.h5", "AbsorptionCoefficient", 0, raw=True)
+    >>> plot_optical("/data/home/hzw1002/dspawpy_repo/test/2.12/scf.h5", "AbsorptionCoefficient", 0, raw=True)
+    >>> plot_optical("/data/home/hzw1002/dspawpy_repo/test/2.12/optical.json", "AbsorptionCoefficient", 0, raw=True)
     """
     # search datafile in the given directory
     if os.path.isdir(datafile):
         directory = datafile  # specified datafile is actually a directory
         print("您指定了一个文件夹，正在查找相关h5或json文件...")
         if os.path.exists(os.path.join(directory, "optical.h5")):
             datafile = os.path.join(directory, "optical.h5")
@@ -403,24 +430,23 @@
     show : bool
         是否弹出交互界面
     raw : bool
         是否保存原始数据到rawphonon.csv文件
 
     Returns
     ----------
-    figName : str
+    figname : str
         图片路径，默认 'phonon.png'
 
     Examples
     --------
     >>> from dspawpy.plot import plot_phonon_thermal
-    # 保存图片为phonon.png并弹出交互界面
-    >>> plot_phonon_thermal('phonon.h5', figname='phonon.png', show=True)
-    # 也可以给定计算文件夹路径
-    >>> plot_phonon_thermal('my_phonon_task', figname='phonon.png', show=True)
+    >>> plot_phonon_thermal('/data/home/hzw1002/dspawpy_repo/test/2.26/phonon.h5', figname='/data/home/hzw1002/dspawpy_repo/test/out/phonon_thermal.png', show=False)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.26/phonon.h5...
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/test/out/phonon_thermal.png
     """
     # search datafile in the given directory
     if os.path.isdir(datafile):
         directory = datafile  # specified datafile is actually a directory
         print("您指定了一个文件夹，正在查找相关h5或json文件...")
         if os.path.exists(os.path.join(directory, "phonon.h5")):
             datafile = os.path.join(directory, "phonon.h5")
@@ -431,14 +457,18 @@
         else:
             raise FileNotFoundError("未找到phonon.h5/phonon.json文件！")
 
     if datafile.endswith(".h5"):
         hfile = datafile
         ph = h5py.File(hfile, "r")
         print(f"Reading {hfile}...")
+        if "/ThermalInfo/Temperatures" not in ph:
+            raise KeyError(
+                "❓ No thermal info in datafile, you probably gave a wrong phonon.h5 file"
+            )
         temp = np.array(ph["/ThermalInfo/Temperatures"])
         entropy = np.array(ph["/ThermalInfo/Entropy"])
         heat_capacity = np.array(ph["/ThermalInfo/HeatCapacity"])
         helmholts_free_energy = np.array(ph["/ThermalInfo/HelmholtzFreeEnergy"])
     elif datafile.endswith(".json"):
         jfile = datafile
         with open(jfile, "r") as f:
@@ -468,58 +498,64 @@
     )
     plt.xlabel("Temperature(K)")
     plt.ylabel("Thermal Properties")
     plt.tick_params(direction="in")  # 刻度线朝内
     plt.grid(alpha=0.2)
     plt.legend()
     plt.title("Thermal")
+
+    plt.tight_layout()
+    # save and show
     if figname:
-        plt.tight_layout()
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
         plt.savefig(figname)
-        print("Figure saved as {}".format(figname))
-
+        print(f"--> 图片已保存为 {os.path.abspath(figname)}")
     if show:
         plt.show()
 
 
 def plot_polarization_figure(
     directory: str,
     repetition: int = 2,
     annotation: bool = False,
     annotation_style: int = 1,
     show: bool = True,
-    fig_name: str = "pol.png",
+    figname: str = "pol.png",
     raw=False,
 ):
     """绘制铁电极化结果图
 
     Parameters
     ----------
     directory : str
         铁电极化计算任务主目录
     repetition : int
         沿上（或下）方向重复绘制的次数, 默认 2
     annotation : bool
         是否显示首尾构型的铁电极化数值, 默认显示
     show : bool
         是否交互显示图片, 默认 True
-    fig_name : str
+    figname : str
         图片保存路径, 默认 'pol.png'
     raw : bool
         是否将原始数据保存到csv文件
 
     Returns
     -------
     axes: matplotlib.axes._subplots.AxesSubplot
         可传递给其他函数进行进一步处理
 
     Examples
     --------
     >>> from dspawpy.plot import plot_polarization_figure
-    >>> plot_polarization_figure(directory='.', fig_name='pol.png')
+    >>> plot_polarization_figure(directory='/data/home/hzw1002/dspawpy_repo/test/2.20', figname='/data/home/hzw1002/dspawpy_repo/test/out/pol.png', show=False)
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/test/out/pol.png
+    array([<Axes: title={'center': 'Px'}>, <Axes: title={'center': 'Py'}>,
+           <Axes: title={'center': 'Pz'}>], dtype=object)
     """
     assert repetition >= 0, "重复次数必须是自然数"
     subfolders, quantum, totals = _get_subfolders_quantum_totals(directory)
     number_sfs = [int(sf) for sf in subfolders]
     fig, axes = plt.subplots(1, 3, sharey=True)
     xyz = ["x", "y", "z"]
     for j in range(3):  # x, y, z
@@ -587,17 +623,20 @@
             else:
                 raise ValueError("annotation_style must be 1 or 2")
 
         if raw:
             pd.DataFrame(ys, index=subfolders).to_csv(f"pol_{xyz[j]}.csv")
 
     plt.tight_layout()
-    if fig_name:
-        plt.savefig(fig_name)
-        print(f"--> saved to {fig_name}")
+    # save and show
+    if figname:
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
+        plt.savefig(figname)
+        print(f"--> 图片已保存为 {os.path.abspath(figname)}")
     if show:
         plt.show()
 
     return axes
 
 
 def _get_subfolders_quantum_totals(directory: str):
@@ -614,72 +653,56 @@
     -------
     subfolders : list
         子目录列表
     quantum : np.ndarray
         量子数，xyz三个方向, shape=(1, 3)
     totals : np.ndarray
         极化总量，xyz三个方向, shape=(len(subfolders), 3)
-
-    Examples
-    --------
-    >>> from dspawpy.plot import get_subfolders_quantum_totals
-    >>> directory = '.' # current directory
-    >>> subfolders, quantum, totals = get_subfolders_quantum_totals(directory)
-    >>> subfolders
-    ['S00', 'S01', 'S06', 'S02', 'S07', 'S03', 'S08', 'S04', 'S10', 'S09', 'S05', 'S11']
-    >>> quantum
-    array([60.06722499, 60.38782135, 62.58443595])
-    >>> totals
-    array([[-4.28508315e-05, -8.71560447e+00, -1.95833103e-06],
-           [-2.67572295e-05,  6.03528774e+00, -3.07857463e-06],
-           [-2.14180047e-05,  5.74655747e+00,  1.54336369e-05],
-           [-6.11371699e-05,  1.92736107e+01, -2.87951455e-05],
-           [ 3.98336164e-05,  1.72479105e+01, -2.75634797e-06],
-           [ 1.20422859e-05, -2.89108722e+01, -1.72015009e-05],
-           [ 5.23329032e-05,  2.89106070e+01, -5.19480945e-06],
-           [-2.86362371e-05, -1.72479598e+01, -3.61790588e-05],
-           [-5.52844691e-05, -6.03482453e+00, -2.71118952e-05],
-           [-3.63338519e-05, -1.92737729e+01, -6.94462350e-06],
-           [ 9.30116520e-06, -5.74668477e+00,  2.91334059e-05],
-           [-4.53814037e-05,  8.71545041e+00,  1.18885825e-06]])
     """
 
     raw_subfolders = next(os.walk(directory))[1]
     subfolders = []
     for subfolder in raw_subfolders:
+        assert (
+            0 <= int(subfolder) < 100
+        ), f"--> You should rename subfolders to 0~99, but {subfolder} found"
         try:
             assert 0 <= int(subfolder) < 100
             subfolders.append(subfolder)
         except:
             pass
     subfolders.sort()  # 从小到大排序
-    if os.path.exists(f"{subfolders[0]}/polarization.json"):
+    if os.path.exists(f"{os.path.join(directory, subfolders[0])}/polarization.json"):
         # quantum number if constant across the whole calculation,
         # so, read only once
-        with open(f"{subfolders[0]}/polarization.json", "r") as f:
+        with open(
+            f"{os.path.join(directory, subfolders[0])}/polarization.json", "r"
+        ) as f:
             quantum = json.load(f)["PolarizationInfo"]["Quantum"]
         # the Total number is not constant
         totals = np.empty(shape=(len(subfolders), 3))
         for i, fd in enumerate(subfolders):
-            with open("%s/polarization.json" % fd, "r") as f:
+            with open(f"{os.path.join(directory, fd)}/polarization.json", "r") as f:
                 data = json.load(f)
             total = data["PolarizationInfo"]["Total"]
             print("Total: ", total)
             totals[i] = float(total)
 
-    elif os.path.exists(f"{subfolders[0]}/scf.h5"):
+    elif os.path.exists(f"{os.path.join(directory, subfolders[0])}/scf.h5"):
         # quantum number if constant across the whole calculation,
         # so, read only once
         quantum = np.array(
-            h5py.File(f"{subfolders[0]}/scf.h5").get("/PolarizationInfo/Quantum")
+            h5py.File(f"{os.path.join(directory, subfolders[0])}/scf.h5").get(
+                "/PolarizationInfo/Quantum"
+            )
         )
         # the Total number is not constant
         totals = np.empty(shape=(len(subfolders), 3))
         for i, fd in enumerate(subfolders):
-            data = h5py.File("./%s/scf.h5" % fd)
+            data = h5py.File(f"{os.path.join(directory, fd)}/scf.h5")
             total = np.array(data.get("/PolarizationInfo/Total"))
             totals[i] = total
     else:
         raise ValueError("no polarization.json or scf.h5 file found")
 
     return subfolders, quantum, totals
```

## dspawpy/analysis/aimdtools.py

```diff
@@ -315,22 +315,23 @@
         时间序列
     result : np.ndarray
         均方差序列
 
     Examples
     --------
     >>> from dspawpy.analysis.aimdtools import get_lagtime_msd
-    >>> lagtime, msd = get_lagtime_msd(datafile='test/aimd.h5', select='all', msd_type='xyz', timestep=1.0)
-    Reading E:\Dev\dspawpy\test\aimd.h5 ...
+    >>> lagtime, msd = get_lagtime_msd(datafile='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5')
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     Calculating MSD...
     >>> lagtime
-    array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])
+    array([0.000e+00, 1.000e+00, 2.000e+00, ..., 1.997e+03, 1.998e+03,
+           1.999e+03])
     >>> msd
-    array([0.        , 0.00234419, 0.00872255, 0.01706176, 0.02451864,
-           0.02963004, 0.03378312, 0.0395548 , 0.04852066, 0.0596252 ])
+    array([0.00000000e+00, 4.04296586e-02, 9.35606189e-02, ...,
+           6.47011135e+03, 6.47105880e+03, 6.47194457e+03])
     """
     strs = build_Structures_from_datafile(datafile)
 
     msd = MSD(strs, select, msd_type)
     result = msd.run()
 
     nframes = msd.n_frames
@@ -356,22 +357,23 @@
         时间序列
     rmsd : numpy.ndarray
         均方根序列
 
     Examples
     --------
     >>> from dspawpy.analysis.aimdtools import get_lagtime_rmsd
-    >>> lagtime, rmsd = get_lagtime_rmsd(datafile='test/aimd.h5', timestep=1.0)
-    Reading E:\Dev\dspawpy\test\aimd.h5 ...
+    >>> lagtime, rmsd = get_lagtime_rmsd(datafile='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5', timestep=0.1)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     Calculating RMSD...
     >>> lagtime
-    array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])
+    array([0.000e+00, 1.000e-01, 2.000e-01, ..., 1.997e+02, 1.998e+02,
+           1.999e+02])
     >>> rmsd
-    array([0.        , 0.03987827, 0.06727018, 0.09707005, 0.14068665,
-           0.1778412 , 0.18981011, 0.19410218, 0.21498126, 0.24418271])
+    array([0.00000000e+00, 3.56025899e-02, 6.28159066e-02, ...,
+           8.04616858e+01, 8.04569185e+01, 8.04483969e+01])
     """
     strs = build_Structures_from_datafile(datafile)
 
     rmsd = RMSD(structures=strs)
     result = rmsd.run()
 
     # Plot
@@ -416,50 +418,44 @@
         径向分布网格点
     rdf : numpy.ndarray
         径向分布函数
 
     Examples
     --------
     >>> from dspawpy.analysis.aimdtools import get_rs_rdfs
-    >>> rs, rdfs = get_rs_rdfs(datafile='test/aimd.h5', ele1='H', ele2='O', rmin=0, rmax=10, ngrid=101, sigma=0)
-    Reading E:\Dev\dspawpy\test\aimd.h5 ...
+    >>> rs, rdfs = get_rs_rdfs(datafile='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5',ele1='H',ele2='O')
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     Calculating RDF...
-    >>> rs
-    array([ 0. ,  0.1,  0.2,  0.3,  0.4,  0.5,  0.6,  0.7,  0.8,  0.9,  1. ,
-            1.1,  1.2,  1.3,  1.4,  1.5,  1.6,  1.7,  1.8,  1.9,  2. ,  2.1,
-            2.2,  2.3,  2.4,  2.5,  2.6,  2.7,  2.8,  2.9,  3. ,  3.1,  3.2,
-            3.3,  3.4,  3.5,  3.6,  3.7,  3.8,  3.9,  4. ,  4.1,  4.2,  4.3,
-            4.4,  4.5,  4.6,  4.7,  4.8,  4.9,  5. ,  5.1,  5.2,  5.3,  5.4,
-            5.5,  5.6,  5.7,  5.8,  5.9,  6. ,  6.1,  6.2,  6.3,  6.4,  6.5,
-            6.6,  6.7,  6.8,  6.9,  7. ,  7.1,  7.2,  7.3,  7.4,  7.5,  7.6,
-            7.7,  7.8,  7.9,  8. ,  8.1,  8.2,  8.3,  8.4,  8.5,  8.6,  8.7,
-            8.8,  8.9,  9. ,  9.1,  9.2,  9.3,  9.4,  9.5,  9.6,  9.7,  9.8,
-            9.9, 10. ])
     >>> rdfs
-    array([0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.00458757,
-           0.00495436, 0.00307412, 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        , 0.        , 0.        , 0.        , 0.        ,
-           0.        ])
+    array([0.00000000e+00, 0.00000000e+00, 4.66650481e-04, 9.30940287e-04,
+           3.52585381e-04, 1.26407382e-03, 1.25318841e-03, 1.50559377e-03,
+           1.11044305e-03, 2.60362277e-03, 2.84955254e-03, 1.98326911e-03,
+           1.25972719e-03, 8.84132365e-04, 5.74489287e-04, 4.16191635e-04,
+           1.31901135e-04, 1.88536303e-04, 1.16355309e-04, 1.19347145e-04,
+           5.65480311e-05, 3.78209587e-05, 2.34431565e-05, 1.10925032e-05,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00, 0.00000000e+00, 0.00000000e+00, 0.00000000e+00,
+           0.00000000e+00])
     """
     strs = build_Structures_from_datafile(datafile)
     # print(strs[0]) # check pbc
     # raise ValueError
 
     # 计算rdf并绘制主要曲线
     obj = RDF(structures=strs, rmin=rmin, rmax=rmax, ngrid=ngrid, sigma=sigma)
@@ -505,22 +501,22 @@
 
     Examples
     --------
     >>> from dspawpy.analysis.aimdtools import get_lagtime_msd, plot_msd
 
     指定h5文件位置，用 get_lagtime_msd 函数获取数据，select 参数选择第n个原子（不是元素）
 
-    >>> lagtime, msd = get_lagtime_msd('test/aimd.h5', select=[0])
-    Reading E:\Dev\dspawpy\test\aimd.h5 ...
+    >>> lagtime, msd = get_lagtime_msd('/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5', select=[0])
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     Calculating MSD...
 
     用获取的数据画图并保存
 
-    >>> plot_msd(lagtime, msd, figname='test/MSD.png', show=False)
-    MSD图片保存在 E:\Dev\dspawpy\test\MSD.png
+    >>> plot_msd(lagtime, msd, figname='/data/home/hzw1002/dspawpy_repo/test/out/MSD.png', show=False)
+    MSD图片保存在 /data/home/hzw1002/dspawpy_repo/test/out/MSD.png
     <Axes: xlabel='Time (fs)', ylabel='MSD (Å)'>
     """
     if ax:
         ishow = False
         ax.plot(lagtime, result, c="black", ls="-", **kwargs)
     else:
         ishow = True
@@ -530,18 +526,21 @@
         ax.set_ylabel("MSD (Å)")
 
     if xlim:
         ax.set_xlim(xlim)
     if ylim:
         ax.set_ylim(ylim)
 
+    plt.tight_layout()
     if figname:
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
         plt.savefig(figname)
         print("MSD图片保存在", os.path.abspath(figname))
-    if ishow and show:  # 画子图的话，不应每个子图都show
+    if show and ishow:  # 画子图的话，不应每个子图都show
         plt.show()  # show会自动清空图片
 
     return ax
 
 
 def plot_rdf(
     rs: np.ndarray,
@@ -586,32 +585,35 @@
 
     Examples
     --------
     >>> from dspawpy.analysis.aimdtools import get_rs_rdfs, plot_rdf
 
     先获取rs和rdfs数据作为xy轴数据
 
-    >>> rs, rdfs = get_rs_rdfs('test/aimd.h5', 'H', 'O', rmax=6)
-    Reading E:\Dev\dspawpy\test\aimd.h5 ...
+    >>> rs, rdfs = get_rs_rdfs('/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5', 'H', 'O', rmax=6)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     Calculating RDF...
 
     将xy轴数据传入plot_rdf函数绘图
 
-    >>> plot_rdf(rs, rdfs, 'H','O', figname='test/RDF.png', show=False)
-    图片已保存到 E:\Dev\dspawpy\test\RDF.png
+    >>> plot_rdf(rs, rdfs, 'H','O', figname='/data/home/hzw1002/dspawpy_repo/test/out/RDF.png', show=False)
+    图片已保存到 /data/home/hzw1002/dspawpy_repo/test/out/RDF.png
     """
+
     if ax:
+        ishow = False
         ax.plot(
             rs,
             rdfs,
             label=r"$g_{\alpha\beta}(r)$" + f"[{ele1},{ele2}]",
             **kwargs,
         )
 
     else:
+        ishow = True
         fig, ax = plt.subplots()
         ax.plot(
             rs,
             rdfs,
             label=r"$g_{\alpha\beta}(r)$" + f"[{ele1},{ele2}]",
             **kwargs,
         )
@@ -623,18 +625,21 @@
 
     # 绘图细节
     if xlim:
         ax.set_xlim(xlim)
     if ylim:
         ax.set_ylim(ylim)
 
+    plt.tight_layout()
     if figname:
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
         plt.savefig(figname)
         print(f"图片已保存到 {os.path.abspath(figname)}")
-    if show:  # 画子图的话，不应每个子图都show
+    if show and ishow:  # 画子图的话，不应每个子图都show
         plt.show()  # show会自动清空图片
 
 
 def plot_rmsd(
     lagtime: np.ndarray,
     result: np.ndarray,
     xlim: list = None,
@@ -671,22 +676,22 @@
 
     Examples
     --------
     >>> from dspawpy.analysis.aimdtools import get_lagtime_rmsd, plot_rmsd
 
     timestep 表示时间步长
 
-    >>> lagtime, rmsd = get_lagtime_rmsd(datafile='test/aimd.h5', timestep=0.1)
-    Reading E:\Dev\dspawpy\test\aimd.h5 ...
+    >>> lagtime, rmsd = get_lagtime_rmsd(datafile='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5', timestep=0.1)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
     Calculating RMSD...
 
     直接保存为RMSD.png图片
 
-    >>> plot_rmsd(lagtime, rmsd, figname='test/RMSD.png', show=False)
-    图片已保存到 E:\Dev\dspawpy\test\RMSD.png
+    >>> plot_rmsd(lagtime, rmsd, figname='/data/home/hzw1002/dspawpy_repo/test/out/RMSD.png', show=False)
+    图片已保存到 /data/home/hzw1002/dspawpy_repo/test/out/RMSD.png
     <Axes: xlabel='Time (fs)', ylabel='RMSD (Å)'>
     """
     # 参数初始化
     if not ax:
         ishow = True
     else:
         ishow = False
@@ -700,14 +705,17 @@
         ax.set_ylabel("RMSD (Å)")
 
     if xlim:
         ax.set_xlim(xlim)
     if ylim:
         ax.set_ylim(ylim)
 
+    plt.tight_layout()
     if figname:
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
         plt.savefig(figname)
         print(f"图片已保存到 {os.path.abspath(figname)}")
     if show and ishow:  # 画子图的话，不应每个子图都show
         plt.show()  # show会自动清空图片
 
     return ax
```

## dspawpy/diffusion/neb.py

```diff
@@ -47,66 +47,69 @@
     ):
         return self.iddp.run(maxiter, tol, gtol, step_size, max_disp, spring_const)
 
 
 def write_neb_structures(
     structures,
     coords_are_cartesian=True,
-    fmt: str = "json",
+    fmt: str = "as",
     path: str = ".",
     prefix="structure",
 ):
     r"""插值并生成中间构型文件
 
     Parameters
     ----------
     structures: list
         构型列表
     coords_are_cartesian: bool
         坐标是否为笛卡尔坐标
     fmt: str
-        结构文件类型，支持 "json", "as", "poscar", "hzw"
+        结构文件类型，默认为 "as"
     path: str
         保存路径
+    prefix: str
+        文件名前缀，默认为 "structure"，这样的话生成的就是 structure00.as, structure01.as, ...
 
     Returns
     -------
     file
         保存构型文件
 
     Examples
     --------
 
     先读取as文件创建structure对象
 
     >>> from dspawpy.io.structure import build_Structures_from_datafile
-    >>> initial_structure = build_Structures_from_datafile("test/initial.as")[0]
-    >>> final_structure = build_Structures_from_datafile("test/final.as")[0]
+    >>> from dspawpy.diffusion.nebtools import write_movie_json
+
+    >>> init_struct = build_Structures_from_datafile("/data/home/hzw1002/dspawpy_repo/test/2.15/00/structure00.as")[0]
+    >>> final_struct = build_Structures_from_datafile("/data/home/hzw1002/dspawpy_repo/test/2.15/04/structure04.as")[0]
 
     然后，插值并生成中间构型文件
 
     >>> from dspawpy.diffusion.neb import NEB,write_neb_structures
-    >>> neb = NEB(initial_structure,final_structure,3) # 计划获取3个构型
-    >>> structures = neb.idpp_interpolate() # idpp插值，生成中间构型
+    >>> neb = NEB(init_struct,final_struct,8)
+    >>> structures = neb.linear_interpolate()   #线性插值
 
     插值完成的构型可指定保存到neb文件夹下
 
-    >>> write_neb_structures(structures,coords_are_cartesian=True,fmt="as",path="test/neb")
-    --> 成功写入文件 E:\Dev\dspawpy\test\neb\00\structure00.as
-    --> 成功写入文件 E:\Dev\dspawpy\test\neb\01\structure01.as
-    --> 成功写入文件 E:\Dev\dspawpy\test\neb\02\structure02.as
+    >>> write_neb_structures(structures, fmt="as", path="/data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures")
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/00/structure00.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/01/structure01.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/02/structure02.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/03/structure03.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/04/structure04.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/05/structure05.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/06/structure06.as
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/11neb_interpolate_structures/07/structure07.as
     """
+    assert fmt is not None
     N = len(str(len(structures)))
     if N <= 2:
         N = 2
     for i, structure in enumerate(structures):
         path_name = str(i).zfill(N)
         os.makedirs(os.path.join(path, path_name), exist_ok=True)
-        if fmt == "poscar":
-            structure.to(fmt="poscar", filename=os.path.join(path, path_name, "POSCAR"))
-        else:
-            filename = os.path.join(
-                path, path_name, "%s%s.%s" % (prefix, path_name, fmt)
-            )
-            to_file(
-                structure, filename, coords_are_cartesian=coords_are_cartesian, fmt=fmt
-            )
+        filename = os.path.join(path, path_name, "%s%s.%s" % (prefix, path_name, fmt))
+        to_file(structure, filename, fmt, coords_are_cartesian)
```

## dspawpy/diffusion/nebtools.py

```diff
@@ -1,25 +1,37 @@
 import json
 import os
+import shutil
 
 import h5py
 import numpy as np
 import pandas as pd
 
 np.set_printoptions(suppress=True)  # 不使用科学计数法
+import zipfile
+
 import matplotlib.pyplot as plt
 
-from dspawpy.io.read import pel_from_as
+from dspawpy.io.structure import build_Structures_from_datafile
 from dspawpy.io.utils import get_ele_from_h5
 
 
+def _zip_folder(folder_path, output_path):
+    with zipfile.ZipFile(output_path, "w", zipfile.ZIP_DEFLATED) as zipf:
+        for root, _, files in os.walk(folder_path):
+            for file in files:
+                file_path = os.path.join(root, file)
+                zipf.write(file_path, os.path.relpath(file_path, folder_path))
+    print(f"已将{folder_path}压缩到{output_path}")
+
+
 def get_distance(
     spo1: np.ndarray, spo2: np.ndarray, lat1: np.ndarray, lat2: np.ndarray
 ):
-    """根据两个结构的分数坐标和晶胞计算距离
+    r"""根据两个结构的分数坐标和晶胞计算距离
 
     Parameters
     ----------
     spo1 : np.ndarray
         分数坐标列表1
     spo2 : np.ndarray
         分数坐标列表2
@@ -32,90 +44,75 @@
     -------
     float
         距离
 
     Examples
     --------
 
-    先读取两个构型的分数坐标、元素列表和晶胞信息
+    先读取结构信息
 
-    >>> from dspawpy.io.read import pel_from_as
-    >>> spo1, ele1, lat1 = pel_from_as('structure01.as', scaled=True)
-    >>> spo1
-    array([[0.25      , 0.25      , 0.11784996],
-           [0.75      , 0.25      , 0.11784996],
-           ...，
-           [0.04062186, 0.45937779, 0.43038044]])
-    >>> ele1
-    ['Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt']
-    >>> lat1
-    array([[ 5.6058,  0.    ,  0.    ],
-           [ 0.    ,  5.6058,  0.    ],
-           [ 0.    ,  0.    , 16.8174]])
-    >>> spo2, ele2, lat2 = pel_from_as('structure02.as', scaled=True)
-    >>> spo2
-    array([[0.25      , 0.25      , 0.11784996],
-           ...，
-           [0.08124389, 0.41875557, 0.41408303]])
-    >>> ele2
-    ['Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt', 'Pt']
-    >>> lat2
-    array([[ 5.6058,  0.    ,  0.    ],
-           [ 0.    ,  5.6058,  0.    ],
-           [ 0.    ,  0.    , 16.8174]])
+    >>> from dspawpy.io.structure import build_Structures_from_datafile
+    >>> s1 = build_Structures_from_datafile('/data/home/hzw1002/dspawpy_repo/test/2.15/01/structure01.as')[0]
+    >>> s2 = build_Structures_from_datafile('/data/home/hzw1002/dspawpy_repo/test/2.15/02/structure02.as')[0]
 
     计算两个构型的距离
 
     >>> from dspawpy.diffusion.nebtools import get_distance
-    >>> dist = get_distance(spo1, spo2, lat1, lat2)
-    >>> dist
-    0.5987379724194888
+    >>> dist = get_distance(s1.frac_coords, s2.frac_coords, s1.lattice.matrix, s2.lattice.matrix)
+    >>> print('两个构型的距离为：', dist, 'Angstrom')
+    两个构型的距离为： 0.476972808803491 Angstrom
     """
     diff_spo = spo1 - spo2  # 分数坐标差
     avglatv = 0.5 * (lat1 + lat2)  # 平均晶格矢量
     pbc_diff_spo = set_pbc(diff_spo)  # 笛卡尔坐标差
     # 分数坐标点乘平均晶胞，转回笛卡尔坐标
     pbc_diff_pos = np.dot(pbc_diff_spo, avglatv)  # 笛卡尔坐标差
-    print(f"{pbc_diff_pos=}")
     distance = np.sqrt(np.sum(pbc_diff_pos**2))
 
     return distance
 
 
-def get_neb_subfolders(directory: str = "."):
-    """将directory路径下的子文件夹名称列表按照数字大小排序
+def get_neb_subfolders(directory: str = ".", return_abs=False):
+    r"""将directory路径下的子文件夹名称列表按照数字大小排序
 
     仅保留形如00，01数字类型的NEB子文件夹路径
 
     Parameters
     ----------
     subfolders : list
         子文件夹名称列表
+    return_abs : bool, optional
+        是否返回绝对路径, 默认否
 
     Returns
     -------
     subfolders : list
         排序后的子文件夹名称列表
 
     Examples
     --------
     >>> from dspawpy.diffusion.nebtools import get_neb_subfolders
-    >>> directory = '.' # 默认当前目录
-    >>> get_neb_subfolders()
-    ['00', '01', '02', '03', '04', '05', '06']
+    >>> directory = '/data/home/hzw1002/dspawpy_repo/test/2.15'
+    >>> get_neb_subfolders(directory)
+    ['00', '01', '02', '03', '04']
     """
     raw_subfolders = next(os.walk(directory))[1]
     subfolders = []
     for subfolder in raw_subfolders:
         try:
             assert 0 <= int(subfolder) < 100
             subfolders.append(subfolder)
         except:
             pass
     subfolders.sort()  # 从小到大排序
+    if return_abs:
+        subfolders = [
+            os.path.abspath(os.path.join(directory, subfolder))
+            for subfolder in subfolders
+        ]
     return subfolders
 
 
 def plot_barrier(
     datafile: str = "neb.h5",
     directory: str = None,
     ri: float = None,
@@ -124,15 +121,15 @@
     ef: float = None,
     method: str = "PchipInterpolator",
     figname: str = "neb_barrier.png",
     show: bool = True,
     raw=False,
     **kwargs,
 ):
-    """调用 scipy.interpolate 插值算法，拟合NEB能垒并绘图
+    r"""调用 scipy.interpolate 插值算法，拟合NEB能垒并绘图
 
     Parameters
     ----------
     datafile: str
         neb.h5或neb.json文件路径
     directory : str
         NEB计算路径
@@ -141,15 +138,15 @@
     rf : float
         末态反应坐标
     ei : float
         初态自洽能量
     ef : float
         末态自洽能量
     method : str, optional
-        插值算法, by default 'interp1d'
+        插值算法, by default 'PchipInterpolator'
     figname : str, optional
         能垒图名称, by default 'neb_barrier.png'
     show : bool, optional
         是否展示交互界面, by default True
     raw : bool, optional
         是否返回原始数据到csv
 
@@ -160,24 +157,22 @@
     ValueError
         传递给插值算法的参数不符合该算法要求
 
     Examples
     --------
     >>> from dspawpy.diffusion.nebtools import plot_barrier
     >>> import matplotlib.pyplot as plt
-    >>> plot_barrier(directory='source', method='interp1d', kind=2, figname=None, show=False)
-    >>> plot_barrier(directory='source', method='interp1d', kind=3, figname=None, show=False)
-    >>> plot_barrier(directory='source', method='CubicSpline', figname=None, show=False)
-    >>> plot_barrier(directory='source', method='pchip', figname=None, show=False)
-    >>> plt.show()
+    >>> plot_barrier(directory='/data/home/hzw1002/dspawpy_repo/test/2.15', method='interp1d', kind=2, figname=None, show=False)
+    >>> plot_barrier(directory='/data/home/hzw1002/dspawpy_repo/test/2.15', method='interp1d', kind=3, figname=None, show=False)
+    >>> plot_barrier(directory='/data/home/hzw1002/dspawpy_repo/test/2.15', method='CubicSpline', figname=None, show=False)
+    >>> plot_barrier(directory='/data/home/hzw1002/dspawpy_repo/test/2.15', method='pchip', figname=None, show=False)
     """
     if directory is not None:
         # read data
         subfolders, resort_mfs, rcs, ens, dEs = _getef(directory)
-        dire = directory
 
     elif datafile:
         assert os.path.exists(datafile), f"文件{datafile}不存在"
         if datafile.endswith(".h5"):
             from dspawpy.io.read import load_h5
 
             neb = load_h5(datafile)
@@ -218,15 +213,15 @@
         if ef is not None:  # add final energy
             y.append(ef)
 
         rcs = np.array(x)
         dEs = np.array(y)
 
         print(f"如果NEB任务不计算初末态的自洽，{datafile}中将缺失相关信息，需要手动输入")
-        dire = os.getcwd()
+        os.getcwd()
 
     else:
         raise ValueError("请指定datafile或directory！")
 
     # import scipy interpolater
     try:
         interpolate_method = getattr(
@@ -255,28 +250,30 @@
     else:
         plt.plot(xnew, ynew, label=method)
     plt.scatter(rcs, dEs, c="r")
     plt.xlabel("Reaction Coordinate (Å)")
     plt.ylabel("Energy (eV)")
     plt.legend()
 
+    plt.tight_layout()
     # save and show
     if figname:
-        plt.tight_layout()
-        plt.savefig(f"{dire}/{figname}")
-        print("能垒图已保存为", os.path.abspath(f"{dire}/{figname}"))
-    if show:  # 画子图的话，不应每个子图都show
-        plt.show()  # show会自动清空图片
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
+        plt.savefig(figname)
+        print(f"--> 图片已保存为 {os.path.abspath(figname)}")
+    if show:
+        plt.show()
 
 
 def plot_neb_converge(
     neb_dir: str,
     image_key: str = "01",
     show: bool = True,
-    image_name: str = "neb_conv.png",
+    figname: str = "neb_conv.png",
     raw=False,
 ):
     """指定NEB计算路径，绘制NEB收敛过程图
 
     Parameters
     ----------
     neb_dir : str
@@ -294,15 +291,17 @@
     -------
     ax1, ax2 : matplotlib.axes.Axes
         两个子图的Axes对象
 
     Examples
     --------
     >>> from dspawpy.diffusion.nebtools import plot_neb_converge
-    >>> plot_neb_converge(neb_dir='my_neb_task', image_key='01')
+    >>> plot_neb_converge(neb_dir='/data/home/hzw1002/dspawpy_repo/test/2.15', image_key='01', figname='/data/home/hzw1002/dspawpy_repo/test/out/neb_converge1.png',show=False)
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/test/out/neb_converge1.png
+    (<Axes: xlabel='Number of ionic step', ylabel='Force (eV/Å)'>, <Axes: xlabel='Number of ionic step', ylabel='Energy (eV)'>)
     """
     assert os.path.isdir(neb_dir), f"目录{neb_dir}不存在"
 
     if os.path.exists(os.path.join(neb_dir, "neb.h5")):
         neb_total = h5py.File(os.path.join(neb_dir, "neb.h5"))
         # new output (>=2022B)
         if "/LoopInfo/01/MaxForce" in neb_total.keys():
@@ -357,17 +356,22 @@
     ax1.set_ylabel("Force (eV/Å)")
     ax2 = ax1.twinx()
     ax2.plot(x, energy, label="Energy", c="r")
     ax2.set_xlabel("Number of ionic step")
     ax2.set_ylabel("Energy (eV)")
     ax2.ticklabel_format(useOffset=False)  # y轴坐标显示绝对值而不是相对值
     fig.legend(loc=1, bbox_to_anchor=(1, 1), bbox_transform=ax1.transAxes)
-    if image_name:
-        plt.tight_layout()
-        plt.savefig(image_name)
+
+    plt.tight_layout()
+    # save and show
+    if figname:
+        if os.path.dirname(figname):  # not just a file name
+            os.makedirs(os.path.dirname(figname), exist_ok=True)
+        plt.savefig(figname)
+        print(f"--> 图片已保存为 {os.path.abspath(figname)}")
     if show:
         plt.show()
 
     return ax1, ax2
 
 
 def printef(directory):
@@ -381,127 +385,139 @@
     Returns
     -------
     打印各构型的能量和受力
 
     Examples
     --------
     >>> from dspawpy.diffusion.nebtools import printef
-    >>> printef(directory='.')
-    构型    受力(eV/Å)      反应坐标(Å)     此构型的能量(eV)        与初始构型的能量差(eV)
-    00        0.1869          0.0000         -42922.7554                  0.0000
-    01        0.0874          0.7076         -42922.4959                  0.2595
-    02        0.0399          1.4144         -42921.9633                  0.7921
-    03        0.0618          2.1067         -42922.0385                  0.7169
-    04        0.0425          2.7983         -42921.9606                  0.7948
-    05        0.8643          3.5299         -42922.4642                  0.2912
-    06        0.0352          4.2620         -42922.7012                  0.0542
+    >>> printef(directory='/data/home/hzw1002/dspawpy_repo/test/2.15')
+        Force(eV/Å)     RC(Å)    Energy(eV)  E-E0(eV)
+    00     0.180272  0.000000 -39637.098409  0.000000
+    01     0.026337  0.542789 -39637.018595  0.079814
+    02     0.024798  1.086800 -39636.880144  0.218265
+    03     0.234429  1.588367 -39636.998366  0.100043
+    04     0.014094  2.089212 -39637.089994  0.008414
     """
     subfolders, resort_mfs, rcs, ens, dEs = _getef(directory)
-    # printout summary
-    print("构型\t受力(eV/Å)\t反应坐标(Å)\t此构型的能量(eV)\t与初始构型的能量差(eV)")
-    for i in range(len(subfolders)):  # 注意格式化输出，对齐
-        print(
-            "%s\t%8.4f\t%8.4f\t%12.4f\t%20.4f"
-            % (subfolders[i], resort_mfs[i], rcs[i], ens[i], dEs[i])
-        )
+    data = np.array([resort_mfs, rcs, ens, dEs], dtype=float)
+    df = pd.DataFrame(
+        data.T,
+        columns=["Force(eV/Å)", "RC(Å)", "Energy(eV)", "E-E0(eV)"],
+        index=subfolders,
+    )
+    print(df)
 
 
-def restart(directory: str, inputin: str, output: str):
+def restart(directory: str = ".", output: str = "bakfile"):
     """将旧NEB任务归档压缩，并在原路径下准备续算
 
     Parameters
     ----------
     directory : str
         旧NEB任务所在路径，默认当前路径
-    inputin : str
-        输入参数文件名，默认input.in
     output : str
-        备份文件夹路径
+        备份文件夹路径，默认将在当前路径新建一个bakfile文件夹用于备份；
+        也可以任意指定一个路径，但不能与当前路径相同
 
     Examples
     ----------
     >>> from dspawpy.diffusion.nebtools import restart
-    >>> restart(directory='source', inputin='input.in', output='backup')
-    """
-    if output == "":
-        raise ValueError("备份文件夹路径不能为空！")
-    elif os.path.isdir(output):
-        raise ValueError("备份文件夹已存在！")
-
-    if directory == "":
-        directory = os.getcwd()
-    if inputin == "":
-        inputin = "input.in"
+    >>> restart(directory='/data/home/hzw1002/dspawpy_repo/test/neb_temp_back', output='/data/home/hzw1002/dspawpy_repo/test/out/neb_backup')
+    已将/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/00压缩到/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/00.zip
+    已将/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/01压缩到/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/01.zip
+    已将/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/02压缩到/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/02.zip
+    已将/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/03压缩到/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/03.zip
+    已将/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/04压缩到/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/04.zip
+    已将/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/tmp压缩到/data/home/hzw1002/dspawpy_repo/test/out/neb_backup/neb_data.zip
 
-    # 读取子文件夹名称列表，仅保留形如00，01数字文件夹路径
-    subfolders = get_neb_subfolders(directory)
-    # 创建备份文件夹并进入
-    os.makedirs(f"{directory}/{output}")
-    os.chdir(f"{directory}/{output}")
-    # 将-0改成-9可提供极限压缩比
-    os.environ["XZ_OPT"] = "-T0 -0"
-    for subfolder in subfolders:
-        # 备份
-        os.system(f"mv {directory}/{subfolder} ./")
-        # 准备续算用的结构文件
-        os.mkdir(f"{directory}/{subfolder}")
-        latestStructureFile = os.path.join(
-            directory, output, subfolder, "latestStructure%s.as" % subfolder
-        )
-        structureFile = os.path.join(
-            directory, output, subfolder, "structure%s.as" % subfolder
-        )
-        bk_latestStructure = f"{directory}/latestStructure{subfolder}.as"
-        bk_structure = f"{directory}/structure{subfolder}.as"
+    续算准备工作可能需要较长时间才能完成，请耐心等待
+    """
+    while True:
+        if os.path.isdir(output):
+            if os.path.abspath(output) == os.getcwd():
+                raise ValueError("备份文件夹不能与当前路径相同！")
+            else:
+                output += "_new"
+                continue
+        else:
+            break
 
-        if os.path.exists(latestStructureFile):
-            os.system(  # 复制到子文件夹
-                f"cp {latestStructureFile} {directory}/{subfolder}/structure{subfolder}.as"
-            )
-            # 备份latestStructureFile到主目录
-            os.system(f"cp {latestStructureFile} {bk_latestStructure}")
-        elif os.path.exists(structureFile):
+    subfolders = get_neb_subfolders(directory, return_abs=True)  # 获取子文件夹路径
+    os.makedirs(output, exist_ok=True)  # 创建bakfile文件夹
+    # 先处理子文件夹00，01...
+    for subfolder_old in subfolders:
+        folder_index = subfolder_old.split("/")[-1]  # 00，01...
+        subfolder_back = os.path.join(output, folder_index)  # 子文件夹备份到此
+        shutil.move(subfolder_old, subfolder_back)
+        os.makedirs(subfolder_old, exist_ok=True)  # 原文件夹清空了
+
+        latestStructureFile = f"{subfolder_back}/latestStructure{folder_index}.as"
+        structureFile = f"{subfolder_back}/structure{folder_index}.as"
+
+        # 将结构文件复制到原路径下用于续算，有ls则用之，否则用s代替，都没有则报错
+        s_in_old = f"{subfolder_old}/structure{folder_index}.as"
+        if os.path.isfile(latestStructureFile):
+            shutil.copy(latestStructureFile, s_in_old)
+        elif os.path.isfile(structureFile):
             print(f"未找到{latestStructureFile}，复用{structureFile}续算")
-            os.system(  # 复制到子文件夹
-                f"cp {structureFile} {directory}/{subfolder}/structure{subfolder}.as"
-            )
+            shutil.copy(structureFile, s_in_old)
         else:
             raise FileNotFoundError(f"{latestStructureFile}和{structureFile}都不存在！")
-        # 备份structureFile到主目录
-        if os.path.exists(structureFile):
-            os.system(f"cp {structureFile} {bk_structure}")
-
-        # 压缩和移动文件
-        # 若存在latestStructure00.as和structure00.as，则压缩00文件夹并把主结构移入00文件夹
-        if os.path.exists(bk_latestStructure) and os.path.exists(bk_structure):
-            os.system(
-                f"tar -Jcf {subfolder}.tar.xz -C {subfolder} . --remove-files && mkdir {subfolder} && mv {subfolder}.tar.xz {directory}/latestStructure{subfolder}.as {directory}/structure{subfolder}.as {subfolder}/ &"
-            )
-        # 若仅存在latestStructure00.as，则压缩00文件夹并把主结构移入00文件夹
-        elif os.path.exists(bk_latestStructure):
-            os.system(
-                f"tar -Jcf {subfolder}.tar.xz {subfolder} . --remove-files && mkdir {subfolder} && mv {subfolder}.tar.xz {directory}/latestStructure{subfolder}.as {subfolder}/ &"
-            )
-        # 若仅存在structure00.as，则压缩00文件夹并把主结构移入00文件夹
-        elif os.path.exists(bk_structure):
-            os.system(
-                f"tar -Jcf {subfolder}.tar.xz -C {subfolder} . --remove-files && mkdir {subfolder} && mv {subfolder}.tar.xz {directory}/structure{subfolder}.as {subfolder}/ &"
-            )
-        else:  # 如果都不存在，说明备份失败
-            raise FileNotFoundError(f"{bk_latestStructure}和{bk_structure}都不存在！")
 
+        # 暂时放到备份主路径下，如果都没有，前面就已经报错了
+        ls_bk = os.path.join(directory, f"latestStructure{folder_index}.as")
+        s_bk = os.path.join(directory, f"structure{folder_index}.as")
+        if os.path.isfile(latestStructureFile):
+            shutil.copy(latestStructureFile, ls_bk)
+        if os.path.isfile(structureFile):
+            shutil.copy(structureFile, s_bk)
+
+        # 处理备份路径下的子文件夹
+        zf = f"{os.path.abspath(output)}/{folder_index}.zip"
+        _zip_folder(subfolder_back, zf)  # 压缩子文件夹
+        # 清空备份子文件夹
+        for file in os.listdir(subfolder_back):
+            os.remove(os.path.join(subfolder_back, file))
+
+        # 将压缩包、结构文件移入
+        shutil.move(zf, f"{subfolder_back}/{folder_index}.zip")
+        if os.path.isfile(ls_bk) and os.path.isfile(s_bk):
+            shutil.move(ls_bk, f"{subfolder_back}/latestStructure{folder_index}.as")
+            shutil.move(s_bk, f"{subfolder_back}/structure{folder_index}.as")
+        elif os.path.isfile(ls_bk):
+            shutil.move(ls_bk, f"{subfolder_back}/latestStructure{folder_index}.as")
+        elif os.path.isfile(s_bk):
+            shutil.move(s_bk, f"{subfolder_back}/structure{folder_index}.as")
+        else:
+            raise FileNotFoundError(f"{ls_bk}和{s_bk}都不存在！")
+
+    # 再处理老NEB文件夹主目录下的单个文件
     # 备份neb.h5,neb.json和DS-PAW.log
-    if os.path.exists(f"{directory}/neb.json"):
-        os.system(
-            f"mv {directory}/neb.h5 {directory}/neb.json {directory}/DS-PAW.log ./"
-        )
-        os.system(f"tar -Jcf neb.tar.xz neb.h5 neb.json --remove-files &")
+    tmp_dir = os.path.join(output, "tmp")
+    os.makedirs(tmp_dir, exist_ok=True)
+    if os.path.isfile(f"{directory}/neb.h5"):
+        shutil.move(f"{directory}/neb.h5", f"{tmp_dir}/neb.h5")
     else:
-        os.system(f"mv {directory}/neb.h5 {directory}/DS-PAW.log ./")
-        os.system(f"tar -Jcf neb.tar.xz neb.h5 --remove-files &")
+        print("未找到neb.h5，将不会备份")
+
+    if os.path.isfile(f"{directory}/neb.json"):
+        shutil.move(f"{directory}/neb.json", f"{tmp_dir}/neb.json")
+    else:
+        print("未找到neb.json，将不会备份")
+
+    if len(os.listdir(tmp_dir)) > 0:  # 如果有数据文件
+        _zip_folder(tmp_dir, f"{output}/neb_data.zip")
+        for f in os.listdir(tmp_dir):
+            os.remove(os.path.join(tmp_dir, f))
+        os.removedirs(tmp_dir)
+
+    if os.path.isfile(f"{directory}/DS-PAW.log"):
+        shutil.move(f"{directory}/DS-PAW.log", f"{output}/DS-PAW.log")
+    else:
+        print("未找到DS-PAW.log，将不会备份")
 
 
 def set_pbc(spo):
     """根据周期性边界条件将分数坐标分量移入 [-0.5, 0.5) 区间
 
     Parameters
     ----------
@@ -521,62 +537,97 @@
     """
     # wrap into [-0.5, 0.5)
     pbc_spo = np.mod(np.array(spo) + 0.5, 1.0) - 0.5
 
     return pbc_spo
 
 
-def summary(directory: str = ".", raw=False, **kwargs):
-    """NEB任务完成总结，依次执行以下步骤：
+def summary(
+    directory: str = ".", raw=False, show_converge=False, outdir: str = None, **kwargs
+):
+    r"""NEB任务完成总结，依次执行以下步骤：
 
     - 1. 打印各构型受力、反应坐标、能量、与初始构型的能量差
     - 2. 绘制能垒图
     - 3. 绘制并保存结构优化过程的能量和受力收敛过程图
 
     Parameters
     ----------
     directory : str
         NEB路径, 默认当前路径
     raw : bool
         是否保存原始数据到csv文件
+    show_converge : bool
+        是否展示结构优化过程的能量和受力收敛过程图，默认不展示
+    outdir : str
+        收敛过程图保存路径，默认为directory
     **kwargs : dict
         传递给plot_barrier的参数
 
     Examples
     --------
     >>> from dspawpy.diffusion.nebtools import summary
-    >>> directory = '.' # NEB计算路径，默认当前路径
-    >>> summary(directory)
-    # 若inifin=false，用户必须将自洽的scf.h5或system.json放到初末态子文件夹中
+    >>> directory = '/data/home/hzw1002/dspawpy_repo/test/2.15' # NEB计算路径，默认当前路径
+    >>> summary(directory, show=False)
+    --> 1. 打印NEB计算时各构型的能量和受力...
+        Force(eV/Å)     RC(Å)    Energy(eV)  E-E0(eV)
+    00     0.180272  0.000000 -39637.098409  0.000000
+    01     0.026337  0.542789 -39637.018595  0.079814
+    02     0.024798  1.086800 -39636.880144  0.218265
+    03     0.234429  1.588367 -39636.998366  0.100043
+    04     0.014094  2.089212 -39637.089994  0.008414
+    <BLANKLINE>
+    --> 2. 绘制能垒图...
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/dspawpy/neb_barrier.png
+    <BLANKLINE>
+    --> 3. 绘制收敛过程图到各构型文件夹中...
+    ----> /data/home/hzw1002/dspawpy_repo/test/2.15/01/converge.png...
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/test/2.15/01/converge.png
+    ----> /data/home/hzw1002/dspawpy_repo/test/2.15/02/converge.png...
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/test/2.15/02/converge.png
+    ----> /data/home/hzw1002/dspawpy_repo/test/2.15/03/converge.png...
+    --> 图片已保存为 /data/home/hzw1002/dspawpy_repo/test/2.15/03/converge.png
+    <BLANKLINE>
+    完成!
+
+    若inifin=false，用户必须将自洽的scf.h5或system.json放到初末态子文件夹中
     """
     # 1. 绘制能垒图
     print("--> 1. 打印NEB计算时各构型的能量和受力...")
     printef(directory)
 
     # 2. 打印各构型受力、反应坐标、能量、与初始构型的能量差
     print("\n--> 2. 绘制能垒图...")
     plt.clf()  # 清空画布再画图
     plot_barrier(directory=directory, raw=raw, **kwargs)
 
     # 3. 绘制并保存结构优化过程的能量和受力收敛过程图到各构型文件夹中
     print("\n--> 3. 绘制收敛过程图到各构型文件夹中...")
     subfolders = get_neb_subfolders(directory)
     for subfolder in subfolders[1 : len(subfolders) - 1]:
-        print(f"----> {subfolder}/converge.png...")
+        if outdir:
+            os.makedirs(os.path.join(outdir, subfolder), exist_ok=True)
+            pngfile = f"{outdir}/{subfolder}/converge.png"
+        else:
+            pngfile = f"{directory}/{subfolder}/converge.png"
+
+        print(f"----> {pngfile}...")
         plot_neb_converge(
             neb_dir=directory,
             image_key=subfolder,
-            image_name=f"{directory}/{subfolder}/converge.png",
+            figname=pngfile,
             raw=raw,
+            show=show_converge,
         )
+    plt.clf()
     print("\n完成!")
 
 
 def write_movie_json(preview: bool = False, directory: str = ".", step: int = -1):
-    """NEB计算或者初始插值后，读取信息，保存为 neb_movie*.json 文件
+    r"""NEB计算或者初始插值后，读取信息，保存为 neb_movie*.json 文件
 
     用 Device Studio 打开该文件可以观察结构等信息
 
     Parameters
     ----------
     preview : bool
         是否预览模式，默认否
@@ -590,22 +641,38 @@
     Returns
     ----------
     neb_movie*.json文件
 
     Examples
     ----------
     >>> from dspawpy.diffusion.nebtools import write_movie_json
-    # NEB计算完成后要观察轨迹变化全过程，只需指定NEB计算路径即可
-    >>> write_movie_json(directory='source')
-    # NEB计算完成后要观察第n离子步结构，请设置step为n，注意step从1开始计数
-    >>> write_movie_json(directory='source', step=1)
-    # 如果您指定的step数超过NEB实际完成的离子步，将会自动修改为最后一步，实际效果等同于上一行代码
-    >>> write_movie_json(directory='source', step=100)
-    # 另外，如需预览初插结构，请将preview设置为True，并将directory指定为NEB计算主路径
-    >>> write_movie_json(preview=True, directory='source')
+
+    NEB计算完成后要观察轨迹变化全过程，只需指定NEB计算路径即可
+
+    >>> write_movie_json(directory='/data/home/hzw1002/dspawpy_repo/test/2.15')
+    正在读取最后一个离子步信息...
+    --> /data/home/hzw1002/dspawpy_repo/dspawpy/neb_movie_last.json 写入成功！
+
+    NEB计算完成后要观察第n离子步结构，请设置step为n，注意step从1开始计数
+
+    >>> write_movie_json(directory='/data/home/hzw1002/dspawpy_repo/test/2.15', step=1)
+    正在读取第1个离子步信息...
+    --> /data/home/hzw1002/dspawpy_repo/dspawpy/neb_movie_1.json 写入成功！
+
+    如果您指定的step数超过NEB实际完成的离子步，将会自动修改为最后一步，实际效果等同于上一行代码
+
+    >>> write_movie_json(directory='/data/home/hzw1002/dspawpy_repo/test/2.15', step=10)
+    正在读取第10个离子步信息...
+    --> /data/home/hzw1002/dspawpy_repo/dspawpy/neb_movie_10.json 写入成功！
+
+    另外，如需预览初插结构，请将preview设置为True，并将directory指定为NEB计算主路径
+
+    >>> write_movie_json(preview=True, directory='/data/home/hzw1002/dspawpy_repo/test/2.15')
+    正在根据初插结构保存neb_movie_init.json...
+    --> /data/home/hzw1002/dspawpy_repo/dspawpy/neb_movie_init.json 写入成功！
     """
 
     if preview:  # preview mode, write neb_movie_init.json from structure.as
         print("正在根据初插结构保存neb_movie_init.json...")
         try:
             raw = _from_structures(directory)
         except FileNotFoundError:
@@ -620,21 +687,20 @@
                 print("未找到初始插值结构，将从计算结果h5或json文件中读取！")
             except Exception as e:
                 print("初始插值结构读取失败！", e)
         else:
             try:  # read from h5 file
                 raw = _from_h5(directory, step)
             except FileNotFoundError:
-                raw = _from_json(directory, step)
-                # try:  # read from json file
-                #     raw = _from_json(directory, step)
-                # except json.decoder.JSONDecodeError:
-                #     print("json文件格式错误！")
-                # except Exception as e:
-                #     print(e)
+                try:  # read from json file
+                    raw = _from_json(directory, step)
+                except json.decoder.JSONDecodeError:
+                    print("json文件格式错误！")
+                except Exception as e:
+                    print(e)
             except Exception as e:
                 print("h5文件内容读取失败！", e)
     _dump_neb_movie_json(raw)
 
 
 def write_xyz(preview: bool = False, directory: str = ".", step: int = -1):
     """
@@ -653,14 +719,19 @@
 
     Returns
     ----------
     neb_movie.xyz文件
 
     Examples
     ----------
+    >>> from dspawpy.diffusion.nebtools import write_xyz
+    >>> write_xyz(directory='/data/home/hzw1002/dspawpy_repo/test/2.15')
+    正在读取最后一个离子步信息...
+    --> /data/home/hzw1002/dspawpy_repo/dspawpy/neb_movie_last.xyz 写入成功！
+    <BLANKLINE>
     """
 
     if preview:  # preview mode, write neb_movie_init.xyz from structure.as
         print("正在根据初插结构保存neb_movie_init.xyz...")
         try:
             raw = _from_structures(directory)
         except FileNotFoundError:
@@ -773,15 +844,18 @@
     Latvs = []  # nimage x 9, read
 
     iDirects = []  # read coordinate type
     for i, folder in enumerate(subfolders):
         structure_path = os.path.join(directory, folder, f"structure{folder}.as")
         if not os.path.exists(structure_path):
             raise FileNotFoundError(f"请检查{structure_path}是否存在！")
-        pos, ele, lat = pel_from_as(structure_path)
+        structure = build_Structures_from_datafile(structure_path)[0]
+        pos = structure.cart_coords
+        ele = [str(i) for i in structure.species]
+        lat = structure.lattice.matrix
         Poses.append(pos)
         Elems.append(ele)
         Latvs.append(lat)
         with open(structure_path, "r") as f:
             lines = f.readlines()
             coordinateType = lines[6].split()[0]
             if coordinateType == "Direct":
@@ -904,15 +978,18 @@
                 pos = np.array(data.get("/Structures/Step-1/Position")).reshape(
                     -1, 3
                 )  # scaled
                 lat = np.array(data.get("/Structures/Step-1/Lattice"))
                 ele = get_ele_from_h5(hpath=h5_path)
                 totalEnergies[i] = np.array(data.get("/Energy/TotalEnergy0"))
             else:
-                pos, ele, lat = pel_from_as(spath, scaled=True)
+                structure = build_Structures_from_datafile(spath)[0]
+                pos = structure.frac_coords
+                ele = [str(i) for i in structure.species]
+                lat = structure.lattice.matrix
         else:
             h5_path = os.path.join(directory, folder, f"neb{folder}.h5")
             data = h5py.File(h5_path)
             # reading...
             try:
                 reactionCoordinates[i - 1] = np.array(data.get("/Distance/Previous"))[
                     -1
@@ -1269,15 +1346,15 @@
         "UnrelaxedStructure": URSList,
     }
 
     # ^ 将字典写入json文件
     with open(output, "w") as f:
         json.dump(data, f, indent=4)
 
-    print(f"--> {os.path.abspath(output)} 写入成功！\n")
+    print(f"--> {os.path.abspath(output)} 写入成功！")
 
 
 def _getef(directory: str = "."):
     """读取NEB计算时各构型的能量和受力，NEB计算可以未收敛
     但如果初末态自洽在别处完成，请手动将其移入00等文件夹中！
 
     Parameters
@@ -1293,30 +1370,14 @@
         构型受力的最大分量列表
     rcs: list
         反应坐标列表
     ens: list
         电子总能列表
     dEs: list
         与初始构型的能量差列表
-
-    Examples
-    --------
-    >>> from dspawpy.diffusion.nebtools import getef
-    >>> directory = '.'  # NEB计算的路径，默认当前路径
-    >>> subfolders, resort_mfs, rcs, ens, dEs = getef(directory)
-    >>> print(subfolders)
-    ['00', '01', '02', '03', '04', '05', '06']
-    >>> print(resort_mfs)
-    [0.186876802632, 0.087370747812, 0.039940517914, 0.061764168138, 0.042459986924, 0.864285419627, 0.035218915742]
-    >>> print(rcs)
-    [0.         0.70762104 1.41440524 2.10669668 2.79829788 3.52986152 4.26191179]
-    >>> print(ens)
-    [-42922.75544084902, -42922.495919381065, -42921.96332356572, -42922.038481743206, -42921.960565486996, -42922.464230317, -42922.70115500509]
-    >>> print(dEs)
-    [0.         0.25952147 0.79211728 0.71695911 0.79487536 0.29121053 0.05428584]
     """
 
     subfolders = get_neb_subfolders(directory)
     Nimage = len(subfolders)
 
     ens = []
     dEs = np.zeros(Nimage)
```

## dspawpy/io/read.py

```diff
@@ -17,67 +17,67 @@
 from pymatgen.phonon.dos import PhononDos
 
 
 def get_band_data(
     band_dir: str,
     syst_dir: str = None,
     efermi: float = None,
-    zero_to_fermi: bool = False,
+    zero_to_efermi: bool = False,
 ) -> BandStructureSymmLine:
     """读取h5或json文件中的能带数据，构建BandStructureSymmLine对象
 
     Parameters
     ----------
     band_dir : str
         能带文件路径，band.h5 / band.json
     syst_dir : str
         system.json 路径，仅为辅助处理 Wannier 数据而准备
     efermi : float, optional
         费米能级，如果h5文件中的费米能级不正确，可以通过此参数指定费米能级
-    zero_to_fermi : bool, optional
+    zero_to_efermi : bool, optional
         是否将费米能级移动到0
 
     Returns
     -------
     BandStructureSymmLine
 
     Examples
     --------
     >>> from dspawpy.io.read import get_band_data
-    >>> band = get_band_data(band_dir='band.h5')
-    >>> band.branches
-    [{'start_index': 0, 'end_index': 100, 'name': 'R-G'}, {'start_index': 101, 'end_index': 201, 'name': 'G-X'}]
+    >>> band = get_band_data(band_dir='/data/home/hzw1002/dspawpy_repo/test/2.3/band.h5')
 
     如果希望通过指定wannier.json来处理瓦尼尔能带，需要额外指定syst_dir参数
 
-    >>> band = get_band_data(band_dir='wannier.json', syst_dir='system.json')
+    >>> band = get_band_data(band_dir='/data/home/hzw1002/dspawpy_repo/test/2.30/wannier.json', syst_dir='/data/home/hzw1002/dspawpy_repo/test/2.30/system.json')
     """
-    if efermi is not None and zero_to_fermi:
-        raise ValueError("efermi and zero_to_fermi should not be set at the same time!")
+    if efermi is not None and zero_to_efermi:
+        raise ValueError(
+            "efermi and zero_to_efermi should not be set at the same time!"
+        )
     if band_dir.endswith(".h5"):
         band = load_h5(band_dir)
         raw = h5py.File(band_dir, "r").keys()
         if "/WannBandInfo/NumberOfBand" in raw:
             (
                 structure,
                 kpoints,
                 eigenvals,
                 rEf,
                 labels_dict,
                 projections,
-            ) = _get_band_data_h5(band, iwan=True, zero_to_fermi=zero_to_fermi)
+            ) = _get_band_data_h5(band, iwan=True, zero_to_efermi=zero_to_efermi)
         elif "/BandInfo/NumberOfBand" in raw:
             (
                 structure,
                 kpoints,
                 eigenvals,
                 rEf,
                 labels_dict,
                 projections,
-            ) = _get_band_data_h5(band, iwan=False, zero_to_fermi=zero_to_fermi)
+            ) = _get_band_data_h5(band, iwan=False, zero_to_efermi=zero_to_efermi)
         else:
             print("BandInfo or WannBandInfo key not found in h5file!")
             return
     elif band_dir.endswith(".json"):
         with open(band_dir, "r") as fin:
             band = json.load(fin)
         if "WannBandInfo" in band.keys():
@@ -89,24 +89,26 @@
             (
                 structure,
                 kpoints,
                 eigenvals,
                 rEf,
                 labels_dict,
                 projections,
-            ) = _get_band_data_json(band, syst, iwan=True, zero_to_fermi=zero_to_fermi)
+            ) = _get_band_data_json(
+                band, syst, iwan=True, zero_to_efermi=zero_to_efermi
+            )
         elif "BandInfo" in band.keys():
             (
                 structure,
                 kpoints,
                 eigenvals,
                 rEf,
                 labels_dict,
                 projections,
-            ) = _get_band_data_json(band, iwan=False, zero_to_fermi=zero_to_fermi)
+            ) = _get_band_data_json(band, iwan=False, zero_to_efermi=zero_to_efermi)
         else:
             print("BandInfo or WannBandInfo key not found in json file!")
             return
     else:
         raise TypeError(f"{os.path.abspath(band_dir)} must be h5 or json file!")
 
     if efermi:  # 从h5直接读取的费米能级可能是错的，此时需要用户自行指定
@@ -135,28 +137,15 @@
     Returns
     -------
     CompleteDos or Dos
 
     Examples
     --------
     >>> from dspawpy.io.read import get_dos_data
-    >>> dos = get_dos_data(dos_dir='dos.h5')
-    >>> print(dos)
-    Complete DOS for Full Formula (Cu4)
-    Reduced Formula: Cu
-    abc   :   3.614700   3.614700   3.614700
-    angles:  90.000000  90.000000  90.000000
-    pbc   :       True       True       True
-    Sites (4)
-    #  SP       a     b     c
-    ---  ----  ----  ----  ----
-    0  Cu    0.25  0.25  0.25
-    1  Cu    0.75  0.75  0.25
-    2  Cu    0.75  0.25  0.75
-    3  Cu    0.25  0.75  0.75
+    >>> dos = get_dos_data(dos_dir='/data/home/hzw1002/dspawpy_repo/test/2.5/dos.h5')
     """
     if dos_dir.endswith(".h5"):
         dos = load_h5(dos_dir)
         if dos["/DosInfo/Project"][0]:
             return _get_complete_dos(dos)
         else:
             return _get_total_dos(dos)
@@ -187,17 +176,17 @@
     -------
     ele : list
         元素列表, Natom x 1
 
     Examples
     --------
     >>> from dspawpy.io.read import get_ele_from_h5
-    >>> ele = get_ele_from_h5(hpath='aimd.h5')
+    >>> ele = get_ele_from_h5(hpath='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5')
     >>> ele
-    ['H', 'H', 'O']
+    ['H', 'H_1', 'O']
     """
     data = h5py.File(hpath)
     Elements_bytes = np.array(data.get("/AtomInfo/Elements"))
     tempdata = np.array([i.decode() for i in Elements_bytes])
     ele = "".join(tempdata).split(";")
 
     return ele
@@ -205,17 +194,17 @@
 
 def get_lines_without_comment(filename: str, comment: str = "#"):
     """读取as文件内容，移除批注后返回行列表
 
     Examples
     --------
     >>> from dspawpy.io.read import get_lines_without_comment
-    >>> lines = get_lines_without_comment(filename='structure.as', comment='#')
+    >>> lines = get_lines_without_comment(filename='/data/home/hzw1002/dspawpy_repo/test/2.15/01/structure01.as', comment='#')
     >>> lines
-    ['Total number of atoms', '12', 'Lattice', '5.04621935 0.00000000 0.00000000', '0.00000000 5.07315250 0.00000000', '0.00000000 0.00000000 5.25768906', 'Cartesian', 'Hf 1.34815269 1.22145223 0.17639072', 'Hf 1.34815269 3.75802848 2.45245381', 'Hf 3.69806666 1.22145223 2.80523525', 'Hf 3.69806666 3.75802848 5.08129834', 'O 0.35195212 1.93667285 1.92589951', 'O 0.35195212 4.47324910 0.70294502', 'O 2.32678304 2.48829365 3.85528784', 'O 2.32678304 5.02486990 4.03124575', 'O 2.71943630 5.02486990 1.40240122', 'O 2.71943630 2.48829365 1.22644331', 'O 4.69426723 1.93667285 4.55474404', 'O 4.69426723 4.47324910 3.33178955']
+    ['Total number of atoms', '13', 'Lattice', '5.60580000 0.00000000 0.00000000', '0.00000000 5.60580000 0.00000000', '0.00000000 0.00000000 16.81740000', 'Cartesian', 'H 2.48700709 3.85367720 6.93461994', 'Pt 1.40145000 1.40145000 1.98192999', 'Pt 4.20434996 1.40145000 1.98192999', 'Pt 1.40145000 4.20434996 1.98192999', 'Pt 4.20434996 4.20434996 1.98192999', 'Pt 0.00843706 0.00042409 3.91500875', 'Pt 0.00881029 2.80247953 3.91551673', 'Pt 2.81216310 -0.00105882 3.91807627', 'Pt 2.81156629 2.80392163 3.91572506', 'Pt 1.41398585 1.39603492 5.85554462', 'Pt 4.22886663 1.39820574 5.84677553', 'Pt 1.40485707 4.20963461 5.89521929', 'Pt 4.23788559 4.20753128 5.88625580']
     """
     lines = []
     """Filter out comment lines"""
     with open(filename) as file:
         while True:
             line = file.readline()
             if line:
@@ -240,17 +229,15 @@
     Returns
     -------
     PhononBandStructureSymmLine
 
     Examples
     --------
     >>> from dspawpy.io.read import get_phonon_band_data
-    >>> phband = get_phonon_band_data(phonon_band_dir='phonon.h5')
-    >>> phband.branches
-    [{'start_index': 0, 'end_index': 50, 'name': 'G-X'}, {'start_index': 51, 'end_index': 101, 'name': 'X-W'}, {'start_index': 102, 'end_index': 152, 'name': 'W-G'}, {'start_index': 153, 'end_index': 203, 'name': 'G-M'}]
+    >>> band_data = get_phonon_band_data("/data/home/hzw1002/dspawpy_repo/test//2.16/phonon.h5") # 读取声子能带
     """
     if phonon_band_dir.endswith(".h5"):
         band = load_h5(phonon_band_dir)
         (
             symmmetry_kpoints,
             symmetry_kPoints_index,
             kpoints,
@@ -296,20 +283,35 @@
     Returns
     -------
     PhononDos
 
     Examples
     --------
     >>> from dspawpy.io.read import get_phonon_dos_data
-    >>> phdos = get_phonon_dos_data(phonon_dos_dir='phonon_dos.h5')
+    >>> phdos = get_phonon_dos_data(phonon_dos_dir='/data/home/hzw1002/dspawpy_repo/test/2.16.1/phonon.h5')
     >>> phdos.frequencies
     array([ 0. ,  0.1,  0.2,  0.3,  0.4,  0.5,  0.6,  0.7,  0.8,  0.9,  1. ,
             1.1,  1.2,  1.3,  1.4,  1.5,  1.6,  1.7,  1.8,  1.9,  2. ,  2.1,
-            ...
-            39.6, 39.7, 39.8, 39.9, 40. ])
+            2.2,  2.3,  2.4,  2.5,  2.6,  2.7,  2.8,  2.9,  3. ,  3.1,  3.2,
+            3.3,  3.4,  3.5,  3.6,  3.7,  3.8,  3.9,  4. ,  4.1,  4.2,  4.3,
+            4.4,  4.5,  4.6,  4.7,  4.8,  4.9,  5. ,  5.1,  5.2,  5.3,  5.4,
+            5.5,  5.6,  5.7,  5.8,  5.9,  6. ,  6.1,  6.2,  6.3,  6.4,  6.5,
+            6.6,  6.7,  6.8,  6.9,  7. ,  7.1,  7.2,  7.3,  7.4,  7.5,  7.6,
+            7.7,  7.8,  7.9,  8. ,  8.1,  8.2,  8.3,  8.4,  8.5,  8.6,  8.7,
+            8.8,  8.9,  9. ,  9.1,  9.2,  9.3,  9.4,  9.5,  9.6,  9.7,  9.8,
+            9.9, 10. , 10.1, 10.2, 10.3, 10.4, 10.5, 10.6, 10.7, 10.8, 10.9,
+           11. , 11.1, 11.2, 11.3, 11.4, 11.5, 11.6, 11.7, 11.8, 11.9, 12. ,
+           12.1, 12.2, 12.3, 12.4, 12.5, 12.6, 12.7, 12.8, 12.9, 13. , 13.1,
+           13.2, 13.3, 13.4, 13.5, 13.6, 13.7, 13.8, 13.9, 14. , 14.1, 14.2,
+           14.3, 14.4, 14.5, 14.6, 14.7, 14.8, 14.9, 15. , 15.1, 15.2, 15.3,
+           15.4, 15.5, 15.6, 15.7, 15.8, 15.9, 16. , 16.1, 16.2, 16.3, 16.4,
+           16.5, 16.6, 16.7, 16.8, 16.9, 17. , 17.1, 17.2, 17.3, 17.4, 17.5,
+           17.6, 17.7, 17.8, 17.9, 18. , 18.1, 18.2, 18.3, 18.4, 18.5, 18.6,
+           18.7, 18.8, 18.9, 19. , 19.1, 19.2, 19.3, 19.4, 19.5, 19.6, 19.7,
+           19.8, 19.9, 20. ])
     """
     if phonon_dos_dir.endswith(".h5"):
         dos = load_h5(phonon_dos_dir)
         frequencies = np.asarray(dos["/DosInfo/DosEnergy"])
         densities = dos["/DosInfo/Spin1/Dos"]
     elif phonon_dos_dir.endswith(".json"):
         with open(phonon_dos_dir, "r") as fin:
@@ -319,15 +321,15 @@
     else:
         raise TypeError(f"{os.path.abspath(phonon_dos_dir)} must be h5 or json file")
 
     return PhononDos(frequencies, densities)
 
 
 def get_sinfo(datafile: str, scaled=False, si=None, ele=None, ai=None):
-    """Wrapper to get structure information from h5/json/as file.
+    r"""Wrapper to get structure information from h5/json/as file.
 
     从datafile中读取结构信息
 
     Parameters
     ----------
     datafile : str
         h5 / json 文件路径
@@ -358,26 +360,31 @@
     D_mag_fix : dict
         磁矩、自由度相关信息
 
     Examples
     --------
 
     >>> from dspawpy.io.read import get_sinfo
-    >>> Nstep, eles, pos, latv, D_mag_fix = get_sinfo(datafile='aimd.h5', scaled=False, index=None, ele=None, ai=None)
-    >>> Nstep, eles, pos, latv, D_mag_fix = get_sinfo(datafile='relax.json', scaled=False, index=None, ele=None, ai=None)
-    >>> Nstep, eles, pos, latv, D_mag_fix = get_sinfo(datafile='rho.json', scaled=False)
+    >>> Nstep, eles, pos, latv, D_mag_fix = get_sinfo(datafile='/data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5', scaled=False, si=None, ele=None, ai=None)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.18/aimd.h5...
+    >>> Nstep, eles, pos, latv, D_mag_fix = get_sinfo(datafile='/data/home/hzw1002/dspawpy_repo/test/2.1/relax.json', scaled=False, si=None, ele=None, ai=None)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.1/relax.json...
+     json所含数据仅保留到小数点后四位，与h5或log文件中所记载的数据存在一定误差，可能导致后续保存的结构文件不一致！
+    Warning: mag and fix info are not available for relax.json and nebXX.json yet, trying read info...
+    >>> Nstep, eles, pos, latv, D_mag_fix = get_sinfo(datafile='/data/home/hzw1002/dspawpy_repo/test/2.2/rho.json', scaled=False)
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.2/rho.json...
+     json所含数据仅保留到小数点后四位，与h5或log文件中所记载的数据存在一定误差，可能导致后续保存的结构文件不一致！
 
     这些信息可以用于进一步构建Structure对象，
     具体参考 dspawpy.io.structure.build_Structures_from_datafile 函数
-
     """
     if datafile.endswith(".h5"):
         assert os.path.exists(datafile), f"{os.path.abspath(datafile)} does not exist!"
         hpath = datafile
-        print(f"Reading {os.path.abspath(hpath)} ...")
+        print(f"Reading {os.path.abspath(hpath)}...")
         hf = h5py.File(hpath)  # 加载h5文件
 
         # decide task type by check the internal key
         if "/Structures" in hf.keys():  # multi-steps
             Total_step = np.array(hf.get("/Structures/FinalStep"))[0]  # 总步数
 
             if ele is not None and ai is not None:
@@ -557,14 +564,15 @@
             print("--> rho/potential/elf/pcharge.h5 has no mag or fix info,")
             print("  you should manually set it before starting new calculations..")
 
     elif datafile.endswith(".json"):
         assert os.path.exists(datafile), f"{os.path.abspath(datafile)} does not exist!"
         jpath = datafile
         print(f"Reading {os.path.abspath(jpath)}...")
+        print(f" json所含数据仅保留到小数点后四位，与h5或log文件中所记载的数据存在一定误差，可能导致后续保存的结构文件不一致！")
         with open(jpath, "r") as f:
             data = json.load(f)  # 加载json文件
 
         # decide the task type by checking the internal keys
         if "AtomInfo" in data:  # single-step task
             s = _get_structure_json(data["AtomInfo"])
             elements = s.species
@@ -714,25 +722,28 @@
                 )
 
                 for i, ind in enumerate(indices):  # for every ionic step
                     lat = data[ind - 1]["Lattice"]
                     lattices[i] = np.array(lat).reshape(3, 3)
                     mag_for_each_step = []
                     fix_for_each_step = []
-                    fixlat_raw = data[ind - 1]["FixLattice"]
-                    if fixlat_raw == None:
-                        fixlat_raw = np.full((9, 1), fill_value=False).tolist()
-                    fixlat_str = [
-                        "True" if _v == True else "False" for _v in fixlat_raw
-                    ]
-                    fixlat_arr = np.array(fixlat_str).reshape(9, 1)
-                    # repeat fixlat for each atom
-                    fixlat = np.repeat(fixlat_arr, Natom, axis=1).T.tolist()
-                    LatFixs.append(fixlat)
+                    if "FixLattice" in data[ind - 1]:
+                        fixlat_raw = data[ind - 1]["FixLattice"]
+                        if fixlat_raw == None:
+                            fixlat_raw = np.full((9, 1), fill_value=False).tolist()
+                        fixlat_str = [
+                            "True" if _v == True else "False" for _v in fixlat_raw
+                        ]
+                        fixlat_arr = np.array(fixlat_str).reshape(9, 1)
+                        # repeat fixlat for each atom
+                        fixlat = np.repeat(fixlat_arr, Natom, axis=1).T.tolist()
+                    else:
+                        fixlat = np.full((Natom, 9), fill_value=False).tolist()
 
+                    LatFixs.append(fixlat)
                     for j, sli in enumerate(location):
                         ati = data[ind - 1]["Atoms"][sli]
                         poses[i, j, :] = ati["Position"][:]
 
                         mag_for_each_atom = ati["Mag"][:]
                         if mag_for_each_atom == []:
                             mag_for_each_atom = [0.0]
@@ -757,92 +768,14 @@
         raise ValueError(
             "get_sinfo function only accept datafile of .h5 / .json format!"
         )
 
     return Nstep, elements, poses, lattices, D_mag_fix
 
 
-def pel_from_as(spath: str, scaled=False):
-    """Extract structure information from .as file
-
-    从DSPAW的as结构文件中读取坐标、元素列表，和晶胞信息
-
-    Parameters
-    ----------
-
-    spath : str
-        结构文件路径
-
-    Returns
-    -------
-
-    pos : np.ndarray
-        坐标分量数组，Natom x 3
-    ele : list
-        元素列表, Natom x 1
-    latv : np.ndarray
-        晶胞矢量数组，3 x 3
-
-    Examples
-    --------
-
-    >>> from dspawpy.io.read import pel_from_as
-    >>> pos, ele, latv = pel_from_as(spath='structure.as', scaled=False)
-    >>> pos
-    array([[ 0.        ,  0.        ,  9.06355632],
-           [ 1.59203323,  0.91916082, 10.62711265],
-           [ 1.59203323,  0.91916082,  7.5       ]])
-    >>> ele
-    ['Mo', 'S', 'S']
-    >>> latv
-    array([[ 3.18406646,  0.        ,  0.        ],
-           [-1.59203323,  2.75748245,  0.        ],
-           [ 0.        ,  0.        , 30.        ]])
-
-    if scaled=True, return scaled coordinates
-
-    >>> spos, ele, latv = pel_from_as(spath='structure.as', scaled=True)
-    >>> spos
-    array([[0.        , 0.        , 0.30211854],
-           [0.66666667, 0.33333333, 0.35423709],
-           [0.66666667, 0.33333333, 0.25      ]])
-    >>> ele
-    ['Mo', 'S', 'S']
-    >>> latv
-    array([[ 3.18406646,  0.        ,  0.        ],
-           [-1.59203323,  2.75748245,  0.        ],
-           [ 0.        ,  0.        , 30.        ]])
-    """
-    with open(spath, "r") as f:
-        lines = f.readlines()
-        Natom = int(lines[1])  # 原子总数
-        ele = [line.split()[0] for line in lines[7 : 7 + Natom]]  # 元素列表
-
-        # 晶格矢量
-        latv = np.array([line.split()[0:3] for line in lines[3:6]], dtype=float)
-        # xyz坐标分量
-        coord = np.array(
-            [line.split()[1:4] for line in lines[7 : 7 + Natom]], dtype=float
-        )
-        # coordinates type
-        if lines[6].startswith("C"):  # 笛卡尔 --> 分数坐标
-            spos = np.linalg.solve(latv.T, np.transpose(coord)).T
-        elif lines[6].startswith("D"):
-            spos = coord
-        else:
-            raise ValueError(f"{spath}中的坐标类型未知！")
-
-        if scaled:
-            pos = spos
-        else:
-            pos = np.dot(spos, latv)
-
-    return pos, ele, latv
-
-
 def load_h5(dir_h5: str) -> dict:
     """遍历读取h5文件中的数据，保存为字典格式
 
     慎用此函数，因为会读取很多不需要的数据，耗时很长。
 
     Parameters
     ----------
@@ -853,15 +786,17 @@
     -------
     datas: dict
         数据字典
 
     Examples
     --------
     >>> from dspawpy.io.read import load_h5
-    >>> datas = load_h5(dir_h5)
+    >>> datas = load_h5(dir_h5='/data/home/hzw1002/dspawpy_repo/test/2.2/scf.h5')
+    >>> datas.keys()
+    dict_keys(['/AtomInfo/CoordinateType', '/AtomInfo/Elements', '/AtomInfo/Grid', '/AtomInfo/Lattice', '/AtomInfo/Position', '/Eigenvalue/CBM/BandIndex', '/Eigenvalue/CBM/Energy', '/Eigenvalue/CBM/Kpoint', '/Eigenvalue/NumberOfBand', '/Eigenvalue/Spin1/BandEnergies', '/Eigenvalue/Spin1/Kpoints/Coordinates', '/Eigenvalue/Spin1/Kpoints/Grid', '/Eigenvalue/Spin1/Kpoints/NumberOfKpoints', '/Eigenvalue/Spin1/Occupation', '/Eigenvalue/VBM/BandIndex', '/Eigenvalue/VBM/Energy', '/Eigenvalue/VBM/Kpoint', '/Electron', '/Energy/EFermi', '/Energy/TotalEnergy', '/Energy/TotalEnergy0', '/Force/ForceOnAtoms', '/Stress/Direction', '/Stress/Pressure', '/Stress/Stress', '/Stress/Total', '/Structures/FinalStep', '/Structures/Step-1/Lattice', '/Structures/Step-1/Position'])
     """
 
     def get_names(key, h5_object):
         names.append(h5_object.name)
 
     def is_dataset(name):
         for name_inTheList in names:
@@ -1114,59 +1049,43 @@
                 pdos[atom_index][orbit_name] = {spin: p["Contribution"]}
     pdoss = {structure[i]: pd for i, pd in enumerate(pdos)}
 
     return CompleteDos(structure, total_dos, pdoss)
 
 
 def _get_structure(hdf5: dict, key: str) -> Structure:
-    """For single-step task
-    Examples
-    --------
-    >>> from dspawpy.io.read import load_h5, get_structure
-    >>> hdf5Dict = load_h5('rho.h5')
-    >>> structure = get_structure(hdf5Dict, '/AtomInfo')
-    >>> structure
-    """
+    """For single-step task"""
     # load_h5 -> Structure Obj
     lattice = np.asarray(hdf5[key + "/Lattice"]).reshape(3, 3)
     elements = hdf5[key + "/Elements"]
     positions = hdf5[key + "/Position"]
     coords = np.asarray(positions).reshape(-1, 3)
     is_direct = hdf5[key + "/CoordinateType"][0] == "Direct"
     elements = [re.sub(r"_", "", e) for e in elements]
 
     return Structure(lattice, elements, coords, coords_are_cartesian=(not is_direct))
 
 
 def _get_structure_json(atominfo) -> Structure:
-    """For single-step task
-    Examples
-    --------
-    >>> import json
-    >>> with open('rho.json') as f:
-    >>>     atominfo = json.load(f)['AtomInfo']
-    >>> from dspawpy.io.read import get_structure_json
-    >>> structure = get_structure_json(atominfo)
-    >>> structure
-    """
+    """For single-step task"""
     lattice = np.asarray(atominfo["Lattice"]).reshape(3, 3)
     elements = []
     positions = []
     for atom in atominfo["Atoms"]:
         elements.append(atom["Element"])
         positions.extend(atom["Position"])
 
     coords = np.asarray(positions).reshape(-1, 3)
     is_direct = atominfo["CoordinateType"] == "Direct"
     elements = [re.sub(r"_", "", e) for e in elements]
 
     return Structure(lattice, elements, coords, coords_are_cartesian=(not is_direct))
 
 
-def _get_band_data_h5(band: dict, iwan=False, zero_to_fermi=False):
+def _get_band_data_h5(band: dict, iwan=False, zero_to_efermi=False):
     if iwan:
         bd = "WannBandInfo"
     else:
         bd = "BandInfo"
     number_of_band = band[f"/{bd}/NumberOfBand"][0]
     number_of_kpoints = band[f"/{bd}/NumberOfKpoints"][0]
     if (
@@ -1190,16 +1109,17 @@
         elif f"/{bd}/" + spin_key + "/Band" in band:
             data = band[f"/{bd}/" + spin_key + "/Band"]
         else:
             print("Band key error")
             return
         band_data = np.array(data).reshape((number_of_kpoints, number_of_band)).T
 
-        if zero_to_fermi:
+        if zero_to_efermi:
             eigenvals[spin] = band_data - efermi
+            efermi = 0
         else:
             eigenvals[spin] = band_data
 
     kpoints = np.asarray(band[f"/{bd}/CoordinatesOfKPoints"]).reshape(
         number_of_kpoints, 3
     )
 
@@ -1236,23 +1156,22 @@
                             + str(orbit_index + 1)
                         ]
                         projection[:, :, orbit_index, atom_index] = (
                             np.asarray(project_data)
                             .reshape((number_of_kpoints, number_of_band))
                             .T
                         )
-                if zero_to_fermi:
-                    projections[spin] = projection - efermi
-                else:
-                    projections[spin] = projection
+                projections[spin] = projection
 
     return structure, kpoints, eigenvals, efermi, labels_dict, projections
 
 
-def _get_band_data_json(band: dict, syst: dict = None, iwan=False, zero_to_fermi=False):
+def _get_band_data_json(
+    band: dict, syst: dict = None, iwan=False, zero_to_efermi=False
+):
     # syst is only required for wannier band structure
     if iwan:
         bd = "WannBandInfo"
         structure = _get_structure_json(syst["AtomInfo"])
     else:
         bd = "BandInfo"
         structure = _get_structure_json(band["AtomInfo"])
@@ -1282,15 +1201,15 @@
             data = band[f"{bd}"][spin_key]["Band"]
         else:
             print("Band key error")
             return
 
         band_data = np.array(data).reshape((number_of_kpoints, number_of_band)).T
 
-        if zero_to_fermi:
+        if zero_to_efermi:
             eigenvals[spin] = band_data - efermi
         else:
             eigenvals[spin] = band_data
 
     kpoints = np.asarray(band[f"{bd}"]["CoordinatesOfKPoints"]).reshape(
         number_of_kpoints, 3
     )
@@ -1320,19 +1239,15 @@
                     atom_index = d["AtomIndex"] - 1
                     project_data = d["Contribution"]
                     projection[:, :, orbit_index, atom_index] = (
                         np.asarray(project_data)
                         .reshape((number_of_kpoints, number_of_band))
                         .T
                     )
-
-                if zero_to_fermi:
-                    projections[spin] = projection - efermi
-                else:
-                    projections[spin] = projection
+                projections[spin] = projection
 
     return structure, kpoints, eigenvals, efermi, labels_dict, projections
 
 
 def _get_phonon_band_data_h5(band: dict):
     number_of_band = band["/BandInfo/NumberOfBand"][0]
     number_of_kpoints = band["/BandInfo/NumberOfQPoints"][0]
@@ -1389,7 +1304,36 @@
 
     if "SupercellAtomInfo" in band.keys():
         structure = _get_structure_json(band["SupercellAtomInfo"])
     else:
         structure = _get_structure_json(band["AtomInfo"])
 
     return symmmetry_kpoints, symmetry_kPoints_index, kpoints, structure, frequencies
+
+
+def pel_from_as(spath: str, scaled=False):
+    """backup here for compatibility"""
+    with open(spath, "r") as f:
+        lines = f.readlines()
+        Natom = int(lines[1])  # 原子总数
+        ele = [line.split()[0] for line in lines[7 : 7 + Natom]]  # 元素列表
+
+        # 晶格矢量
+        latv = np.array([line.split()[0:3] for line in lines[3:6]], dtype=float)
+        # xyz坐标分量
+        coord = np.array(
+            [line.split()[1:4] for line in lines[7 : 7 + Natom]], dtype=float
+        )
+        # coordinates type
+        if lines[6].startswith("C"):  # 笛卡尔 --> 分数坐标
+            spos = np.linalg.solve(latv.T, np.transpose(coord)).T
+        elif lines[6].startswith("D"):
+            spos = coord
+        else:
+            raise ValueError(f"{spath}中的坐标类型未知！")
+
+        if scaled:
+            pos = spos
+        else:
+            pos = np.dot(spos, latv)
+
+    return pos, ele, latv
```

## dspawpy/io/structure.py

```diff
@@ -8,15 +8,15 @@
 import numpy as np
 from pymatgen.core import Structure
 
 from dspawpy.io.read import get_lines_without_comment, get_sinfo
 
 
 def build_Structures_from_datafile(
-    datafile: Union[str, List[str]], si=None, ele=None, ai=None
+    datafile: Union[str, List[str]], si=None, ele=None, ai=None, fmt=None
 ) -> List[Structure]:
     r"""读取一/多个h5/json文件，返回pymatgen的Structures列表
 
     Parameters
     ----------
     datafile : str or list
         - h5/json/as/hzw/cif/poscar/cssr/xsf/mcsqs/prismatic/yaml/fleur-inpgen文件路径;
@@ -28,83 +28,90 @@
         - si=[1,2], 读取第一个和第二个构型
         - si=':', 读取所有构型
         - si='-3:', 读取最后三个构型
     ele: str or list
         元素符号，如['H','O']
     ai: int or list
         原子编号，从 1 开始，用法同si
+    fmt: str
+        文件格式，包括 'h5', 'json', 'as', 'hzw' 四种，其他值将被忽略。详见 http://hzwtech.com/Device%20Studio/DS-PAW/build/html/tools.html#structure 8.2节表格
+
 
     Returns
     -------
     List[Structure] : pymatgen Structures 列表
 
     Examples
     --------
 
     >>> from dspawpy.io.structure import build_Structures_from_datafile
 
-    读取单个文件生成 Structures 列表，目前支持 h5/json/as/hzw/cif/poscar/cssr/xsf/mcsqs/prismatic/yaml/fleur-inpgen 格式，文件格式根据后缀名判断，请勿使用不规范的后缀名
+    读取单个文件生成 Structures 列表，支持四种类型
 
-    >>> pymatgen_Structures = build_Structures_from_datafile(datafile='relax.h5')
-    Reading E:\Dev\dspawpy\test\relax.h5 ...
-    >>> pymatgen_Structures
-    [Structure Summary
-    Lattice
-        abc : 3.2024004097211822 3.20240519054306 18.40999985
-    angles : 90.0 90.0 119.99975020767022
-    volume : 163.50740406185463
-        A : 3.2024004097211822 0.0 0.0
-        B : -1.6011905042240808 2.773371228955793 0.0
-        C : 0.0 0.0 18.40999985
-        pbc : True True True
-    PeriodicSite: Mo (1.5977, 0.9224, 9.2050) [0.6652, 0.3326, 0.5000]
-    ...
-    PeriodicSite: S (1.5977, 2.7673, 10.7755) [1.0000, 1.0000, 0.5853]]
+    >>> pymatgen_Structures = build_Structures_from_datafile(datafile='/data/home/hzw1002/dspawpy_repo/test/2.1/relax.h5')
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.1/relax.h5...
+    >>> len(pymatgen_Structures)
+    3
+    >>> pymatgen_Structures = build_Structures_from_datafile(datafile='/data/home/hzw1002/dspawpy_repo/test/2.1/relax.json')
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.1/relax.json...
+     json所含数据仅保留到小数点后四位，与h5或log文件中所记载的数据存在一定误差，可能导致后续保存的结构文件不一致！
+    Warning: mag and fix info are not available for relax.json and nebXX.json yet, trying read info...
+    >>> len(pymatgen_Structures)
+    3
+    >>> pymatgen_Structures = build_Structures_from_datafile(datafile='/data/home/hzw1002/dspawpy_repo/test/supplement/PtH.as')
+    >>> len(pymatgen_Structures)
+    1
+    >>> pymatgen_Structures = build_Structures_from_datafile(datafile='/data/home/hzw1002/dspawpy_repo/test/supplement/PtH.hzw')
+    build from hzw file may lack mag & fix info!
+    >>> len(pymatgen_Structures)
+    1
 
     注意pymatgen_Structures是由多个 Structure 对象组成的列表，每个 Structure 对象分别对应一个构型。如果只有一个构型，也会返回列表，请使用 pymatgen_Structures[0] 获取 Structure 对象
 
     当datafile为列表时，将依次读取多个文件，合并成一个Structures列表
 
-    >>> pymatgen_Structures = build_Structures_from_datafile(datafile=['aimd1.h5','aimd2.h5'])
+    >>> pymatgen_Structures = build_Structures_from_datafile(datafile=['/data/home/hzw1002/dspawpy_repo/test/supplement/aimd1.h5','/data/home/hzw1002/dspawpy_repo/test/supplement/aimd2.h5'])
+    Reading /data/home/hzw1002/dspawpy_repo/test/supplement/aimd1.h5...
+    Reading /data/home/hzw1002/dspawpy_repo/test/supplement/aimd2.h5...
     """
     dfs = []
     if isinstance(datafile, list):  # 续算模式，给的是多个文件
         dfs = datafile
     else:  # 单次计算模式，处理单个文件
         dfs.append(datafile)
 
     # 读取结构数据
     pymatgen_Structures = []
     for df in dfs:
-        structure_list = _get_structure_list(df, si, ele, ai)
+        structure_list = _get_structure_list(df, si, ele, ai, fmt)
         pymatgen_Structures.extend(structure_list)
 
     return pymatgen_Structures
 
 
-def _get_structure_list(df: str, si=None, ele=None, ai=None) -> List[Structure]:
+def _get_structure_list(
+    df: str, si=None, ele=None, ai=None, fmt=None
+) -> List[Structure]:
     """get pymatgen structures from single datafile
 
     Parameters
     ----------
     df : str
         datafile
 
     Returns
     -------
     List[Structure] : list of pymatgen structures
-
-    Examples
-    --------
-    >>> from dspawpy.analysis.aimdtools import get_structure_list
-    >>> structure_list = get_structure_list(df='aimd.h5')
     """
 
-    # create Structure structure_list from aimd.h5
-    fmt = df.split(".")[-1]
+    if fmt is None:
+        fmt = df.split(".")[-1]
+    else:
+        assert isinstance(fmt, str), "fmt must be str"
+
     if fmt == "as":
         strs = [_from_dspaw_as(df)]
     elif fmt == "hzw":
         print("build from hzw file may lack mag & fix info!")
         strs = [_from_hzw(df)]
     elif fmt == "h5" or fmt == "json":
         Nstep, elements, positions, lattices, D_mag_fix = get_sinfo(
@@ -148,19 +155,14 @@
     as_file : str
         DSPAW的as结构文件, 默认'structure.as'
 
     Returns
     -------
     Structure
         pymatgen的Structure对象
-
-    Examples
-    --------
-    >>> from dspawpy.io.structure import from_dspaw_as
-    >>> S1 = from_dspaw_as(as_file='structure00.as')
     """
 
     lines = get_lines_without_comment(as_file, "#")
     N = int(lines[1])  # number of atoms
 
     # parse lattice info
     lattice = []  # lattice matrix
@@ -266,19 +268,14 @@
     hzw_file : str
         hzw结构文件，以 .hzw 结尾
 
     Returns
     -------
     Structure
         pymatgen的Structure对象
-
-    Examples
-    --------
-    >>> from dspawpy.io.structure import from_hzw
-    >>> S1 = from_hzw(hzw_file='Si.hzw')
     """
     lines = get_lines_without_comment(hzw_file, "%")
     number_of_probes = int(lines[0])
     if number_of_probes != 0:
         raise ValueError("dspaw only support 0 probes hzw file")
     lattice = []
     for line in lines[1:4]:
```

## dspawpy/io/utils.py

```diff
@@ -1,13 +1,17 @@
+# ! some functions are copied from ase
+# see https://wiki.fysik.dtu.dk/ase/index.html
+
 import os
 from typing import List
 
 import numpy as np
 import pandas as pd
 from pymatgen.electronic_structure.core import OrbitalType
+from pymatgen.electronic_structure.dos import CompleteDos
 from scipy import integrate
 
 from dspawpy.io.read import get_ele_from_h5
 
 Na = 6.02214179e23  # 阿伏伽德罗常数 单位 /mol
 h = 6.6260696e-34  # 普朗克常数 单位J*s
 kB = 1.3806503e-23  # 玻尔兹曼常数 J/K
@@ -287,16 +291,16 @@
         质量列表
 
     Examples
     --------
     >>> from dspawpy.io.utils import eles2masses
     >>> eles = ["H", "O"]
     >>> masses = eles2masses(eles)
-    >>> print(masses)
-    [1.00794, 15.9994]
+    >>> masses
+    array([ 1.008, 15.999])
     """
     masses = []
     for e in eles:
         masses.append(atomic_masses_iupac2016[atomic_numbers[e]])
     return np.array(masses)
 
 
@@ -345,25 +349,37 @@
         Potential energy in eV.
     elements : list
         such as ['H', 'O'].
     symmetrynumber : int
         Symmetry number.
     spin : int
         Spin multiplicity.
-    Natom : int
+    natoms : int
         Number of atoms.
 
     Examples
     --------
     >>> from dspawpy.io.utils import IdealGasThermo
     >>> thermo = IdealGasThermo(vib_energies=[0.1, 0.2, 0.3, 0.4, 0.5, 0.6],
     ...                         geometry='linear', potentialenergy=0.,  # eV
     ...                         elements=['H', 'O'], positions=[[0, 0, 0], [0, 0, 1]],  # angstrom
-    ...                         symmetrynumber=None, spin=None, Natom=None)
-    >>> thermo.get_free_energy(298.15)  # K
+    ...                         symmetrynumber=None, spin=None, natoms=None)
+    >>> thermo.get_enthalpy(298.15)  # K
+    Enthalpy components at T = 298.15 K:
+    ===============================
+    E_pot                  0.000 eV
+    E_ZPE                  0.300 eV
+    Cv_trans (0->T)        0.039 eV
+    Cv_rot (0->T)          0.026 eV
+    Cv_vib (0->T)          0.000 eV
+    (C_v -> C_p)           0.026 eV
+    -------------------------------
+    H                      0.390 eV
+    ===============================
+    0.389924026967057
     """
 
     # 读取elements数组代替atoms
     def __init__(
         self,
         vib_energies,
         geometry,
@@ -603,20 +619,20 @@
     -------
     TSgas : float
         理想气体近似下，计算熵的能量贡献，单位eV
 
     Examples
     --------
     >>> from dspawpy.io.utils import getTSgas
-    >>> TSgas = getTSgas(fretxt='frequency.txt', datafile=None, potentialenergy=-0.0, elements=['H', 'H'], geometry='linear', positions=[[0.0, 0.0, 0.0], [0.0, 0.0, 1.0]], symmetrynumber=1, spin=1, temperature=298.15, pressure=101325.0)
-    >>> TSgas
-    0.5037357905277046
-    >>> TSgas = getTSgas(fretxt='frequency.txt', datafile='.', potentialenergy=-0.0,  geometry='linear', symmetrynumber=1, spin=1, temperature=298.15, pressure=101325.0)
+    >>> TSgas = getTSgas(fretxt='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt', datafile='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.h5', potentialenergy=-0.0,  geometry='linear', symmetrynumber=1, spin=1, temperature=298.15, pressure=101325.0)
+    >>> print(TSgas)
+    0.8515317035550232
+    >>> TSgas = getTSgas(fretxt='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt', datafile='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.h5', potentialenergy=-0.0,  geometry='linear', symmetrynumber=1, spin=1, temperature=298.15, pressure=101325.0)
     >>> TSgas
-    0.6790991704342505
+    0.8515317035550232
     """
     ve = []
     with open(fretxt) as ft:
         lines = ft.readlines()
         for i in range(2, len(lines)):
             if lines[i].strip()[1] == "f/i":
                 ve.append(complex(lines[i].split()[-1]) / 1000)
@@ -671,15 +687,15 @@
         spin=spin,
     )
     S = thermo.get_entropy(temperature, pressure)
 
     return S * temperature
 
 
-def d_band(spin, dos_data):  # 定义函数，括号里给出函数的两个变量
+def d_band(spin, dos_data: CompleteDos):  # 定义函数，括号里给出函数的两个变量
     """计算d带中心
 
     Parameters
     ----------
     spin : Spin.up或Spin.down
         自旋类型，
     dos_data : pymatgen.electronic_structure.dos.CompleteDos
@@ -690,17 +706,21 @@
     db1 : float
         d带中心数值
 
     Examples
     --------
     >>> from dspawpy.io.utils import d_band
     >>> from dspawpy.io.read import get_dos_data
-    >>> dd = get_dos_data("dos.h5")  # 从dos.h5中读取数据
-    >>> db1 = d_band(spin=Spin.up, dos_data=dd)
-    >>> print(db1)
+    >>> dos_data = get_dos_data("/data/home/hzw1002/dspawpy_repo/test/supplement/dos.h5")  # 从dos.h5中读取数据
+    >>> for spin in dos_data.densities:
+    ...     print(f'{spin=}')
+    ...     c = d_band(spin, dos_data)
+    ...     print(c)
+    spin=<Spin.up: 1>
+    -3.666508748164936
     """
     dos_d = dos_data.get_spd_dos()[OrbitalType.d]
     # dos_d = dos_data.get_spd_dos()[d]
     Efermi = dos_data.efermi
     epsilon = dos_d.energies - Efermi  # shift d-band center
 
     N1 = dos_d.densities[spin]
@@ -725,17 +745,24 @@
     -------
     ZPE: float
         零点能
 
     Examples
     --------
     >>> from dspawpy.io.utils import getZPE
-    >>> ZPE= getZPE(fretxt='frequency.txt', T=298.15)
+    >>> ZPE= getZPE(fretxt='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt')
+    === 从/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt中读取到的相关如下 ===
+       Frequency (meV)
+    0       284.840033
+    <BLANKLINE>
+    正在写入ZPE.dat文件...
+    <BLANKLINE>
+    --> Zero-point energy,  ZPE (eV): 0.1424200165
     >>> ZPE
-    0.8842567390000002
+    0.1424200165
     """
 
     # 1. read data
     data_get_ZPE = []
     with open(fretxt, "r") as f:
         for line in f.readlines():
             data_line = line.strip().split()
@@ -791,17 +818,23 @@
     -------
     TS: float
         熵校正
 
     Examples
     --------
     >>> from dspawpy.io.utils import getTSads
-    >>> TS = getTSads(fretxt='frequency.txt', T=298.15)
+    >>> TS = getTSads(fretxt='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt', T=298.15)
+    === 从/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt中读取到的相关如下 ===
+       Frequency (THz)
+    0        68.873993
+    <BLANKLINE>
+    正在写入TS.dat文件...
+    --> Entropy contribution, T*S (eV)： 4.7566997225177686e-06
     >>> TS
-    0.18362317157111566
+    4.7566997225177686e-06
     """
     data_get_TS = []
     with open(fretxt, "r") as f:
         for line in f.readlines():
             data_line = line.strip().split()
             if len(data_line) != 6:
                 continue
@@ -869,19 +902,32 @@
         零点能
     TS: float
         熵校正
 
     Examples
     --------
     >>> from dspawpy.io.utils import thermo_correction
-    >>> ZPE, TS = thermo_correction(fretxt='frequency.txt', T=298.15)
+    >>> ZPE, TS = thermo_correction(fretxt='/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt', T=298.15)
+    === 从/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt中读取到的相关如下 ===
+       Frequency (meV)
+    0       284.840033
+    <BLANKLINE>
+    正在写入ZPE.dat文件...
+    <BLANKLINE>
+    --> Zero-point energy,  ZPE (eV): 0.1424200165
+    === 从/data/home/hzw1002/dspawpy_repo/test/2.13/frequency.txt中读取到的相关如下 ===
+       Frequency (THz)
+    0        68.873993
+    <BLANKLINE>
+    正在写入TS.dat文件...
+    --> Entropy contribution, T*S (eV)： 4.7566997225177686e-06
     >>> ZPE
-    0.8842567390000002
+    0.1424200165
     >>> TS
-    0.18362317157111566
+    4.7566997225177686e-06
     """
 
     ZPE = getZPE(fretxt=fretxt)
     sum_S = getTSads(fretxt=fretxt, T=T)
 
     return ZPE, sum_S
```

## dspawpy/io/write.py

```diff
@@ -19,23 +19,21 @@
 
     Parameters
     ----------
     structures: list
         pymatgen的Structures列表
     xyzfile : str
         写入xyz格式的轨迹文件，默认为aimdTraj.xyz
-
-    Example
-    -------
-    >>> from dspawpy.io.write import write_xyz_traj
-    >>> write_xyz_traj(datafile='aimd.h5', ai=[1,2,3], index=1, xyzfile='aimdTraj.xyz')
-    Reading E:\Dev\dspawpy\test\new\aimd.h5 ...
     """
     if not isinstance(structures, list):  # single Structure
         structures = [structures]
+    if os.path.isfile(xyzfile):
+        print("Warning: %s already exists and will be overwritten!" % xyzfile)
+    if os.path.dirname(xyzfile) != "":
+        os.makedirs(os.path.dirname(xyzfile), exist_ok=True)
     with open(xyzfile, "w") as f:
         # Nstep
         for _, structure in enumerate(structures):
             # 原子数不会变，就是不合并的元素总数
             eles = [s.species_string for s in structure.sites]
             f.write("%d\n" % len(eles))
             # lattice
@@ -72,23 +70,21 @@
 
     Parameters
     ----------
     structures: list
         pymatgen的Structures列表
     dumpfile : str
         dump格式的轨迹文件名，默认为aimdTraj.dump
-
-    Example
-    -------
-    >>> from dspawpy.io.write import write_dump_traj
-    >>> write_dump_traj(datafile='aimd.h5', ai=[1,2,3], index=1, dumpfile='aimdTraj.dump')
-    Reading E:\Dev\dspawpy\test\new\aimd.h5 ...
     """
     if not isinstance(structures, list):  # single Structure
         structures = [structures]
+    if os.path.isfile(dumpfile):
+        print("Warning: %s already exists and will be overwritten!" % dumpfile)
+    if os.path.dirname(dumpfile) != "":
+        os.makedirs(os.path.dirname(dumpfile), exist_ok=True)
     with open(dumpfile, "w") as f:
         for n, structure in enumerate(structures):
             lat = structure.lattice.matrix
             eles = [s.species_string for s in structure.sites]
             poses = structure.cart_coords
 
             box_bounds = _get_lammps_non_orthogonal_box(lat)
@@ -140,15 +136,15 @@
     --------
     out_filename : file
         VESTA格式的文件
 
     Examples
     --------
     >>> from dspawpy.io.write import write_VESTA
-    >>> write_VESTA("DS-PAW.json", "rho")
+    >>> write_VESTA("/data/home/hzw1002/dspawpy_repo/test/2.2/rho.json", "rho", out_filename='/data/home/hzw1002/dspawpy_repo/test/out/rho.json')
     """
     if in_filename.endswith(".h5"):
         data = load_h5(in_filename)
         if data_type.lower() == "rho" or data_type.lower() == "boundcharge":
             _write_VESTA_format(data, ["/Rho/TotalCharge"], out_filename)
         elif data_type.lower() == "potential":
             _write_VESTA_format(
@@ -215,18 +211,21 @@
     -------
     output : file
         电荷差分（AB-A-B）后的电荷密度文件，
 
     Examples
     --------
     >>> from dspawpy.io.write import write_delta_rho_vesta
-    >>> write_delta_rho_vesta('AB.h5', 'A.h5', 'B.h5', 'delta_rho.vesta')
-    >>> write_delta_rho_vesta('AB.json', 'A.json', 'B.json', 'delta_rho.vesta')
-    # 甚至可以混写
-    >>> write_delta_rho_vesta('AB.h5', 'A.json', 'B.json', 'delta_rho.vesta')
+    >>> write_delta_rho_vesta('/data/home/hzw1002/dspawpy_repo/test/supplement/AB.h5', '/data/home/hzw1002/dspawpy_repo/test/supplement/A.h5', '/data/home/hzw1002/dspawpy_repo/test/supplement/B.h5', '/data/home/hzw1002/dspawpy_repo/test/out/delta_rho.vesta')
+    读取/data/home/hzw1002/dspawpy_repo/test/supplement/AB.h5...
+    读取/data/home/hzw1002/dspawpy_repo/test/supplement/A.h5...
+    读取/data/home/hzw1002/dspawpy_repo/test/supplement/B.h5...
+    计算电荷差分...
+    写入文件/data/home/hzw1002/dspawpy_repo/test/out/delta_rho.vesta...
+    成功写入 /data/home/hzw1002/dspawpy_repo/test/out/delta_rho.vesta
     """
     print(f"读取{AB}...")
     if AB.endswith(".h5"):
         dataAB = load_h5(AB)
         rhoAB = np.array(dataAB["/Rho/TotalCharge"])
         nGrids = dataAB["/AtomInfo/Grid"]
         atom_symbol = dataAB["/AtomInfo/Elements"]
@@ -280,14 +279,18 @@
     for i in range(len(element)):
         element_num[i] = atom_symbol.count(element[i])
 
     latticeConstantMatrix = np.array(latticeConstantMatrix)
     latticeConstantMatrix = latticeConstantMatrix.reshape(3, 3)
 
     print(f"写入文件{output}...")
+    if os.path.isfile(output):
+        print("Warning: %s already exists and will be overwritten!" % output)
+    if os.path.dirname(output) != "":
+        os.makedirs(os.path.dirname(output), exist_ok=True)
     with open(output, "w") as out:
         out.write("DS-PAW_rho\n")
         out.write("    1.000000\n")
         for i in range(3):
             for j in range(3):
                 out.write("    " + str(latticeConstantMatrix[i, j]) + "    ")
             out.write("\n")
@@ -327,67 +330,79 @@
     Parameters
     ----------
     structure : Structure
         pymatgen的Structure对象
     filename : str
         结构文件名
     fmt : str
-        - 结构文件类型，目前支持 'json', 'as', 'hzw', 'pdb', 'xyz', 'dump', 'cif', 'poscar', 'cssr', 'xsf', 'mcsqs', 'prismatic', 'yaml', 'fleur-inpgen'
-        - 若不指定，则根据文件名后缀判断
+        - 结构文件类型，原生支持 'json', 'as', 'hzw', 'pdb', 'xyz', 'dump' 六种，具体匹配规则见http://hzwtech.com/Device%20Studio/DS-PAW/build/html/tools.html#structure 8.2节表格
         - 'pdb', 'xyz' 和 'dump' 支持传入多个结构，structure参数可以是一个Structure对象列表；其他类型的文件只支持传入单个结构
     coords_are_cartesian : bool
         - 是否写作笛卡尔坐标，默认为True；否则写成分数坐标形式
         - 此选项暂时仅对 as 和 json 格式有效
     si : int
         结构编号索引
 
     Examples
     --------
 
-    如果不指定 fmt 参数，将尝试根据文件名后缀判断。
-
-    如果要生成 as 结构文件（可用于开始新任务），可参考如下命令:
+    先读取结构信息:
 
     >>> from dspawpy.io.structure import build_Structures_from_datafile
-    >>> s = build_Structures_from_datafile('neb01.h5', index=1)[0]
-    Reading E:\Dev\dspawpy\test\new\neb01.h5 ...
+    >>> s = build_Structures_from_datafile('/data/home/hzw1002/dspawpy_repo/test/2.15/01/neb01.h5')
+    Reading /data/home/hzw1002/dspawpy_repo/test/2.15/01/neb01.h5...
+    >>> len(s)
+    17
+
+    将结构信息写入文件：
+
     >>> from dspawpy.io.write import to_file
-    >>> to_file(s, filename='PtH.as', coords_are_cartesian=True)
-    --> 成功写入文件 E:\Dev\dspawpy\test\new\PtH.as
+    >>> to_file(s, filename='/data/home/hzw1002/dspawpy_repo/test/out/PtH.json', coords_are_cartesian=True)
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/PtH.json
+    >>> to_file(s, filename='/data/home/hzw1002/dspawpy_repo/test/out/PtH.as', coords_are_cartesian=True)
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/PtH.as
+    >>> to_file(s, filename='/data/home/hzw1002/dspawpy_repo/test/out/PtH.hzw', coords_are_cartesian=True)
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/PtH.hzw
+    >>> to_file(s, filename='/data/home/hzw1002/dspawpy_repo/test/out/PtH.pdb', coords_are_cartesian=True)
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/PtH.pdb
+    >>> to_file(s, filename='/data/home/hzw1002/dspawpy_repo/test/out/PtH.xyz', coords_are_cartesian=True)
+    /data/home/hzw1002/dspawpy_repo/test/out/PtH.xyz 文件已保存！
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/PtH.xyz
+    >>> to_file(s, filename='/data/home/hzw1002/dspawpy_repo/test/out/PtH.dump', coords_are_cartesian=True)
+    /data/home/hzw1002/dspawpy_repo/test/out/PtH.dump 文件已保存！
+    --> 成功写入文件 /data/home/hzw1002/dspawpy_repo/test/out/PtH.dump
 
-    如果 Structure 中有磁矩或自由度信息，将会按最完整的格式统一写入，形如 Fix_x, Fix_y, Fix_z, Mag_x, Mag_y, Mag_z，自由度信息默认为 F，磁矩默认为 0.0。可视情况自行手动删除生成的 as 文件中的这些默认信息
+    单结构信息推荐使用 as 格式存储，如果 Structure 中有磁矩或自由度信息，将会按最完整的格式统一写入，形如 Fix_x, Fix_y, Fix_z, Mag_x, Mag_y, Mag_z，自由度信息默认为 F，磁矩默认为 0.0。可视情况自行手动删除生成的 as 文件中的这些默认信息
 
-    >>> with open('PtH.as') as f:
+    >>> with open('/data/home/hzw1002/dspawpy_repo/test/out/PtH.as') as f:
     ...     print(f.read())
     ...
     Total number of atoms
-    3
+    13
     Lattice Fix_x Fix_y Fix_z
-    5.60580000 0.00000000 0.00000000 F F F
-    0.00000000 5.60580000 0.00000000 F F F
-    0.00000000 0.00000000 16.81740000 F F F
+     5.60580000 0.00000000 0.00000000 F F F
+     0.00000000 5.60580000 0.00000000 F F F
+     0.00000000 0.00000000 16.81740000 F F F
     Cartesian Fix_x Fix_y Fix_z Mag
-    H 2.48770271 3.85219888 6.93647446 F F F 0.0
-    Pt 1.40145000 1.40145000 1.98192999 T T T 0.0
-    Pt 4.20434996 1.40145000 1.98192999 T T T 0.0
-
-    写成 json 文件，将忽略磁矩和自由度信息
-
-    >>> to_file(s, filename='PtH.json')
-    --> 成功写入文件 E:\Dev\dspawpy\test\new\PtH.json
-
-    写成 hzw 文件，也将忽略磁矩和自由度信息
+    H 2.58985263 3.72755271 6.94246998 F F F 0.0
+    Pt 1.37942121 1.39655502 1.96304099 F F F 0.0
+    Pt 4.20055071 1.40326436 1.94681875 F F F 0.0
+    Pt 1.37462277 4.20932677 2.00221003 F F F 0.0
+    Pt 4.21197615 4.21324064 1.99578112 F F F 0.0
+    Pt 5.58740047 5.59517338 3.93274445 F F F 0.0
+    Pt 5.58633749 2.78068345 3.91301343 F F F 0.0
+    Pt 2.79076605 5.59305895 3.91208092 F F F 0.0
+    Pt 2.78904685 2.78501463 3.89610696 F F F 0.0
+    Pt 1.38102265 1.36691874 5.84326681 F F F 0.0
+    Pt 4.19057728 1.36788897 5.84877666 F F F 0.0
+    Pt 1.34667410 4.16198043 5.89298591 F F F 0.0
+    Pt 4.17046728 4.15729941 5.89874209 F F F 0.0
+    <BLANKLINE>
 
-    >>> to_file(s, filename='PtH.hzw')
-    --> 成功写入文件 E:\Dev\dspawpy\test\new\PtH.hzw
-
-    写成 pdb 文件，也将忽略磁矩和自由度信息
-
-    >>> to_file(s, filename='PtH.pdb')
-    --> 成功写入文件 E:\Dev\dspawpy\test\new\PtH.pdb
+    写成 json / hzw/ pdb 文件，将忽略磁矩和自由度信息
     """
     if si is not None:
         assert isinstance(si, int), "si 应当是用于索引列表的整数"
     if isinstance(structure, Structure):
         structure = [structure]
 
     if fmt is None:
@@ -423,32 +438,41 @@
         if si:
             _to_hzw(structure[si], filename)
         else:
             _to_hzw(structure[-1], filename)
 
     elif fmt in [
         "cif",
+        "mcif",
         "poscar",
         "cssr",
         "xsf",
         "mcsqs",
-        "prismatic",
         "yaml",
         "fleur-inpgen",
+        "prismatic",
+        "res",
     ]:
         if si:
             structure[si].to(filename, fmt=fmt)
         else:
             structure[-1].to(filename, fmt=fmt)
+
     else:
-        raise NotImplementedError(
-            f"暂不支持写成 {fmt} 格式，支持的格式包括：pdb, xyz, dump, json, as, hzw, cif, poscar, cssr, xsf, mcsqs, prismatic, yaml, fleur-inpgen"
-        )
+        try:
+            if si:
+                structure[si].to(filename)
+            else:
+                structure[-1].to(filename)
+        except Exception as e:
+            raise NotImplementedError(
+                f"除了 pdb, xyz, dump, json, as, hzw 六种格式外，其他格式一律移交 pymatgen 处理，然而\n--> pymatgen返回错误：{e}"
+            )
 
-    print(f"--> 成功写入文件 {os.path.abspath(filename)} ")
+    print(f"--> 成功写入文件 {os.path.abspath(filename)}")
 
 
 def _write_atoms(fileobj, hdf5):
     fileobj.write("DS-PAW Structure\n")
     fileobj.write("  1.00\n")
     lattice = np.asarray(hdf5["/AtomInfo/Lattice"]).reshape(-1, 1)  # 将列表lattice下的多个列表整合
     fileobj.write(
@@ -486,14 +510,18 @@
         fileobj.write("%10.6f" % p)
         if (i + 1) % 3 == 0:
             fileobj.write("\n")
     fileobj.write("\n")
 
 
 def _write_VESTA_format(hdf5: dict, datakeys: list, filename):
+    if os.path.isfile(filename):
+        print("Warning: %s already exists and will be overwritten!" % filename)
+    if os.path.dirname(filename) != "":
+        os.makedirs(os.path.dirname(filename), exist_ok=True)
     with open(filename, "w") as file:
         _write_atoms(file, hdf5)
         for key in datakeys:
             d = np.asarray(hdf5[key]).reshape(-1, 1)  # 将列表hdf5[key]下的多个列表整合
             file.write("%5d %5d %5d\n" % tuple(hdf5["/AtomInfo/Grid"]))
             i = 0
             while i < len(d):
@@ -539,14 +567,18 @@
         fileobj.write("Cartesian\n")
     for atom in atom_info["Atoms"]:
         fileobj.write("%10.6f %10.6f %10.6f\n" % tuple(atom["Position"]))
     fileobj.write("\n")
 
 
 def _write_VESTA_format_json(atom_info: dict, data: list, filename):
+    if os.path.isfile(filename):
+        print("Warning: %s already exists and will be overwritten!" % filename)
+    if os.path.dirname(filename) != "":
+        os.makedirs(os.path.dirname(filename), exist_ok=True)
     with open(filename, "w") as file:
         _write_atoms_json(file, atom_info)
         for d in data:
             file.write("%5d %5d %5d\n" % tuple(atom_info["Grid"]))
             i = 0
             while i < len(d):
                 for j in range(10):
@@ -557,14 +589,18 @@
                 file.write("\n")
 
             file.write("\n")
 
 
 def _to_dspaw_as(structure, filename: str, coords_are_cartesian=True):
     """write dspaw structure file of .as type"""
+    if os.path.isfile(filename):
+        print("Warning: %s already exists and will be overwritten!" % filename)
+    if os.path.dirname(filename) != "":
+        os.makedirs(os.path.dirname(filename), exist_ok=True)
     with open(filename, "w", encoding="utf-8") as file:
         file.write("Total number of atoms\n")
         file.write("%d\n" % len(structure))
 
         # ^ write lattice info
         if "LatticeFixs" in structure.sites[0].properties:
             lfinfo = structure.sites[0].properties["LatticeFixs"]
@@ -644,14 +680,18 @@
             file.write(
                 "%s %.8f %.8f %.8f %s\n"
                 % (site.species_string, coords[0], coords[1], coords[2], final_strs)
             )
 
 
 def _to_hzw(structure, filename: str):
+    if os.path.isfile(filename):
+        print("Warning: %s already exists and will be overwritten!" % filename)
+    if os.path.dirname(filename) != "":
+        os.makedirs(os.path.dirname(filename), exist_ok=True)
     with open(filename, "w", encoding="utf-8") as file:
         file.write("% The number of probes \n")
         file.write("0\n")
         file.write("% Uni-cell vector\n")
 
         for v in structure.lattice.matrix:
             file.write("%.6f %.6f %.6f\n" % (v[0], v[1], v[2]))
@@ -672,23 +712,30 @@
     atoms = []
     for site in structure:
         coords = site.coords if coords_are_cartesian else site.frac_coords
         atoms.append({"Element": site.species_string, "Position": coords.tolist()})
 
     coordinate_type = "Cartesian" if coords_are_cartesian else "Direct"
     d = {"Lattice": lattice, "CoordinateType": coordinate_type, "Atoms": atoms}
-
+    if os.path.isfile(filename):
+        print("Warning: %s already exists and will be overwritten!" % filename)
+    if os.path.dirname(filename) != "":
+        os.makedirs(os.path.dirname(filename), exist_ok=True)
     with open(filename, "w", encoding="utf-8") as file:
         json.dump(d, file, indent=4)
 
 
-def _to_pdb(structures, pdb_filename: str):
+def _to_pdb(structures, filename: str):
     if not isinstance(structures, list):
         structures = [structures]
-    with open(pdb_filename, "w", encoding="utf-8") as file:
+    if os.path.isfile(filename):
+        print("Warning: %s already exists and will be overwritten!" % filename)
+    if os.path.dirname(filename) != "":
+        os.makedirs(os.path.dirname(filename), exist_ok=True)
+    with open(filename, "w", encoding="utf-8") as file:
         for i, s in enumerate(structures):
             file.write("MODEL         %d\n" % (i + 1))
             file.write("REMARK   Converted from Structures\n")
             file.write("REMARK   Converted using dspawpy\n")
             lengths = s.lattice.lengths
             angles = s.lattice.angles
             file.write(
```

## Comparing `dspawpy-0.9.7.dist-info/RECORD` & `dspawpy-0.9.8.dist-info/RECORD`

 * *Files 12% similar despite different names*

```diff
@@ -1,20 +1,20 @@
-dspawpy/__init__.py,sha256=83qFJMFAgvdHV5e8Nh9ByUaQinNxBUPlTKjxfpge3xM,23
-dspawpy/plot.py,sha256=ocLkU08WfMb2fyETrBSSZvxZFSg2sPX8rLusXZLT5BM,29208
+dspawpy/__init__.py,sha256=4eQCGJV2-GRHX8FlvA_4etK0E4LFj2or592J4aePZoA,23
+dspawpy/plot.py,sha256=bNIDKC2sUb95CAjOesxIgOiX5WVMI1XUtY9Hs7VwDcY,30667
 dspawpy/analysis/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-dspawpy/analysis/aimdtools.py,sha256=iAUHcBECcmpG8gmBELoaiwfDT1KxTjrehzcotOufnEg,23645
+dspawpy/analysis/aimdtools.py,sha256=53OItAHmLBARdVuMGcrTaFByqV0iBrAvV77DSoA0VMI,24367
 dspawpy/analysis/vacf.py,sha256=g5IS6Q7QGYa17XBVnYEH-MubGSpkUsDPpMaI_ELacw4,20152
 dspawpy/diffusion/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-dspawpy/diffusion/neb.py,sha256=h2n3wYmEEpVhF5EeiDnColcotw3CyEHaiAfSHyb0BMU,3270
-dspawpy/diffusion/nebtools.py,sha256=wK-W9_8AQZHaZ_Q9Kvh95Olgduz2s9u0zQFZRemJrbw,53498
+dspawpy/diffusion/neb.py,sha256=NnOFZLOVOlbuBblgI4jOnphq95u0dhNPYlSneItmI_0,4028
+dspawpy/diffusion/nebtools.py,sha256=P_N6KhTd3T5WrIxKzD7_ul-WmGQCW2E76E5zltaBNG4,56939
 dspawpy/diffusion/pathfinder.py,sha256=HhCVoh42Q2qIksBAruZ1atULfR5D55uzZvbaCtUxSig,11045
 dspawpy/io/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-dspawpy/io/read.py,sha256=ZDcow03EV2TGBnQ8cO68r3a0l4P1wqh99W1xWFofZLc,53355
+dspawpy/io/read.py,sha256=lvqzThjXbhwG6IFrNhzcAQrOnnsaC0N52Yo6q8WJr-k,54091
 dspawpy/io/read_json.py,sha256=2bcNQP51SR2yMyFE7c2TIutYp93K8IH-dpLmH5yy4bo,7721
-dspawpy/io/structure.py,sha256=HenUYKsB4YRa8I5F_WtlZ5Mq226cOGQXmHx2BpXi2qI,9880
-dspawpy/io/utils.py,sha256=ff2182s8KQWQ53bHYdlWuXuN3lkDLAH6zrNub1t_9wA,25239
-dspawpy/io/write.py,sha256=jimEccJMmL2ybY1gjSaf0A5JNJ783XOZ6YJRLksEaG0,26180
+dspawpy/io/structure.py,sha256=TITW2CZVF1dLce0YElV6kd3ypXEeagA_Galgb7DDwSI,10317
+dspawpy/io/utils.py,sha256=oI2nbSEhRboOXuLTwItLHDoTke_dYs0dVFSBYhcJSwc,27299
+dspawpy/io/write.py,sha256=SdiutidLJ1Z7PdumHaJ-X0uAIppdXY9G08FZCwwC7Y8,29663
 dspawpy/io/write_json.py,sha256=n3GhdDnFFtW7eY4U5u7czdlpbSWnsGP7WUD5eS1ZmqI,1761
-dspawpy-0.9.7.dist-info/METADATA,sha256=Pzg-TDwjVSz1dmQa4PmYFwVMgJtTheh-f-sPH09t1Go,3075
-dspawpy-0.9.7.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-dspawpy-0.9.7.dist-info/top_level.txt,sha256=esEMNTnd880qHE4wkZVKM3gzqZMuOobS886owAyaUmA,8
-dspawpy-0.9.7.dist-info/RECORD,,
+dspawpy-0.9.8.dist-info/METADATA,sha256=SRJLuw-3OfUChpVmzr0fXNHZLIDMY7vU28wHa5p9dVU,4282
+dspawpy-0.9.8.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
+dspawpy-0.9.8.dist-info/top_level.txt,sha256=esEMNTnd880qHE4wkZVKM3gzqZMuOobS886owAyaUmA,8
+dspawpy-0.9.8.dist-info/RECORD,,
```

