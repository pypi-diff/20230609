# Comparing `tmp/skytemple_ssb_debugger-1.4.4-py3-none-any.whl.zip` & `tmp/skytemple_ssb_debugger-1.6.0a1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,121 +1,119 @@
-Zip file size: 1746591 bytes, number of entries: 119
--rw-r--r--  2.0 unx        0 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/__init__.py
--rw-r--r--  2.0 unx   226635 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/debugger.glade
--rw-r--r--  2.0 unx     9098 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/emulator_thread.py
--rw-r--r--  2.0 unx     3893 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/exps.lang
--rw-r--r--  2.0 unx     3444 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/main.py
--rw-r--r--  2.0 unx        0 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/py.typed
--rw-r--r--  2.0 unx     6028 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/ssbs.lang
--rw-r--r--  2.0 unx     6091 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/threadsafe.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/context/__init__.py
--rw-r--r--  2.0 unx     8127 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/context/abstract.py
--rw-r--r--  2.0 unx     7698 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/context/standalone.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/__init__.py
--rw-r--r--  2.0 unx     7996 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/debug_overlay.py
--rw-r--r--  2.0 unx    20859 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/debugger.py
--rw-r--r--  2.0 unx    17516 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/editor_notebook.py
--rw-r--r--  2.0 unx     7303 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/global_state.py
--rw-r--r--  2.0 unx    18606 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/ground_state.py
--rw-r--r--  2.0 unx     5609 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/local_variable.py
--rw-r--r--  2.0 unx    77862 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/main.py
--rw-r--r--  2.0 unx    48242 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/script_editor.py
--rw-r--r--  2.0 unx    29755 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/ssb_editor.glade
--rw-r--r--  2.0 unx    19625 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/controller/variable.py
--rw-r--r--  2.0 unx   967861 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/1024x1024/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx     5442 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-debug-symbolic.symbolic.png
--rw-r--r--  2.0 unx     2495 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
--rw-r--r--  2.0 unx      837 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-into-symbolic.symbolic.png
--rw-r--r--  2.0 unx     1287 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-next-symbolic.symbolic.png
--rw-r--r--  2.0 unx      768 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-out-symbolic.symbolic.png
--rw-r--r--  2.0 unx      564 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-over-symbolic.symbolic.png
--rw-r--r--  2.0 unx    42129 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx      468 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-debug-symbolic.symbolic.png
--rw-r--r--  2.0 unx      326 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
--rw-r--r--  2.0 unx      225 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-into-symbolic.symbolic.png
--rw-r--r--  2.0 unx      245 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-next-symbolic.symbolic.png
--rw-r--r--  2.0 unx      225 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-out-symbolic.symbolic.png
--rw-r--r--  2.0 unx      236 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-over-symbolic.symbolic.png
--rw-r--r--  2.0 unx     3167 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx    11630 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-debug-symbolic.symbolic.png
--rw-r--r--  2.0 unx     5555 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
--rw-r--r--  2.0 unx     1441 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-into-symbolic.symbolic.png
--rw-r--r--  2.0 unx     2555 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-next-symbolic.symbolic.png
--rw-r--r--  2.0 unx     1451 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-out-symbolic.symbolic.png
--rw-r--r--  2.0 unx      998 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-over-symbolic.symbolic.png
--rw-r--r--  2.0 unx   104561 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx     1080 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-debug-symbolic.symbolic.png
--rw-r--r--  2.0 unx      597 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
--rw-r--r--  2.0 unx      312 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-into-symbolic.symbolic.png
--rw-r--r--  2.0 unx      374 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-next-symbolic.symbolic.png
--rw-r--r--  2.0 unx      308 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-out-symbolic.symbolic.png
--rw-r--r--  2.0 unx      310 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-over-symbolic.symbolic.png
--rw-r--r--  2.0 unx     6859 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx    25889 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-debug-symbolic.symbolic.png
--rw-r--r--  2.0 unx    12342 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
--rw-r--r--  2.0 unx     3394 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-into-symbolic.symbolic.png
--rw-r--r--  2.0 unx     5752 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-next-symbolic.symbolic.png
--rw-r--r--  2.0 unx     3334 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-out-symbolic.symbolic.png
--rw-r--r--  2.0 unx     2485 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-over-symbolic.symbolic.png
--rw-r--r--  2.0 unx   317116 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx     2484 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-debug-symbolic.symbolic.png
--rw-r--r--  2.0 unx     1237 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
--rw-r--r--  2.0 unx      488 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-into-symbolic.symbolic.png
--rw-r--r--  2.0 unx      674 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-next-symbolic.symbolic.png
--rw-r--r--  2.0 unx      465 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-out-symbolic.symbolic.png
--rw-r--r--  2.0 unx      399 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-over-symbolic.symbolic.png
--rw-r--r--  2.0 unx    19434 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger.png
--rw-r--r--  2.0 unx    12862 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-debug-symbolic.svg
--rw-r--r--  2.0 unx     4900 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-disable-breaks-symbolic.svg
--rw-r--r--  2.0 unx     6943 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-into-symbolic.svg
--rw-r--r--  2.0 unx     7357 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-next-symbolic.svg
--rw-r--r--  2.0 unx     6986 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-out-symbolic.svg
--rw-r--r--  2.0 unx     6939 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-over-symbolic.svg
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/__init__.py
--rw-r--r--  2.0 unx     1193 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/address_container.py
--rw-r--r--  2.0 unx     5832 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/breakpoint_file_state.py
--rw-r--r--  2.0 unx     8163 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/breakpoint_manager.py
--rw-r--r--  2.0 unx     6073 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/breakpoint_state.py
--rw-r--r--  2.0 unx     1047 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/constants.py
--rw-r--r--  2.0 unx     7267 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/editor_text_mark_util.py
--rw-r--r--  2.0 unx    11584 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/game_variable.py
--rw-r--r--  2.0 unx    17365 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_engine_state.py
--rw-r--r--  2.0 unx     6953 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/script_runtime_struct.py
--rw-r--r--  2.0 unx     7599 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/settings.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/__init__.py
--rw-r--r--  2.0 unx     4902 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/constants.py
--rw-r--r--  2.0 unx     3183 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/exps_statements.py
--rw-r--r--  2.0 unx     3181 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/functions.py
--rw-r--r--  2.0 unx     3149 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/util.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/calltips/__init__.py
--rw-r--r--  2.0 unx     6948 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/calltips/calltip_emitter.py
--rw-r--r--  2.0 unx     5850 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/calltips/position_mark.py
--rw-r--r--  2.0 unx     3354 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/completion/calltips/string_event_emitter.py
--rw-r--r--  2.0 unx     2908 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/__init__.py
--rw-r--r--  2.0 unx     4363 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/actor.py
--rw-r--r--  2.0 unx     3682 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/event.py
--rw-r--r--  2.0 unx     1372 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/global_script.py
--rw-r--r--  2.0 unx     1833 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/map.py
--rw-r--r--  2.0 unx     4264 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/object.py
--rw-r--r--  2.0 unx     3940 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/performer.py
--rw-r--r--  2.0 unx     1549 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/ssb_file_in_ram.py
--rw-r--r--  2.0 unx      877 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ground_state/ssx_file_in_ram.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/script_file_context/__init__.py
--rw-r--r--  2.0 unx     4818 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/script_file_context/abstract.py
--rw-r--r--  2.0 unx    13832 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/script_file_context/exps_macro.py
--rw-r--r--  2.0 unx    11321 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/script_file_context/ssb_file.py
--rw-r--r--  2.0 unx     1139 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ssb_files/__init__.py
--rw-r--r--  2.0 unx     3236 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ssb_files/explorerscript.py
--rw-r--r--  2.0 unx     5733 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ssb_files/file.py
--rw-r--r--  2.0 unx    11435 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ssb_files/file_manager.py
--rw-r--r--  2.0 unx     1767 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/model/ssb_files/ssb_script.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/pixbuf/__init__.py
--rw-r--r--  2.0 unx     3391 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/pixbuf/icons.py
--rw-r--r--  2.0 unx      739 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/renderer/__init__.py
--rw-r--r--  2.0 unx     2952 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger/renderer/async_software.py
--rw-r--r--  2.0 unx    35148 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger-1.4.4.dist-info/LICENSE
--rw-r--r--  2.0 unx     2572 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger-1.4.4.dist-info/METADATA
--rw-r--r--  2.0 unx       92 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger-1.4.4.dist-info/WHEEL
--rw-r--r--  2.0 unx       76 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger-1.4.4.dist-info/entry_points.txt
--rw-r--r--  2.0 unx       23 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger-1.4.4.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx    14996 b- defN 23-Jan-02 13:31 skytemple_ssb_debugger-1.4.4.dist-info/RECORD
-119 files, 2377047 bytes uncompressed, 1720965 bytes compressed:  27.6%
+Zip file size: 1738630 bytes, number of entries: 117
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/__init__.py
+-rw-r--r--  2.0 unx   226747 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/debugger.glade
+-rw-r--r--  2.0 unx     3928 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/exps.lang
+-rw-r--r--  2.0 unx     3411 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/main.py
+-rw-r--r--  2.0 unx        0 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/py.typed
+-rw-r--r--  2.0 unx     6063 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/ssbs.lang
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/context/__init__.py
+-rw-r--r--  2.0 unx     8162 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/context/abstract.py
+-rw-r--r--  2.0 unx     7809 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/context/standalone.py
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/__init__.py
+-rw-r--r--  2.0 unx     7533 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/debug_overlay.py
+-rw-r--r--  2.0 unx     6954 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/debugger.py
+-rw-r--r--  2.0 unx    17241 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/editor_notebook.py
+-rw-r--r--  2.0 unx     4182 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/global_state.py
+-rw-r--r--  2.0 unx    18676 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/ground_state.py
+-rw-r--r--  2.0 unx     4848 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/local_variable.py
+-rw-r--r--  2.0 unx    79131 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/main.py
+-rw-r--r--  2.0 unx    48721 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/script_editor.py
+-rw-r--r--  2.0 unx    29755 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/ssb_editor.glade
+-rw-r--r--  2.0 unx    17233 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/variable.py
+-rw-r--r--  2.0 unx    59943 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/desmume_control_ui/PyDeSmuMe_controls.glade
+-rw-r--r--  2.0 unx     1773 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/desmume_control_ui/__init__.py
+-rw-r--r--  2.0 unx     4862 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/desmume_control_ui/joystick_controls.py
+-rw-r--r--  2.0 unx     3781 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/controller/desmume_control_ui/keyboard_controls.py
+-rw-r--r--  2.0 unx   967861 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/1024x1024/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx     5442 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-debug-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     2495 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      837 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-into-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     1287 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-next-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      768 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-out-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      564 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-over-symbolic.symbolic.png
+-rw-r--r--  2.0 unx    42129 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx      468 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-debug-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      326 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      225 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-into-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      245 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-next-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      225 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-out-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      236 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger-step-over-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     3167 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/16x16/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx    11630 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-debug-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     5555 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     1441 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-into-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     2555 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-next-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     1451 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-out-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      998 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger-step-over-symbolic.symbolic.png
+-rw-r--r--  2.0 unx   104561 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx     1080 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-debug-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      597 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      312 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-into-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      374 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-next-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      308 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-out-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      310 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger-step-over-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     6859 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/32x32/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx    25889 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-debug-symbolic.symbolic.png
+-rw-r--r--  2.0 unx    12342 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     3394 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-into-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     5752 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-next-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     3334 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-out-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     2485 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger-step-over-symbolic.symbolic.png
+-rw-r--r--  2.0 unx   317116 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/512x512/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx     2484 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-debug-symbolic.symbolic.png
+-rw-r--r--  2.0 unx     1237 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      488 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-into-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      674 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-next-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      465 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-out-symbolic.symbolic.png
+-rw-r--r--  2.0 unx      399 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger-step-over-symbolic.symbolic.png
+-rw-r--r--  2.0 unx    19434 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger.png
+-rw-r--r--  2.0 unx    12862 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-debug-symbolic.svg
+-rw-r--r--  2.0 unx     4900 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-disable-breaks-symbolic.svg
+-rw-r--r--  2.0 unx     6943 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-into-symbolic.svg
+-rw-r--r--  2.0 unx     7357 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-next-symbolic.svg
+-rw-r--r--  2.0 unx     6986 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-out-symbolic.svg
+-rw-r--r--  2.0 unx     6939 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-over-symbolic.svg
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/__init__.py
+-rw-r--r--  2.0 unx     5844 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/breakpoint_file_state.py
+-rw-r--r--  2.0 unx     1082 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/constants.py
+-rw-r--r--  2.0 unx     7302 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/editor_text_mark_util.py
+-rw-r--r--  2.0 unx    16201 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_engine_state.py
+-rw-r--r--  2.0 unx     6181 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/script_runtime_struct.py
+-rw-r--r--  2.0 unx     7062 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/settings.py
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/__init__.py
+-rw-r--r--  2.0 unx     4934 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/constants.py
+-rw-r--r--  2.0 unx     3215 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/exps_statements.py
+-rw-r--r--  2.0 unx     3213 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/functions.py
+-rw-r--r--  2.0 unx     3184 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/util.py
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/calltips/__init__.py
+-rw-r--r--  2.0 unx     6983 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/calltips/calltip_emitter.py
+-rw-r--r--  2.0 unx     5885 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/calltips/position_mark.py
+-rw-r--r--  2.0 unx     3094 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/completion/calltips/string_event_emitter.py
+-rw-r--r--  2.0 unx     3450 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/__init__.py
+-rw-r--r--  2.0 unx     3302 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/actor.py
+-rw-r--r--  2.0 unx     2686 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/event.py
+-rw-r--r--  2.0 unx     1252 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/global_script.py
+-rw-r--r--  2.0 unx     1503 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/map.py
+-rw-r--r--  2.0 unx     3243 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/object.py
+-rw-r--r--  2.0 unx     2941 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/performer.py
+-rw-r--r--  2.0 unx     1594 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/ssb_file_in_ram.py
+-rw-r--r--  2.0 unx      912 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ground_state/ssx_file_in_ram.py
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/script_file_context/__init__.py
+-rw-r--r--  2.0 unx     4624 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/script_file_context/abstract.py
+-rw-r--r--  2.0 unx    13694 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/script_file_context/exps_macro.py
+-rw-r--r--  2.0 unx    11249 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/script_file_context/ssb_file.py
+-rw-r--r--  2.0 unx     1158 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ssb_files/__init__.py
+-rw-r--r--  2.0 unx     3271 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ssb_files/explorerscript.py
+-rw-r--r--  2.0 unx     6040 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ssb_files/file.py
+-rw-r--r--  2.0 unx    11174 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ssb_files/file_manager.py
+-rw-r--r--  2.0 unx     1802 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/model/ssb_files/ssb_script.py
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/pixbuf/__init__.py
+-rw-r--r--  2.0 unx     3426 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/pixbuf/icons.py
+-rw-r--r--  2.0 unx      774 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/renderer/__init__.py
+-rw-r--r--  2.0 unx     3904 b- defN 23-Jun-09 17:53 skytemple_ssb_debugger/renderer/async_software.py
+-rw-r--r--  2.0 unx    35148 b- defN 23-Jun-09 17:54 skytemple_ssb_debugger-1.6.0a1.dist-info/LICENSE
+-rw-r--r--  2.0 unx     2591 b- defN 23-Jun-09 17:54 skytemple_ssb_debugger-1.6.0a1.dist-info/METADATA
+-rw-r--r--  2.0 unx       92 b- defN 23-Jun-09 17:54 skytemple_ssb_debugger-1.6.0a1.dist-info/WHEEL
+-rw-r--r--  2.0 unx       76 b- defN 23-Jun-09 17:54 skytemple_ssb_debugger-1.6.0a1.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx       23 b- defN 23-Jun-09 17:54 skytemple_ssb_debugger-1.6.0a1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx    14911 b- defN 23-Jun-09 17:54 skytemple_ssb_debugger-1.6.0a1.dist-info/RECORD
+117 files, 2380977 bytes uncompressed, 1713096 bytes compressed:  28.1%
```

## zipnote {}

```diff
@@ -1,31 +1,25 @@
 Filename: skytemple_ssb_debugger/__init__.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/debugger.glade
 Comment: 
 
-Filename: skytemple_ssb_debugger/emulator_thread.py
-Comment: 
-
 Filename: skytemple_ssb_debugger/exps.lang
 Comment: 
 
 Filename: skytemple_ssb_debugger/main.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/py.typed
 Comment: 
 
 Filename: skytemple_ssb_debugger/ssbs.lang
 Comment: 
 
-Filename: skytemple_ssb_debugger/threadsafe.py
-Comment: 
-
 Filename: skytemple_ssb_debugger/context/__init__.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/context/abstract.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/context/standalone.py
@@ -60,14 +54,26 @@
 
 Filename: skytemple_ssb_debugger/controller/ssb_editor.glade
 Comment: 
 
 Filename: skytemple_ssb_debugger/controller/variable.py
 Comment: 
 
+Filename: skytemple_ssb_debugger/controller/desmume_control_ui/PyDeSmuMe_controls.glade
+Comment: 
+
+Filename: skytemple_ssb_debugger/controller/desmume_control_ui/__init__.py
+Comment: 
+
+Filename: skytemple_ssb_debugger/controller/desmume_control_ui/joystick_controls.py
+Comment: 
+
+Filename: skytemple_ssb_debugger/controller/desmume_control_ui/keyboard_controls.py
+Comment: 
+
 Filename: skytemple_ssb_debugger/data/icons/hicolor/1024x1024/apps/skytemple-debugger.png
 Comment: 
 
 Filename: skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-debug-symbolic.symbolic.png
 Comment: 
 
 Filename: skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png
@@ -210,35 +216,23 @@
 
 Filename: skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-over-symbolic.svg
 Comment: 
 
 Filename: skytemple_ssb_debugger/model/__init__.py
 Comment: 
 
-Filename: skytemple_ssb_debugger/model/address_container.py
-Comment: 
-
 Filename: skytemple_ssb_debugger/model/breakpoint_file_state.py
 Comment: 
 
-Filename: skytemple_ssb_debugger/model/breakpoint_manager.py
-Comment: 
-
-Filename: skytemple_ssb_debugger/model/breakpoint_state.py
-Comment: 
-
 Filename: skytemple_ssb_debugger/model/constants.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/model/editor_text_mark_util.py
 Comment: 
 
-Filename: skytemple_ssb_debugger/model/game_variable.py
-Comment: 
-
 Filename: skytemple_ssb_debugger/model/ground_engine_state.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/model/script_runtime_struct.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/model/settings.py
@@ -333,26 +327,26 @@
 
 Filename: skytemple_ssb_debugger/renderer/__init__.py
 Comment: 
 
 Filename: skytemple_ssb_debugger/renderer/async_software.py
 Comment: 
 
-Filename: skytemple_ssb_debugger-1.4.4.dist-info/LICENSE
+Filename: skytemple_ssb_debugger-1.6.0a1.dist-info/LICENSE
 Comment: 
 
-Filename: skytemple_ssb_debugger-1.4.4.dist-info/METADATA
+Filename: skytemple_ssb_debugger-1.6.0a1.dist-info/METADATA
 Comment: 
 
-Filename: skytemple_ssb_debugger-1.4.4.dist-info/WHEEL
+Filename: skytemple_ssb_debugger-1.6.0a1.dist-info/WHEEL
 Comment: 
 
-Filename: skytemple_ssb_debugger-1.4.4.dist-info/entry_points.txt
+Filename: skytemple_ssb_debugger-1.6.0a1.dist-info/entry_points.txt
 Comment: 
 
-Filename: skytemple_ssb_debugger-1.4.4.dist-info/top_level.txt
+Filename: skytemple_ssb_debugger-1.6.0a1.dist-info/top_level.txt
 Comment: 
 
-Filename: skytemple_ssb_debugger-1.4.4.dist-info/RECORD
+Filename: skytemple_ssb_debugger-1.6.0a1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## skytemple_ssb_debugger/debugger.glade

### skytemple_ssb_debugger/debugger.glade

```diff
@@ -1602,15 +1602,15 @@
                                               <object class="GtkBox">
                                                 <property name="visible">True</property>
                                                 <property name="can-focus">False</property>
                                                 <property name="orientation">vertical</property>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_0">
                                                     <property name="label" translatable="yes">Message Speed Up</property>
-                                                    <property name="name">debug_flag_1_0</property>
+                                                    <property name="name">chk_debug_flag_1_0</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1618,15 +1618,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">0</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_1">
                                                     <property name="label" translatable="yes">No Screen Fade</property>
-                                                    <property name="name">debug_flag_1_1</property>
+                                                    <property name="name">chk_debug_flag_1_1</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1634,15 +1634,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">1</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_2">
                                                     <property name="label" translatable="yes">Sound OFF</property>
-                                                    <property name="name">debug_flag_1_2</property>
+                                                    <property name="name">chk_debug_flag_1_2</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1650,15 +1650,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">2</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_3">
                                                     <property name="label" translatable="yes">BGM OFF</property>
-                                                    <property name="name">debug_flag_1_3</property>
+                                                    <property name="name">chk_debug_flag_1_3</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1666,15 +1666,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">3</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_4">
                                                     <property name="label" translatable="yes">SE OFF</property>
-                                                    <property name="name">debug_flag_1_4</property>
+                                                    <property name="name">chk_debug_flag_1_4</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1682,15 +1682,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">4</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_5">
                                                     <property name="label" translatable="yes">Stage NPC Dummy</property>
-                                                    <property name="name">debug_flag_1_5</property>
+                                                    <property name="name">chk_debug_flag_1_5</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1698,15 +1698,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">5</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_6">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_1_6</property>
+                                                    <property name="name">chk_debug_flag_1_6</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1714,15 +1714,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">6</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_7">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_1_7</property>
+                                                    <property name="name">chk_debug_flag_1_7</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1730,15 +1730,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">7</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_8">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_1_8</property>
+                                                    <property name="name">chk_debug_flag_1_8</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1746,15 +1746,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">8</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_9">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_1_9</property>
+                                                    <property name="name">chk_debug_flag_1_9</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1762,15 +1762,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">9</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_10">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_1_10</property>
+                                                    <property name="name">chk_debug_flag_1_10</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1778,15 +1778,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">10</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_1_11">
                                                     <property name="label" translatable="yes">Debug Menus</property>
-                                                    <property name="name">debug_flag_1_11</property>
+                                                    <property name="name">chk_debug_flag_1_11</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_1_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1821,15 +1821,15 @@
                                               <object class="GtkBox">
                                                 <property name="visible">True</property>
                                                 <property name="can-focus">False</property>
                                                 <property name="orientation">vertical</property>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_0">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_0</property>
+                                                    <property name="name">chk_debug_flag_2_0</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1837,15 +1837,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">0</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_1">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_1</property>
+                                                    <property name="name">chk_debug_flag_2_1</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1853,15 +1853,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">1</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_2">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_2</property>
+                                                    <property name="name">chk_debug_flag_2_2</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1869,15 +1869,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">2</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_3">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_3</property>
+                                                    <property name="name">chk_debug_flag_2_3</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1885,15 +1885,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">3</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_4">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_4</property>
+                                                    <property name="name">chk_debug_flag_2_4</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1901,15 +1901,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">4</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_5">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_5</property>
+                                                    <property name="name">chk_debug_flag_2_5</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1917,15 +1917,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">5</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_6">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_6</property>
+                                                    <property name="name">chk_debug_flag_2_6</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1933,15 +1933,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">6</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_7">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_7</property>
+                                                    <property name="name">chk_debug_flag_2_7</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1949,15 +1949,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">7</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_8">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_8</property>
+                                                    <property name="name">chk_debug_flag_2_8</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1965,15 +1965,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">8</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_9">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_9</property>
+                                                    <property name="name">chk_debug_flag_2_9</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1981,15 +1981,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">9</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_10">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_10</property>
+                                                    <property name="name">chk_debug_flag_2_10</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -1997,15 +1997,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">10</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_11">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_11</property>
+                                                    <property name="name">chk_debug_flag_2_11</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -2013,15 +2013,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">11</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_12">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_12</property>
+                                                    <property name="name">chk_debug_flag_2_12</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -2029,15 +2029,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">12</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_13">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_13</property>
+                                                    <property name="name">chk_debug_flag_2_13</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -2045,15 +2045,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">13</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_14">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_14</property>
+                                                    <property name="name">chk_debug_flag_2_14</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
@@ -2061,15 +2061,15 @@
                                                     <property name="fill">True</property>
                                                     <property name="position">14</property>
                                                   </packing>
                                                 </child>
                                                 <child>
                                                   <object class="GtkCheckButton" id="chk_debug_flag_2_15">
                                                     <property name="label" translatable="yes">???</property>
-                                                    <property name="name">debug_flag_2_15</property>
+                                                    <property name="name">chk_debug_flag_2_15</property>
                                                     <property name="visible">True</property>
                                                     <property name="can-focus">True</property>
                                                     <property name="receives-default">False</property>
                                                     <property name="draw-indicator">True</property>
                                                     <signal name="toggled" handler="on_chk_debug_flag_2_toggled" swapped="no"/>
                                                   </object>
                                                   <packing>
```

## skytemple_ssb_debugger/exps.lang

### skytemple_ssb_debugger/exps.lang

```diff
@@ -13,14 +13,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 
 -->
 <language id="exps" name="ExplorerScript" version="2.0" _section="Script">
   <metadata>
     <property name="mimetypes">text/x-exps;application/x-exps;text/x-exps-source;application/x-exps-source</property>
     <property name="globs">*.exps</property>
     <property name="line-comment-start">//</property>
```

## skytemple_ssb_debugger/main.py

```diff
@@ -10,28 +10,29 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 
 import logging
 import os
 import sys
 
 import gi
 import pkg_resources
+from skytemple_ssb_emulator import emulator_shutdown
 
 gi.require_version('Gtk', '3.0')
 
 from skytemple_icons import icons
 from skytemple_ssb_debugger.context.standalone import StandaloneDebuggerControlContext
 from skytemple_ssb_debugger.controller.main import MainController
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
 
 from gi.repository import Gtk, GLib
 from gi.repository.Gtk import Window
 
 
 def main():
     try:
@@ -54,16 +55,15 @@
         main_window.set_wmclass("SkyTemple Script Engine Debugger", "SkyTemple Script Engine Debugger")
 
         # Load main window + controller
         MainController(builder, main_window, StandaloneDebuggerControlContext(main_window))
 
         Gtk.main()
     finally:
-        if EmulatorThread.instance():
-            EmulatorThread.instance().stop()
+        emulator_shutdown()
 
 
 def get_debugger_builder() -> Gtk.Builder:
     builder = Gtk.Builder()
     builder.add_from_file(os.path.join(get_debugger_package_dir(), "debugger.glade"))
     return builder
```

## skytemple_ssb_debugger/ssbs.lang

### skytemple_ssb_debugger/ssbs.lang

```diff
@@ -13,14 +13,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 
 -->
 <language id="ssbs" name="SSBScript" version="2.0" _section="Script">
   <metadata>
     <property name="mimetypes">text/x-ssbs;application/x-ssbs;text/x-ssbs-source;application/x-ssbs-source</property>
     <property name="globs">*.ssbs</property>
     <property name="line-comment-start">//</property>
```

## skytemple_ssb_debugger/context/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/context/abstract.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import os
 from abc import ABC, abstractmethod
 from typing import TYPE_CHECKING, Optional, List, Iterable, Type, Dict
 
 from gi.repository import Gtk
 
 from explorerscript.source_map import SourceMapPositionMark
```

## skytemple_ssb_debugger/context/standalone.py

```diff
@@ -10,24 +10,25 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import logging
+import traceback
 from threading import Lock
 from typing import Optional, TYPE_CHECKING, Dict, List, Iterable
 
 import gi
 
 from explorerscript.source_map import SourceMapPositionMark
 from skytemple_files.script.ssb.constants import SsbConstant
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu, synchronized_now
+from skytemple_ssb_emulator import emulator_shutdown
 
 gi.require_version('Gtk', '3.0')
 from gi.repository import Gtk
 from ndspy.rom import NintendoDSRom
 
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.common.project_file_manager import ProjectFileManager
@@ -58,18 +59,15 @@
         return True
 
     def before_quit(self) -> bool:
         return True
 
     def on_quit(self):
         Gtk.main_quit()
-        emu_instance = EmulatorThread.instance()
-        if emu_instance is not None:
-            emu_instance.end()
-        EmulatorThread.destroy_lib()
+        emulator_shutdown()
 
     def on_focus(self):
         pass
 
     def on_blur(self):
         pass
 
@@ -97,49 +95,49 @@
 
     def get_rom_filename(self) -> str:
         self._check_loaded()
         return self._rom_filename  # type: ignore
 
     def save_rom(self):
         self._check_loaded()
-        self._rom.saveToFile(self._rom_filename)
+        self._rom.saveToFile(self._rom_filename, updateDeviceCapacity=True)  # type: ignore
 
     def get_static_data(self) -> Pmd2Data:
         self._check_loaded()
         return self._static_data  # type: ignore
 
     def get_project_filemanager(self) -> ProjectFileManager:
         self._check_loaded()
         return self._project_fm  # type: ignore
 
-    @synchronized_now(file_load_lock)
     def get_ssb(self, filename, ssb_file_manager: 'SsbFileManager') -> 'SsbLoadedFile':
-        self._check_loaded()
-        if filename not in self._open_files:
-            try:
-                ssb_bin = self._rom.getFileByName(filename)  # type: ignore
-            except ValueError as err:
-                raise FileNotFoundError(str(err)) from err
-            self._open_files[filename] = SsbLoadedFile(
-                filename, FileType.SSB.deserialize(ssb_bin, self._static_data),
-                ssb_file_manager, self._project_fm  # type: ignore
-            )
-            self._open_files[filename].exps.ssb_hash = ssb_file_manager.hash(ssb_bin)
-        return self._open_files[filename]
+        with file_load_lock:
+            self._check_loaded()
+            if filename not in self._open_files:
+                try:
+                    ssb_bin = self._rom.getFileByName(filename)  # type: ignore
+                except ValueError as err:
+                    raise FileNotFoundError(str(err)) from err
+                self._open_files[filename] = SsbLoadedFile(
+                    filename, FileType.SSB.deserialize(ssb_bin, self._static_data),
+                    ssb_file_manager, self._project_fm  # type: ignore
+                )
+                self._open_files[filename].exps.ssb_hash = ssb_file_manager.hash(ssb_bin)
+            return self._open_files[filename]
 
     def on_script_edit(self, filename):
         pass
 
-    @synchronized_now(file_load_lock)
     def save_ssb(self, filename, ssb_model, ssb_file_manager: 'SsbFileManager'):
-        self._check_loaded()
-        self._rom.setFileByName(  # type: ignore
-            filename, FileType.SSB.serialize(ssb_model, self._static_data)
-        )
-        self.save_rom()
+        with file_load_lock:
+            self._check_loaded()
+            self._rom.setFileByName(  # type: ignore
+                filename, FileType.SSB.serialize(ssb_model, self._static_data)
+            )
+            self.save_rom()
 
     def _check_loaded(self):
         if self._rom is None:
             raise RuntimeError("No ROM is currently loaded.")
 
     def open_scene_editor(self, type_of_scene, filename):
         self._scene_editing_not_supported()
@@ -170,18 +168,21 @@
 
     def display_error(
             self, exc_info, error_message,
             error_title='SkyTemple Script Engine Debugger - Error',
             *, context: Optional[Dict[str, Capturable]] = None
     ):
         logger.error(error_message, exc_info=exc_info)
+        exc_info_str = ''
+        if exc_info:
+            exc_info_str = '\n' + ''.join(traceback.format_exception(exc_info[0], value=exc_info[1], tb=exc_info[2]))
         md = self.message_dialog_cls()(self._main_window,
                                        Gtk.DialogFlags.DESTROY_WITH_PARENT, Gtk.MessageType.ERROR,
                                        Gtk.ButtonsType.OK,
-                                       error_message,
+                                       f"{error_message}{exc_info_str}",
                                        title=error_title)
         md.set_position(Gtk.WindowPosition.CENTER)
         md.run()
         md.destroy()
 
     def capture_error(
             self, exc_info,
```

## skytemple_ssb_debugger/controller/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/controller/debug_overlay.py

```diff
@@ -10,37 +10,31 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-import asyncio
-from threading import Lock
+from __future__ import annotations
 from typing import Iterable, List, Tuple
 
 import cairo
+from gi.repository import GLib
 
 from skytemple_files.script.ssa_sse_sss.position import TILE_SIZE
 from skytemple_ssb_debugger.controller.debugger import DebuggerController
-from skytemple_ssb_debugger.emulator_thread import FRAMES_PER_SECOND
-from skytemple_ssb_debugger.threadsafe import synchronized, threadsafe_emu_nonblocking_coro
-from skytemple_files.common.i18n_util import f, _
+from skytemple_files.common.i18n_util import _
 
 ALPHA_T = 0.7
 COLOR_ACTOR = (1.0, 0, 1.0, ALPHA_T)
 COLOR_OBJECTS = (1.0, 0.627, 0, ALPHA_T)
 COLOR_PERFORMER = (0, 1.0, 1.0, ALPHA_T)
 COLOR_EVENTS = (0, 0, 1.0, 0.4)
 COLOR_BLACK = (0, 0, 0, ALPHA_T)
 COLOR_POS_MARKERS = (0, 1.0, 0, ALPHA_T)
-REDRAW_DELAY = 2
-
-
-debug_overlay_lock = Lock()
 
 
 class DebugOverlayController:
     def __init__(self, debugger: DebuggerController):
         self.debugger = debugger
 
         self.enabled = False
@@ -55,24 +49,23 @@
         self._event_bbox_cache: List[Tuple[int, int, int, int]] = []
         self._camera_pos_cache = (0, 0)
         self._boost = False
 
     def toggle(self, state):
         self.enabled = state
 
-    @synchronized(debug_overlay_lock)
     def draw(self, ctx: cairo.Context, display_id: int):
         if self._boost:
             self._draw_boost(ctx, display_id)
             return
         # TODO: Support other display drawing.
         if display_id == 1 and self.enabled and self.debugger:
             if self._refresh_cache and not self._cache_redrawing_registered:
                 self._cache_redrawing_registered = True
-                threadsafe_emu_nonblocking_coro(self.debugger.emu_thread, self._update_cache())
+                self._update_cache()
 
             if self._cache_running:
                 # Draw
                 for bbox in self._actor_bbox_cache:
                     ctx.set_source_rgba(*COLOR_ACTOR)
                     ctx.rectangle(
                         bbox[0], bbox[1],
@@ -133,50 +126,50 @@
         """The debugger is stopped, the emulator is frozen."""
         self._refresh_cache = False
 
     def break_released(self):
         """The debugger is no longer stopped."""
         self._refresh_cache = True
 
-    async def _update_cache(self):
+    def _update_cache(self):
         # Refresh the cache
-        with debug_overlay_lock:
-            ges = self.debugger.ground_engine_state
-            if ges:
-                self._cache_running = ges.running
-                if self._cache_running:
-                    self._actor_bbox_cache = []
-                    self._object_bbox_cache = []
-                    self._perf_bbox_cache = []
-                    self._event_bbox_cache = []
-                    for actor in not_none(ges.actors):
-                        self._actor_bbox_cache.append(actor.get_bounding_box_camera(ges.map))
-                    for object in not_none(ges.objects):
-                        self._object_bbox_cache.append(object.get_bounding_box_camera(ges.map))
-                    for performer in not_none(ges.performers):
-                        self._perf_bbox_cache.append(performer.get_bounding_box_camera(ges.map))
-                    for event in not_none(ges.events):
-                        self._event_bbox_cache.append(event.get_bounding_box_camera(ges.map))
-                    self._camera_pos_cache = (ges.map.camera_x_pos, ges.map.camera_y_pos)
+        ges = self.debugger.ground_engine_state
+        if ges:
+            self._cache_running = ges.running
+            if self._cache_running:
+                self._actor_bbox_cache = []
+                self._object_bbox_cache = []
+                self._perf_bbox_cache = []
+                self._event_bbox_cache = []
+                ges.force_reload_ground_objects()
+                for actor in not_none(ges.actors):
+                    self._actor_bbox_cache.append(actor.get_bounding_box_camera(ges.map))
+                for object in not_none(ges.objects):
+                    self._object_bbox_cache.append(object.get_bounding_box_camera(ges.map))
+                for performer in not_none(ges.performers):
+                    self._perf_bbox_cache.append(performer.get_bounding_box_camera(ges.map))
+                for event in not_none(ges.events):
+                    self._event_bbox_cache.append(event.get_bounding_box_camera(ges.map))
+                self._camera_pos_cache = (ges.map.camera_x_pos, ges.map.camera_y_pos)
 
         if self._refresh_cache and not self._boost:
-            await asyncio.sleep(1 / FRAMES_PER_SECOND * REDRAW_DELAY, loop=self.debugger.emu_thread.loop)
-            threadsafe_emu_nonblocking_coro(self.debugger.emu_thread, self._update_cache())
+            GLib.timeout_add(2000, self._update_cache)
         else:
             self._cache_redrawing_registered = False
+        return False
 
     def set_boost(self, state):
         self._boost = state
 
     def _draw_boost(self, ctx: cairo.Context, display_id: int):
         if display_id == 0:
             ctx.set_source_rgb(1.0, 0, 0)
             ctx.move_to(10, 20)
             ctx.set_font_size(20)
-            ctx.show_text(_("BOOST"))  # TRANSLATORS: Shown in enulator when boosting / fast-forward
+            ctx.show_text(_("BOOST"))  # TRANSLATORS: Shown in emulator when boosting / fast-forward
             ctx.set_font_size(12)
             ctx.move_to(10, 30)
             ctx.show_text(_("Debugging disabled."))
 
 
 def not_none(it: Iterable):
     for i in it:
```

## skytemple_ssb_debugger/controller/debugger.py

```diff
@@ -10,391 +10,156 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-import threading
-from functools import partial
-from typing import Optional, TYPE_CHECKING
+from __future__ import annotations
+from typing import TYPE_CHECKING, Optional, Iterable
 
-from desmume.emulator import DeSmuME
-from skytemple_files.common import string_codec
+from range_typed_integers import u32
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.breakpoint_manager import BreakpointManager
-from skytemple_ssb_debugger.model.breakpoint_state import BreakpointState, BreakpointStateType
-from skytemple_ssb_debugger.model.game_variable import GameVariable
+from skytemple_ssb_emulator import emulator_register_script_debug, emulator_register_debug_print, \
+    emulator_register_debug_flag, emulator_set_debug_mode, emulator_set_debug_flag_1, emulator_set_debug_flag_2, \
+    EmulatorLogType, emulator_unregister_script_debug, \
+    emulator_unregister_debug_print, emulator_unregister_debug_flag, emulator_debug_breakpoints_disabled_get, \
+    emulator_debug_breakpoints_disabled_set, BreakpointState, emulator_set_debug_dungeon_skip
+
 from skytemple_ssb_debugger.model.ground_engine_state import GroundEngineState
 from skytemple_ssb_debugger.model.script_runtime_struct import ScriptRuntimeStruct
 from skytemple_ssb_debugger.model.ssb_files.file_manager import SsbFileManager
-from skytemple_ssb_debugger.threadsafe import threadsafe_gtk_nonblocking, threadsafe_emu, synchronized
 
 if TYPE_CHECKING:
     from skytemple_ssb_debugger.controller.main import MainController
 
 
-class NdsStrPnt(int):
-    """(Potential) pointer to a string. TODO: Move to py-desmume?"""
-
-    def __new__(cls, emu: DeSmuME, pnt: int, *args):
-        return super().__new__(NdsStrPnt, pnt)
-
-    def __init__(self, emu: DeSmuME, pnt: int):
-        super().__init__()
-        self.mem = emu.memory
-        self.pnt = pnt
-
-    def __int__(self):
-        return self.pnt
-
-    def __str__(self):
-        return self.mem.read_string(self.pnt)
-
-
-debugger_state_lock = threading.Lock()
-
 NB_DEBUG_FLAGS_1 = 0xC
 NB_DEBUG_FLAGS_2 = 0x10
 
+
 class DebuggerController:
-    def __init__(self, emu_thread: EmulatorThread, print_callback, parent: 'MainController'):
-        self.emu_thread = emu_thread
-        self.is_active = False
+    def __init__(self, print_callback, parent: 'MainController'):
         self.rom_data: Optional[Pmd2Data] = None
         self._print_callback_fn = print_callback
         self.ground_engine_state: Optional[GroundEngineState] = None
         self.parent: 'MainController' = parent
-        self.breakpoint_manager: Optional[BreakpointManager] = None
-
-        # Flag to completely disable breaking
-        self._breakpoints_disabled = False
-        # Flag to disable breaking for one single tick. This is reset to -1 if the tick number changes.
-        self._breakpoints_disabled_for_tick = -1
-        # Force a halt at the breakpoint hook
-        self._breakpoint_force = False
 
         self._debug_flags_1 = [0]*NB_DEBUG_FLAGS_1
         self._debug_flags_2 = [0]*NB_DEBUG_FLAGS_2
         self._debug_flag_temp_input = 0
         
         self._log_operations = False
         self._log_debug_print = False
         self._log_printfs = False
-        self._debug_mode = False
-        # TODO: Move this to the dungeon debugger when implemented! And also all it's functionality and UI code!
-        self._debug_dungeon_skip = False
-        self._debug_dungeon_skip_pointer = None
         self._log_ground_engine_state = False
         self._boost = False
 
     @property
     def breakpoints_disabled(self):
-        return self._breakpoints_disabled
+        return emulator_debug_breakpoints_disabled_get()
 
     @breakpoints_disabled.setter
     def breakpoints_disabled(self, val):
-        self._breakpoints_disabled = val
+        emulator_debug_breakpoints_disabled_set(val)
 
-    def enable(self, rom_data: Pmd2Data, ssb_file_manager: SsbFileManager,
-               breakpoint_manager: BreakpointManager, inform_ground_engine_start_cb):
+    def enable(
+            self, rom_data: Pmd2Data, ssb_file_manager: SsbFileManager,
+            inform_ground_engine_start_cb,
+            *, debug_mode: bool, debug_flag_1: Iterable[bool], debug_flag_2: Iterable[bool]
+    ):
         self.rom_data = rom_data
-        self.breakpoint_manager = breakpoint_manager
 
         arm9 = self.rom_data.bin_sections.arm9
-        arm9_e = self.rom_data.extra_bin_sections.arm9
         ov11 = self.rom_data.bin_sections.overlay11
-        ov29 = self.rom_data.bin_sections.overlay29
-        self.register_exec(ov11.functions.FuncThatCallsCommandParsing.absolute_address + 0x58, self.hook__breaking_point)
-        self.register_exec(arm9.functions.GetDebugFlag1.absolute_address, self.hook__get_debug_flag_get_input)
-        self.register_exec(arm9.functions.GetDebugFlag2.absolute_address, self.hook__get_debug_flag_get_input)
-        self.register_exec(arm9.functions.GetDebugFlag1.absolute_address+0x4, self.hook__get_debug_flag_1)
-        self.register_exec(arm9.functions.GetDebugFlag2.absolute_address+0x4, self.hook__get_debug_flag_2)
-        self.register_exec(arm9.functions.SetDebugFlag1.absolute_address, self.hook__set_debug_flag_1)
-        self.register_exec(arm9.functions.SetDebugFlag2.absolute_address, self.hook__set_debug_flag_2)
-        self.register_exec(arm9.functions.DebugPrint0.absolute_address, partial(self.hook__log_printfs, 0))
-        self.register_exec(arm9.functions.DebugPrint.absolute_address, partial(self.hook__log_printfs, 1))
-        self.register_exec(arm9_e.functions.DebugPrint2.absolute_address, partial(self.hook__log_printfs, 0))
-        self.register_exec(ov11.functions.ScriptCommandParsing.absolute_address + 0x3C40, self.hook__log_debug_print)
-        self.register_exec(ov11.functions.ScriptCommandParsing.absolute_address + 0x15C8, self.hook__debug_mode)
-        self.register_write(ov29.data.DUNGEON_PTR.absolute_address, self.hook__write__debug_dungeon_skip)
+        emulator_register_script_debug(
+            [ov11.functions.FuncThatCallsCommandParsing.absolute_address + 0x58],
+            self.hook__breaking_point,
+        )
+        emulator_register_debug_print(
+            arm9.functions.DebugPrint0.absolute_addresses,  # register offset = 0: -> registers[register_offset + i + 1]
+            arm9.functions.DebugPrint.absolute_addresses,   # register offset = 1
+            [ov11.functions.ScriptCommandParsing.absolute_address + 0x3C40],
+            self.hook__log_msg
+        )
+        emulator_register_debug_flag(
+            arm9.functions.GetDebugFlag1.absolute_addresses,
+            arm9.functions.GetDebugFlag2.absolute_addresses,
+            arm9.functions.SetDebugFlag1.absolute_addresses,
+            arm9.functions.SetDebugFlag2.absolute_addresses,
+            [ov11.functions.ScriptCommandParsing.absolute_address + 0x15C8],
+            self.hook__set_debug_flag
+        )
+
+        # Send current debug flags and debug mode flag to emulator
+        emulator_set_debug_mode(debug_mode)
+        for i, iv in enumerate(debug_flag_1):
+            emulator_set_debug_flag_1(i, iv)
+        for j, jv in enumerate(debug_flag_2):
+            emulator_set_debug_flag_2(j, jv)
 
         self.ground_engine_state = GroundEngineState(
-            self.emu_thread, self.rom_data, self.print_callback, inform_ground_engine_start_cb, ssb_file_manager,
+            self.rom_data, self._print_callback_fn, inform_ground_engine_start_cb, self.parent.do_poll_emulator, ssb_file_manager,
             self.parent.context
         )
         self.ground_engine_state.logging_enabled = self._log_ground_engine_state
         self.ground_engine_state.watch()
 
     def disable(self):
-        arm9 = self.rom_data.bin_sections.arm9
-        arm9_e = self.rom_data.extra_bin_sections.arm9
-        ov11 = self.rom_data.bin_sections.overlay11
-        ov29 = self.rom_data.bin_sections.overlay29
-        self.register_exec(ov11.functions.FuncThatCallsCommandParsing.absolute_address + 0x58, None)
-        self.register_exec(arm9.functions.GetDebugFlag1.absolute_address, None)
-        self.register_exec(arm9.functions.GetDebugFlag2.absolute_address, None)
-        self.register_exec(arm9.functions.GetDebugFlag1.absolute_address+0x4, None)
-        self.register_exec(arm9.functions.GetDebugFlag2.absolute_address+0x4, None)
-        self.register_exec(arm9.functions.GetDebugFlag1.absolute_address, None)
-        self.register_exec(arm9.functions.GetDebugFlag2.absolute_address, None)
-        self.register_exec(arm9.functions.DebugPrint0.absolute_address, None)
-        self.register_exec(arm9.functions.DebugPrint.absolute_address, None)
-        self.register_exec(arm9_e.functions.DebugPrint2.absolute_address, None)
-        self.register_exec(ov11.functions.ScriptCommandParsing.absolute_address + 0x3C40, None)
-        self.register_exec(ov11.functions.ScriptCommandParsing.absolute_address + 0x15C8, None)
-        self.register_write(ov29.data.DUNGEON_PTR.absolute_address, None)
-        self.is_active = False
+        emulator_unregister_script_debug()
+        emulator_unregister_debug_print()
+        emulator_unregister_debug_flag()
         self.rom_data = None
-        self.ground_engine_state.remove_watches()
-        self.ground_engine_state = None
-
-    def register_exec(self, pnt, cb):
-        threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_exec(pnt, cb))
-
-    def register_write(self, pnt, cb):
-        threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_write(pnt, cb))
+        if self.ground_engine_state:
+            self.ground_engine_state.remove_watches()
+            self.ground_engine_state = None
 
-    @synchronized(debugger_state_lock)
     def log_operations(self, value: bool):
         self._log_operations = value
 
-    @synchronized(debugger_state_lock)
     def log_debug_print(self, value: bool):
         self._log_debug_print = value
 
-    @synchronized(debugger_state_lock)
     def log_printfs(self, value: bool):
         self._log_printfs = value
 
-    @synchronized(debugger_state_lock)
     def log_ground_engine_state(self, value: bool):
         self._log_ground_engine_state = value
         if self.ground_engine_state:
             self.ground_engine_state.logging_enabled = value
 
-    @synchronized(debugger_state_lock)
-    def debug_mode(self, value: bool):
-        self._debug_mode = value
+    def hook__breaking_point(
+        self,
+        break_state: Optional[BreakpointState],
+        srs_mem: bytes,
+        script_target_slot_id: u32,
+        current_opcode: u32
+    ):
+        if not self._boost:
+            assert self.rom_data is not None and self.ground_engine_state is not None
+            if self._log_operations:
+                srs = ScriptRuntimeStruct.from_data(
+                    self.rom_data, u32(0), srs_mem, script_target_slot_id
+                )
+                current_opcode_obj = self.rom_data.script_data.op_codes__by_id[current_opcode]
+                self._print_callback_fn(f"> {srs.target_type.name}({srs.script_target_slot_id}): {current_opcode_obj.name} @{srs.current_opcode_addr:0x}")
+        if break_state:
+            self.parent.break_pulled(break_state)
 
-    @synchronized(debugger_state_lock)
-    def debug_dungeon_skip(self, value: bool):
-        self._debug_dungeon_skip = value
-        if self.rom_data and (not self.ground_engine_state or not self.ground_engine_state.running):
-            threadsafe_emu(self.emu_thread, lambda: self._set_dungeon_debug_skip())
-
-    # >>> ALL CALLBACKS BELOW ARE RUNNING IN THE EMULATOR THREAD <<<
-
-    def hook__breaking_point(self, address, size):
-        """MAIN DEBUGGER HOOK. The emulator thread pauses here and publishes it's state via BreakpointState."""
-        if self._boost:
+    def hook__log_msg(self, log_type: EmulatorLogType, msg: str):
+        if log_type == EmulatorLogType.Printfs and not self._log_printfs:
             return
-        debugger_state_lock.acquire()
-        srs = ScriptRuntimeStruct(
-            self.emu_thread.emu.memory, self.rom_data,
-            self.emu_thread.emu.memory.register_arm9.r6, self.ground_engine_state.unionall_load_addr
-        )
-        if self._log_operations:
-            self.print_callback(f"> {srs.target_type.name}({srs.target_id}): {srs.current_opcode.name} @{srs.current_opcode_addr:0x}")
-
-        if self.breakpoint_manager:
-            if not self._breakpoints_disabled and self._breakpoints_disabled_for_tick != self.emu_thread.current_frame_id:
-                debugger_state_lock.release()
-                self._breakpoints_disabled_for_tick = -1
-
-                ssb = self.ground_engine_state.loaded_ssb_files[srs.hanger_ssb]
-                if ssb is not None and (self._breakpoint_force or self.breakpoint_manager.has(
-                    ssb.file_name, srs.current_opcode_addr_relative, srs.is_in_unionall,
-                        srs.script_target_type, srs.script_target_slot_id
-                )):
-                    self.breakpoint_manager.reset_temporary()
-                    self._breakpoint_force = False
-                    state = BreakpointState(srs.hanger_ssb, srs)
-                    state.acquire()
-                    threadsafe_gtk_nonblocking(lambda: self.parent.break_pulled(state))
-                    while not state.wait(0.0005) and state.state == BreakpointStateType.STOPPED:
-                        # We haven't gotten the signal to resume yet, process pending events.
-                        self.emu_thread.run_one_pending_task()
-                    state.release()
-                    if state.state == BreakpointStateType.FAIL_HARD:
-                        # Ok, we won't pause again this tick.
-                        self._breakpoints_disabled_for_tick = self.emu_thread.current_frame_id
-                    elif state.state == BreakpointStateType.RESUME:
-                        # We just resume, this is easy :)
-                        pass
-                    elif state.state == BreakpointStateType.STEP_NEXT:
-                        # We force a break at the next run of this hook.
-                        self._breakpoint_force = True
-                    elif state.state == BreakpointStateType.STEP_INTO:
-                        # We break at whatever is executed next for the current script target.
-                        self.breakpoint_manager.add_temporary(
-                            srs.script_target_type, srs.script_target_slot_id
-                        )
-                    elif state.state == BreakpointStateType.STEP_OVER:
-                        # We break at the next opcode in the current script file
-                        self.breakpoint_manager.add_temporary(
-                            srs.script_target_type, srs.script_target_slot_id,
-                            is_in_unionall=srs.is_in_unionall
-                        )
-                        # If the current op is the last one (we will step out next) this will lead to issues.
-                        # We need to alternatively break at the current stack opcode (see STEP_OUT).
-                        if srs.has_call_stack:
-                            self.breakpoint_manager.add_temporary(
-                                srs.script_target_type, srs.script_target_slot_id,
-                                opcode_addr=srs.call_stack__current_opcode_addr_relative
-                            )
-                    elif state.state == BreakpointStateType.STEP_OUT:
-                        if srs.has_call_stack:
-                            # We break at the opcode address stored on the call stack position.
-                            self.breakpoint_manager.add_temporary(
-                                srs.script_target_type, srs.script_target_slot_id,
-                                opcode_addr=srs.call_stack__current_opcode_addr_relative
-                            )
-                        else:
-                            # We just resume
-                            pass
-                    elif state.state == BreakpointStateType.STEP_MANUAL:
-                        # We break at the requested opcode offset in the current hanger.
-                        self.breakpoint_manager.add_temporary(
-                            srs.script_target_type, srs.script_target_slot_id,
-                            is_in_unionall=srs.is_in_unionall,
-                            opcode_addr=state.manual_step_opcode_offset
-                        )
-            else:
-                debugger_state_lock.release()
-        else:
-            debugger_state_lock.release()
-
-    @synchronized(debugger_state_lock)
-    def hook__get_debug_flag_get_input(self, address, size):
-        self._debug_flag_temp_input = self.emu_thread.emu.memory.register_arm9.r0
-    
-    @synchronized(debugger_state_lock)
-    def hook__get_debug_flag_1(self, address, size):
-        self.emu_thread.emu.memory.register_arm9.r0 = self._debug_flags_1[self._debug_flag_temp_input]
-        
-    @synchronized(debugger_state_lock)
-    def hook__get_debug_flag_2(self, address, size):
-        self.emu_thread.emu.memory.register_arm9.r0 = self._debug_flags_2[self._debug_flag_temp_input]
-        
-    @synchronized(debugger_state_lock)
-    def hook__set_debug_flag_1(self, address, size):
-        flag_id = self.emu_thread.emu.memory.register_arm9.r0
-        value = self.emu_thread.emu.memory.register_arm9.r1
-        threadsafe_gtk_nonblocking(lambda: self.parent.set_check_debug_flag_1(flag_id, value))
-    
-    @synchronized(debugger_state_lock)
-    def hook__set_debug_flag_2(self, address, size):
-        flag_id = self.emu_thread.emu.memory.register_arm9.r0
-        value = self.emu_thread.emu.memory.register_arm9.r1
-        threadsafe_gtk_nonblocking(lambda: self.parent.set_check_debug_flag_2(flag_id, value))
-
-    @synchronized(debugger_state_lock)
-    def set_debug_flag_1(self, flag_id, value):
-        self._debug_flags_1[flag_id] = value
-        
-    @synchronized(debugger_state_lock)
-    def set_debug_flag_2(self, flag_id, value):
-        self._debug_flags_2[flag_id] = value
-    
-    @synchronized(debugger_state_lock)
-    def hook__log_printfs(self, register_offset, address, size):
-        if not self._log_printfs or self._boost:
-            return
-        emu = self.emu_thread.emu
-        dbg_string = str(NdsStrPnt(emu, emu.memory.register_arm9[register_offset]))
-
-        # TODO: There's got to be a better way!(tm)
-        dbg_string = dbg_string.replace('%p', '%x').rstrip('\n')
-        args_count = dbg_string.count('%')
-        self.print_callback(dbg_string % tuple([NdsStrPnt(emu, emu.memory.register_arm9[register_offset + i + 1]) for i in range(args_count)]))
-
-    @synchronized(debugger_state_lock)
-    def hook__log_debug_print(self, address, size):
-        if not self._log_debug_print or self._boost:
+        if log_type == EmulatorLogType.DebugPrint and not self._log_debug_print:
             return
-        emu = self.emu_thread.emu
-
-        srs = ScriptRuntimeStruct(self.emu_thread, self.rom_data,
-                                  emu.memory.register_arm9.r4, self.ground_engine_state.unionall_load_addr)
+        self._print_callback_fn(msg)
 
-        ssb_str_table_pointer = srs.start_addr_str_table
-        current_op_pnt = emu.memory.register_arm9.r5
-        current_op = emu.memory.register_arm9.r6
-        if current_op == 0x6B:
-            # debug_Print
-            const_string = read_ssb_str_mem(emu.memory, ssb_str_table_pointer,
-                                            emu.memory.unsigned.read_short(current_op_pnt + 2))
-            self.print_callback(f"debug_Print: {const_string}")
-        elif current_op == 0x6C:
-            # debug_PrintFlag
-            game_var_name, game_var_value = GameVariable.read(
-                emu.memory, self.rom_data, emu.memory.unsigned.read_short(current_op_pnt + 2), 0, srs
-            )
-            const_string = read_ssb_str_mem(emu.memory, ssb_str_table_pointer,
-                                            emu.memory.unsigned.read_short(current_op_pnt + 4))
-            self.print_callback(f"debug_PrintFlag: {const_string} - {game_var_name.name} = {game_var_value}")
-        elif current_op == 0x6D:
-            # debug_PrintScenario
-            var_id = emu.memory.unsigned.read_short(current_op_pnt + 2)
-            game_var_name, game_var_value = GameVariable.read(emu.memory, self.rom_data, var_id, 0, srs)
-            _, level_value = GameVariable.read(emu.memory, self.rom_data, var_id, 1, srs)
-            const_string = read_ssb_str_mem(emu.memory, ssb_str_table_pointer,
-                                            emu.memory.unsigned.read_short(current_op_pnt + 4))
-            self.print_callback(f"debug_PrintScenario: {const_string} - {game_var_name.name} = "
-                                f"scenario:{game_var_value}, level:{game_var_value}")
-
-    @synchronized(debugger_state_lock)
-    def hook__debug_mode(self, address, size):
-        if self._debug_mode:
-            self.emu_thread.emu.memory.register_arm9.r0 = 1 if self.emu_thread.emu.memory.register_arm9.r0 == 0 else 0
-
-    @synchronized(debugger_state_lock)
-    def hook__write__debug_dungeon_skip(self, address, size):
-        if not self.ground_engine_state or not self.ground_engine_state.running:
-            self._set_dungeon_debug_skip()
-
-    def hook__read__debug_dungeon_skip(self, address, size):
-        if self._debug_dungeon_skip and (not self.ground_engine_state or not self.ground_engine_state.running):
-            self.emu_thread.emu.memory.write_byte(address, 1)
-
-    def print_callback(self, text: str):
-        threadsafe_gtk_nonblocking(lambda: self._print_callback_fn(text))
-
-    def _get_next_opcode_addr(self, current_opcode_addr: int, current_opcode_addr_relative: int):
-        """ Returns current_opcode_addr_relative + the length of the current opcode. """
-        assert self.rom_data
-        current_opcode = self.rom_data.script_data.op_codes__by_id[
-            self.emu_thread.emu.memory.unsigned.read_short(current_opcode_addr)
-        ]
-        # the length is at least 2 (for the opcode itself
-        len = 2
-        if current_opcode.params == -1:
-            # if the opcode is var length, the first parameter contains that length
-            len += 2 + self.emu_thread.emu.memory.unsigned.read_short(current_opcode_addr + 0x02)
-        else:
-            len += 2 * current_opcode.params
-        return current_opcode_addr_relative + len
-
-    def _set_dungeon_debug_skip(self):
-        pointer = self.emu_thread.emu.memory.unsigned.read_long(self.rom_data.bin_sections.overlay29.data.DUNGEON_PTR.absolute_address)
-        if pointer != 0:
-            self.emu_thread.emu.memory.write_byte(pointer + 6, 1 if self._debug_dungeon_skip else 0)
-            self.emu_thread.emu.memory.write_byte(pointer + 8, 1 if self._debug_dungeon_skip else 0)
-            if self._debug_dungeon_skip_pointer is not None and self._debug_dungeon_skip_pointer != pointer:
-                self.emu_thread.emu.memory.register_read(self._debug_dungeon_skip_pointer + 6, None)
-                self.emu_thread.emu.memory.register_read(self._debug_dungeon_skip_pointer + 8, None)
-            self._debug_dungeon_skip_pointer = pointer
-            self.emu_thread.emu.memory.register_read(pointer + 6, self.hook__read__debug_dungeon_skip)
-            self.emu_thread.emu.memory.register_read(pointer + 8, self.hook__read__debug_dungeon_skip)
+    def hook__set_debug_flag(self, var_id: int, flag_id: int, value: int):
+        self.parent.set_check_debug_flag(var_id, flag_id, value)
 
-    @synchronized(debugger_state_lock)
     def set_boost(self, state):
         self._boost = state
-        self.ground_engine_state.set_boost(state)
-
+        if self.ground_engine_state:
+            self.ground_engine_state.set_boost(state)
 
-def read_ssb_str_mem(mem, str_table_pointer, index):
-    rel_pointer_to_const_str = mem.unsigned.read_short(str_table_pointer + (index * 2))
-    abs_pointer_to_const_str = str_table_pointer + rel_pointer_to_const_str
-    return mem.read_string(abs_pointer_to_const_str, string_codec.PMD2_STR_ENCODER)
+    def debug_dungeon_skip(self, value: bool):
+        if self.rom_data:
+            emulator_set_debug_dungeon_skip(self.rom_data.bin_sections.overlay29.data.DUNGEON_PTR.absolute_address, value)
```

## skytemple_ssb_debugger/controller/editor_notebook.py

```diff
@@ -11,24 +11,24 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import os
-from typing import Dict, Optional, List, Tuple, TYPE_CHECKING
+from typing import Dict, Optional, List, Tuple, TYPE_CHECKING, cast
 
 from gi.repository import Gtk, Pango
 
 from explorerscript.ssb_converting.ssb_data_types import SsbRoutineType
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_ssb_debugger.controller.script_editor import ScriptEditorController
-from skytemple_ssb_debugger.model.breakpoint_manager import BreakpointManager
-from skytemple_ssb_debugger.model.breakpoint_state import BreakpointState, BreakpointStateType
+from skytemple_ssb_emulator import BreakpointState, BreakpointStateType, emulator_debug_register_breakpoint_callbacks
 from skytemple_ssb_debugger.model.ssb_files.file_manager import SsbFileManager
 from ..context.abstract import AbstractDebuggerControlContext
 from ..model.breakpoint_file_state import BreakpointFileState
 from ..model.script_file_context.abstract import AbstractScriptFileContext
 from ..model.script_file_context.exps_macro import ExpsMacroFileScriptFileContext
 from ..model.script_file_context.ssb_file import SsbFileScriptFileContext
 from skytemple_files.common.i18n_util import f, _
@@ -39,58 +39,54 @@
 
 class EditorNotebookController:
     def __init__(self, builder: Gtk.Builder, parent: 'MainController',
                  main_window: Gtk.Window, enable_explorerscript=True):
         self.builder = builder
         self.parent = parent
         self.file_manager: Optional[SsbFileManager] = None
-        self.breakpoint_manager: Optional[BreakpointManager] = None
         self.rom_data: Optional[Pmd2Data] = None
         self._open_editors: Dict[str, ScriptEditorController] = {}
         self._notebook: Gtk.Notebook = builder.get_object('code_editor_notebook')
         self._cached_hanger_halt_lines: Dict[str, List[Tuple[SsbRoutineType, int, int]]] = {}
         self._cached_file_bpnt_state: Optional[BreakpointFileState] = None
         self.enable_explorerscript = enable_explorerscript
         self._main_window = main_window
 
-    def init(self, file_manager: SsbFileManager, breakpoint_manager: BreakpointManager, rom_data: Pmd2Data):
+    def init(self, file_manager: SsbFileManager, rom_data: Pmd2Data):
         self.file_manager = file_manager
         self.rom_data = rom_data
-        self.breakpoint_manager = breakpoint_manager
-        self.breakpoint_manager.register_callbacks(self.on_breakpoint_added, self.on_breakpoint_removed)
+        emulator_debug_register_breakpoint_callbacks(self.on_breakpoint_added, self.on_breakpoint_removed)
 
     @property
     def currently_open(self) -> Optional[ScriptEditorController]:
         if self._notebook.get_current_page() > -1:
             wdg = self._notebook.get_nth_page(self._notebook.get_current_page())
             for c in self._open_editors.values():
                 if c.get_root_object() == wdg:
                     return c
         return None
 
     def open_ssb(self, ssb_rom_path: str):
         assert self.file_manager
-        assert self.breakpoint_manager
         context = SsbFileScriptFileContext(
             self.file_manager.open_in_editor(ssb_rom_path),
             self.parent.get_scene_type_for(ssb_rom_path),
             self.parent.get_scene_name_for(ssb_rom_path),
-            self.breakpoint_manager, self
+            self
         )
         return self._open_common(ssb_rom_path, context, mapname=ssb_rom_path.split('/')[1])
 
     def open_exps_macro(self, abs_path: str):
         assert self.file_manager
-        assert self.breakpoint_manager
         context = ExpsMacroFileScriptFileContext(
-            abs_path, self.file_manager, self.breakpoint_manager, self
+            abs_path, self.file_manager, self
         )
         return self._open_common(abs_path, context)
 
-    def _open_common(self, registered_fname: str, file_context: AbstractScriptFileContext, mapname: str = None):
+    def _open_common(self, registered_fname: str, file_context: AbstractScriptFileContext, mapname: Optional[str] = None):
         assert self.file_manager
         if self.file_manager:
             if registered_fname in self._open_editors:
                 self._notebook.set_current_page(self._notebook.page_num(
                     self._open_editors[registered_fname].get_root_object()
                 ))
             else:
@@ -193,15 +189,15 @@
                 self.open_exps_macro(editor_filename)
         else:
             self._notebook.set_current_page(self._notebook.page_num(self._open_editors[editor_filename].get_root_object()))
         self._open_editors[editor_filename].focus_opcode(ssb_filename, opcode_addr)
 
     def break_pulled(self, state: BreakpointState):
         """The debugger paused. Enable debugger controls for file_name."""
-        file_state = state.get_file_state()
+        file_state = cast(BreakpointFileState, state.file_state)
         assert file_state
         for editor in self._open_editors.values():
             editor.toggle_debugging_controls(True)
             editor.on_break_pulled(file_state.ssb_filename, file_state.opcode_addr, file_state.halted_on_call)
         self._cached_file_bpnt_state = file_state
         state.add_release_hook(self.break_released)
 
@@ -266,34 +262,34 @@
         The ssb file ssb_filename was changed and it imports the ExplorerScript macro file with the absolute path
         of exps_abs_path. Let the file contexts of the open editors handle this.
         """
         for editor in self._open_editors.values():
             editor.on_exps_macro_ssb_changed(exps_abs_path, ssb_filename)
 
     def pull_break__resume(self):
-        self.parent.emu_resume(BreakpointStateType.RESUME)
+        self.parent.emu_resume(BreakpointStateType.Resume)
 
     def pull_break__step_into(self):
         if self._cached_file_bpnt_state and self._cached_file_bpnt_state.halted_on_call:
             self.parent.step_into_macro_call(self._cached_file_bpnt_state)
             return
-        self.parent.emu_resume(BreakpointStateType.STEP_INTO)
+        self.parent.emu_resume(BreakpointStateType.StepInto)
 
     def pull_break__step_over(self):
         if self._cached_file_bpnt_state and self._cached_file_bpnt_state.step_over_addr:
-            return self.parent.emu_resume(BreakpointStateType.STEP_MANUAL, self._cached_file_bpnt_state.step_over_addr)
-        self.parent.emu_resume(BreakpointStateType.STEP_OVER)
+            return self.parent.emu_resume(BreakpointStateType.StepManual, self._cached_file_bpnt_state.step_over_addr)
+        self.parent.emu_resume(BreakpointStateType.StepOver)
 
     def pull_break__step_out(self):
         if self._cached_file_bpnt_state and self._cached_file_bpnt_state.step_out_addr:
-            return self.parent.emu_resume(BreakpointStateType.STEP_MANUAL, self._cached_file_bpnt_state.step_out_addr)
-        self.parent.emu_resume(BreakpointStateType.STEP_OUT)
+            return self.parent.emu_resume(BreakpointStateType.StepManual, self._cached_file_bpnt_state.step_out_addr)
+        self.parent.emu_resume(BreakpointStateType.StepOut)
 
     def pull_break__step_next(self):
-        self.parent.emu_resume(BreakpointStateType.STEP_NEXT)
+        self.parent.emu_resume(BreakpointStateType.StepNext)
 
     def toggle_breaks_disabled(self, value):
         for editor in self._open_editors.values():
             editor.toggle_breaks_disabled(value)
 
     def save_all(self):
         for editor in self._open_editors.values():
```

## skytemple_ssb_debugger/controller/global_state.py

```diff
@@ -10,164 +10,102 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-import json
-import math
-import os
-import sys
-from functools import partial
-from threading import Lock
-from typing import Optional, List, Dict
+from __future__ import annotations
 from enum import Enum
+from typing import Optional, List, Callable
 
 import gi
+from skytemple_files.common.i18n_util import _
 
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptGameVar, GameVariableType
-from skytemple_files.common.util import open_utf8
-from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu_nonblocking, threadsafe_gtk_nonblocking, synchronized, \
-    threadsafe_emu
-from skytemple_files.common.i18n_util import f, _
+from skytemple_ssb_emulator import EmulatorMemTable, emulator_sync_tables
 
 gi.require_version('Gtk', '3.0')
 
 from gi.repository import Gtk
 
 
-global_state_lock = Lock()
-
-
 class MemAllocType(Enum):
     UNUSED = 0x00, _('Free')
     STATIC = 0x01, _('Static')
     BLOCK = 0x02, _('Block')
     TEMPORARY = 0x03, _('Temporary')
     SUBTABLE = 0x04, _('Sub Table')
-    
+
     def __new__(cls, *args, **kwargs):
         obj = object.__new__(cls)
         obj._value_ = args[0]
         return obj
 
     # ignore the first param since it's already set by __new__
     def __init__(
             self, _: int, description: str
     ):
         self.description = description
 
 
-class MemTableEntry:
-    def __init__(self, type_alloc: MemAllocType, unk1: int, unk2: int, start_address: int, available: int, used: int):
-        self.type_alloc = type_alloc
-        self.unk1 = unk1
-        self.unk2 = unk2
-        self.start_address = start_address
-        self.available = available
-        self.used = used
-
-
-class MemTable:
-    def __init__(self, entries: List[MemTableEntry], start_address: int, parent_table: int, addr_table: int, max_entries: int, addr_data: int, len_data: int):
-        self.entries = entries
-        self.start_address = start_address
-        self.parent_table = parent_table
-        self.addr_table = addr_table
-        self.max_entries = max_entries
-        self.addr_data = addr_data
-        self.len_data = len_data
-
-
 class GlobalStateController:
-    def __init__(self, emu_thread: Optional[EmulatorThread], builder: Gtk.Builder):
+    def __init__(self, builder: Gtk.Builder):
         super().__init__()
-        self.emu_thread = emu_thread
         self.builder = builder
         self.rom_data: Optional[Pmd2Data] = None
-        self._tables: List[MemTable] = []
+        self._tables: List[EmulatorMemTable] = []
         self._current_table = 0
 
     def change_current_table(self, current_table):
         self._current_table = max(0, min(current_table, len(self._tables)))
-        threadsafe_gtk_nonblocking(self._do_sync_gtk)
-    
-    def dump(self, file_id) -> bytes:
+        self._apply_sync()
+
+    def dump(self, file_id, cb: Callable[[bytes], None]):
         """Dump one file from the rom"""
-        start = self._tables[self._current_table].entries[file_id].start_address
-        length = self._tables[self._current_table].entries[file_id].available
-        return self.emu_thread.emu.memory.unsigned[start:start+length]  # type: ignore
+        return self._tables[self._current_table].entries[file_id].dump(cb)
 
     def sync(self):
         """Manual force sync of global state"""
-        if not self.emu_thread:
-            return
-        threadsafe_emu_nonblocking(self.emu_thread, self._do_sync)
-
-    # RUNNING IN EMULATOR THREAD:
-    @synchronized(global_state_lock)
-    def _do_sync(self):
-        self._tables = []
         self._current_table = 0
-        if self.rom_data is not None:
-            address_table_head = self.rom_data.bin_sections.itcm.data.MEMORY_ALLOCATION_TABLE.absolute_address
-            accessor = self.emu_thread.emu.memory.unsigned
-            for x in range(accessor.read_long(address_table_head)):
-                address_table = address_table_head+0x20+0x4*x
-                self._tables.append(self._read_table(accessor.read_long(address_table)))
-        threadsafe_gtk_nonblocking(self._do_sync_gtk)
+        def update(vals):
+            self._tables = list(vals)
+            self._apply_sync()
+
+        assert self.rom_data is not None
+        emulator_sync_tables(self.rom_data.bin_sections.itcm.data.MEMORY_ALLOCATION_TABLE.absolute_address, update)
 
-    @synchronized(global_state_lock)
-    def _do_sync_gtk(self):
+    def _apply_sync(self):
         store = self.builder.get_object('global_state_alloc_store')
         store.clear()
-        if self._current_table<len(self._tables):
+        if self._current_table < len(self._tables):
             table = self._tables[self._current_table]
             for e in table.entries:
-                line = [e.type_alloc.description, e.unk1, e.unk2, hex(e.start_address), hex(e.available), hex(e.used)]
+                line = [
+                    MemAllocType(int(e.type_alloc)).description,  # type: ignore
+                    e.unk1,
+                    e.unk2,
+                    hex(e.start_address),
+                    hex(e.available),
+                    hex(e.used)
+                ]
                 store.append(line)
-            self.builder.get_object('lbl_alloc_table_header').set_text(f'{hex(table.start_address)} - {hex(table.start_address+0x1c)}')
-            self.builder.get_object('lbl_alloc_table_data').set_text(f'{hex(table.addr_data)} - {hex(table.addr_data+table.len_data)}')
+            self.builder.get_object('lbl_alloc_table_header').set_text(
+                f'{hex(table.start_address)} - {hex(table.start_address + 0x1c)}')
+            self.builder.get_object('lbl_alloc_table_data').set_text(
+                f'{hex(table.addr_data)} - {hex(table.addr_data + table.len_data)}')
             self.builder.get_object('lbl_alloc_table_entries').set_text(f'{len(table.entries)}/{table.max_entries}')
             parent = None
             for i, t in enumerate(self._tables):
-                if table.parent_table==t.start_address:
+                if table.parent_table == t.start_address:
                     parent = i
             self.builder.get_object('lbl_alloc_table_parent').set_text(f'{hex(table.parent_table)} ({parent})')
         alloc_table_nb = self.builder.get_object('spin_alloc_table_nb')
-        self.builder.get_object('spin_alloc_table_nb').set_text(str(self._current_table))
-        self.builder.get_object('spin_alloc_table_nb').set_increments(1,1)
-        self.builder.get_object('spin_alloc_table_nb').set_range(0, len(self._tables)-1)
-
-    def _read_table(self, start_address) -> MemTable:
-        accessor = self.emu_thread.emu.memory.unsigned  # type: ignore
-        parent_table = accessor.read_long(start_address+0x4)
-        addr_table = accessor.read_long(start_address+0x8)
-        entries = accessor.read_long(start_address+0xc)
-        max_entries = accessor.read_long(start_address+0x10)
-        addr_data = accessor.read_long(start_address+0x14)
-        len_data = accessor.read_long(start_address+0x18)
-        blocks = []
-        for x in range(entries):
-            entry_start = addr_table+0x18*x
-            ent_type = MemAllocType(accessor.read_long(entry_start))  # type: ignore
-            unk1 = accessor.read_long(entry_start+0x4)
-            unk2 = accessor.read_long(entry_start+0x8)
-            start_addr = accessor.read_long(entry_start+0xc)
-            available = accessor.read_long(entry_start+0x10)
-            used = accessor.read_long(entry_start+0x14)
-            blocks.append(MemTableEntry(ent_type, unk1, unk2, start_addr, available, used))
-        return MemTable(blocks, start_address, parent_table, addr_table, max_entries, addr_data, len_data)
-        
+        alloc_table_nb.set_text(str(self._current_table))
+        alloc_table_nb.set_increments(1, 1)
+        alloc_table_nb.set_range(0, len(self._tables) - 1)
+
     def init(self, rom_data: Pmd2Data):
-        if not self.emu_thread:
-            return
         self.rom_data = rom_data
-    
+
     def uninit(self):
-        if not self.emu_thread:
-            return
         self.rom_data = None
```

## skytemple_ssb_debugger/controller/ground_state.py

```diff
@@ -10,45 +10,44 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import os
 from typing import Optional, Dict, List, Tuple
 
 import gi
 from gi.repository.Gtk import TreeViewColumn
 
 from explorerscript.ssb_converting.ssb_data_types import SsbRoutineType
 from skytemple_ssb_debugger.model.constants import ICON_GLOBAL_SCRIPT, ICON_ACTOR, ICON_OBJECT, ICON_PERFORMER, \
     ICON_POSITION_MARKER, ICON_EVENTS
 from skytemple_ssb_debugger.model.ground_engine_state import TALK_HANGER_OFFSET
 from skytemple_ssb_debugger.model.script_runtime_struct import ScriptRuntimeStruct
-from skytemple_files.common.i18n_util import f, _
+from skytemple_files.common.i18n_util import _
 
 GE_FILE_STORE_SCRIPT = _('Script')
 
 gi.require_version('Gtk', '3.0')
 
 from gi.repository import Gtk
 
-from desmume.emulator import DeSmuME
 from skytemple_ssb_debugger.controller.debugger import DebuggerController
 
 
 def resizable(column):
     column.set_resizable(True)
     return column
 
 
 class GroundStateController:
-    def __init__(self, emu: Optional[DeSmuME], debugger_controller: DebuggerController, builder: Gtk.Builder):
-        self.emu = emu
+    def __init__(self, debugger_controller: DebuggerController, builder: Gtk.Builder):
         self.debugger = debugger_controller
         self.builder = builder
 
         self._was_running_last_sync = False
 
         self._files__sw: Gtk.ScrolledWindow = builder.get_object('ground_state_files_tree_sw')
         self._entities__sw: Gtk.ScrolledWindow = builder.get_object('ground_state_entities_tree_sw')
@@ -95,22 +94,23 @@
 
     def sync_break_hanger(self):
         """
         Only sync the "breaked" property of all loaded SSB files and update them in the views.
         The views must be built already.
         """
         ground_state = self.debugger.ground_engine_state
+        assert ground_state is not None
         for ssb in ground_state.loaded_ssb_files:
             if ssb is not None and ssb.hanger in self._ssb_tree_store_iters:
                 if ssb.breaked:
                     self._entities__tree_store[self._ssb_tree_store_iters[ssb.hanger]][6] = 'media-playback-pause'
                 else:
                     self._entities__tree_store[self._ssb_tree_store_iters[ssb.hanger]][6] = ''
 
-    def sync(self, code_editor=None, breaked_for: ScriptRuntimeStruct = None):
+    def sync(self, code_editor=None, breaked_for: Optional[ScriptRuntimeStruct] = None):
         """
         Synchronize the ground engine state to the UI. If code_editor is set, send the opcodes that currently being
         run by the engine to the editor.
         """
         if self.debugger and self.debugger.ground_engine_state:
             ground_state = self.debugger.ground_engine_state
             if ground_state.running and not self._was_running_last_sync:
@@ -126,15 +126,15 @@
                 self._files__sw.add(self._files__not_loaded)
                 self._entities__sw.add(self._entities__not_loaded)
 
             self._was_running_last_sync = ground_state.running
 
             if ground_state.running:
                 # Is runningues
-                global_script, ssb, ssx, actors, objects, performers, events = ground_state.collect()
+                global_script, ssb, ssx, actors, objects, performers, events, themap = ground_state.collect()
 
                 if code_editor:
                     # Sync the code editor execution lines
                     files: Dict[str, List[Tuple[SsbRoutineType, int, int]]] = {}
                     try:
                         if global_script.script_struct.hanger_ssb > -1 and ssb[global_script.script_struct.hanger_ssb] is not None:
                             if ssb[global_script.script_struct.hanger_ssb].file_name not in files:
@@ -229,15 +229,16 @@
                     if global_script.script_struct.hanger_ssb > -1 and ssb[global_script.script_struct.hanger_ssb] is not None:
                         breaked = ssb[global_script.script_struct.hanger_ssb].breaked and global_script.script_struct == breaked_for
                 except (IndexError, AttributeError):
                     pass
                 self._entities__tree_store.append(None, [
                     _('<Global>'), '0', '',
                     self.get_short_sname(ssb, breaked, global_script.script_struct.hanger_ssb), None, '',
-                    'skytemple-media-playback-pause-symbolic' if breaked else '', ICON_GLOBAL_SCRIPT, '', '', SsbRoutineType.GENERIC.value
+                    'skytemple-media-playback-pause-symbolic' if breaked else '', ICON_GLOBAL_SCRIPT,
+                    f'{themap.camera_x_pos}', f'{themap.camera_y_pos}', SsbRoutineType.GENERIC.value
                 ])
                 actors_node = self._entities__tree_store.append(None, [
                     _('Actors'), '', '', '', None, '', '', ICON_ACTOR, '', '', -1
                 ])
                 for actor in actors:
                     breaked = False
                     try:
```

## skytemple_ssb_debugger/controller/local_variable.py

```diff
@@ -10,40 +10,34 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from functools import partial
-from threading import Lock
-from typing import Optional, List
+from __future__ import annotations
+from typing import Optional, List, Sequence
 
 from gi.overrides.Gtk import TreeViewColumn
 from gi.repository import Gtk
 
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptGameVar
+from skytemple_ssb_emulator import emulator_sync_local_vars
+
 from skytemple_ssb_debugger.controller.debugger import DebuggerController
 from skytemple_ssb_debugger.controller.ground_state import resizable
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
 from skytemple_ssb_debugger.model.breakpoint_file_state import BreakpointFileState
-from skytemple_ssb_debugger.model.game_variable import GameVariable
 from skytemple_ssb_debugger.model.script_runtime_struct import ScriptRuntimeStruct
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu_nonblocking, synchronized, threadsafe_gtk_nonblocking
-from skytemple_files.common.i18n_util import f, _
-
-local_variables_lock = Lock()
-macro_variables_lock = Lock()
+from skytemple_files.common.i18n_util import _
 
 
 class LocalVariableController:
     """Controller for showing both local and macro variables"""
-    def __init__(self, emu_thread: Optional[EmulatorThread], builder: Gtk.Builder, debugger: Optional[DebuggerController]):
-        self.emu_thread = emu_thread
+    def __init__(self, builder: Gtk.Builder, debugger: Optional[DebuggerController]):
         self.builder = builder
         self.debugger = debugger
 
         self._local__sw: Gtk.ScrolledWindow = builder.get_object('local_variables_sw')
         self._macro__sw: Gtk.ScrolledWindow = builder.get_object('macro_variables_sw')
 
         self._local__not_loaded: Gtk.Viewport = builder.get_object('local_vars_ges_not_loaded')
@@ -57,61 +51,53 @@
         self._local__tree.append_column(resizable(TreeViewColumn(_("Value"), Gtk.CellRendererText(), text=1)))
 
         self._macro__tree: Gtk.TreeView = builder.get_object('macro_variables_list')
         self._macro__tree.append_column(resizable(TreeViewColumn(_("Name"), Gtk.CellRendererText(), text=0)))
         self._macro__tree.append_column(resizable(TreeViewColumn(_("Value"), Gtk.CellRendererText(), text=1)))
 
         self._local_vars_specs: Optional[List[Pmd2ScriptGameVar]] = None
-        self._local_vars_values: List[int] = []
+        self._local_vars_values: Sequence[int] = []
         self._rom_data: Optional[Pmd2Data] = None
         self._was_disabled = True
 
     def init(self, rom_data: Pmd2Data):
         self._local_vars_specs = []
         self._rom_data = rom_data
         for var in rom_data.script_data.game_variables:
             if var.is_local:
                 self._local_vars_specs.append(var)
 
-    @synchronized(local_variables_lock)
-    def sync(self, breaked_for: ScriptRuntimeStruct, file_state: BreakpointFileState = None):
+    def sync(self, local_vars_values: Sequence[int], file_state: Optional[BreakpointFileState] = None):
         if not self.debugger or not self.debugger.ground_engine_state or not self._local_vars_specs:
             return self.disable()
 
         if self._was_disabled:
             self._local__sw.remove(self._local__not_loaded)
             self._macro__sw.remove(self._macro__not_loaded)
             self._local__sw.add(self._local__tree)
             self._macro__sw.add(self._macro__tree)
             self._was_disabled = False
 
-        # Local variables
-        self._local__list_store.clear()
-        self._local_vars_values = []
-        threadsafe_emu_nonblocking(self.emu_thread, partial(self._do_sync_local_vars, breaked_for))
-
         # Macro variables
         self._macro__list_store.clear()
         if file_state and file_state.current_macro_variables:
             for name, value in file_state.current_macro_variables.items():
                 self._macro__list_store.append([name, str(value)])
 
-    # RUNNING IN EMULATOR THREAD:
-    @synchronized(local_variables_lock)
-    def _do_sync_local_vars(self, srs):
-        for var in self._local_vars_specs:
-            _, val = GameVariable.read(self.emu_thread.emu.memory, self._rom_data, var.id, 0, srs)
-            self._local_vars_values.append(val)
-        threadsafe_gtk_nonblocking(self._do_sync_gtk)
+        # Local variables
+        self._local__list_store.clear()
+
+        self._local_vars_values = local_vars_values
+        self._do_sync_gtk()
 
-    @synchronized(local_variables_lock)
     def _do_sync_gtk(self):
-        for i, var in enumerate(self._local_vars_specs):
-            value = self._local_vars_values[i]
-            self._local__list_store.append([var.name, value])
+        if self._local_vars_specs is not None:
+            for i, var in enumerate(self._local_vars_specs):
+                value = self._local_vars_values[i]
+                self._local__list_store.append([var.name, value])
 
     def disable(self):
         if not self._was_disabled:
             self._local__sw.remove(self._local__tree)
             self._macro__sw.remove(self._macro__tree)
             self._local__sw.add(self._local__not_loaded)
             self._macro__sw.add(self._macro__not_loaded)
```

## skytemple_ssb_debugger/controller/main.py

```diff
@@ -10,58 +10,62 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import json
 import logging
 import os
 import shutil
 import sys
-import traceback
 import webbrowser
 from functools import partial
-from typing import Optional, Dict, List
+from typing import Optional, Dict, List, Sequence
 
 import cairo
 import gi
+from PIL import Image
+from range_typed_integers import u32
 
 from skytemple_files.common.util import open_utf8, add_extension_if_missing
+from skytemple_ssb_emulator import SCREEN_WIDTH, SCREEN_HEIGHT, emulator_load_controls, Language, emulator_poll, \
+    emulator_get_kbcfg, emulator_set_kbcfg, emulator_get_jscfg, emulator_set_jscfg, emulator_keypad_add_key, \
+    emulator_keymask, EmulatorKeys, emulator_keypad_rm_key, emulator_touch_release, emulator_supports_joystick, \
+    emulator_is_running, SCREEN_HEIGHT_BOTH, emulator_volume_set, emulator_savestate_load_file, \
+    emulator_savestate_save_file, emulator_set_debug_mode, emulator_set_debug_flag_1, emulator_set_debug_flag_2, \
+    emulator_start, emulator_joy_init, emulator_touch_set_pos, emulator_resume, emulator_unpress_all_keys, \
+    emulator_reset, emulator_pause, emulator_shutdown, emulator_set_boost, emulator_set_language, emulator_open_rom, \
+    emulator_display_buffer_as_rgbx, emulator_debug_init_breakpoint_manager
+
+from skytemple_ssb_debugger.controller.desmume_control_ui.joystick_controls import JoystickControlsDialogController
+from skytemple_ssb_debugger.controller.desmume_control_ui.keyboard_controls import KeyboardControlsDialogController
 
 gi.require_version('GtkSource', '4')
 from gi.repository.GtkSource import StyleSchemeManager
 
-from desmume.controls import Keys, keymask
-from desmume.emulator import SCREEN_WIDTH, SCREEN_HEIGHT, Language
-from desmume.emulator import SCREEN_WIDTH, SCREEN_HEIGHT, Language
-from desmume.frontend.control_ui.joystick_controls import JoystickControlsDialogController
-from desmume.frontend.control_ui.keyboard_controls import KeyboardControlsDialogController
 from explorerscript import EXPLORERSCRIPT_EXT
 from explorerscript.ssb_converting.ssb_data_types import SsbRoutineType
 from skytemple_files.common.script_util import SCRIPT_DIR
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
 from skytemple_ssb_debugger.controller.debug_overlay import DebugOverlayController
 from skytemple_ssb_debugger.controller.debugger import DebuggerController
 from skytemple_ssb_debugger.controller.editor_notebook import EditorNotebookController
 from skytemple_ssb_debugger.controller.ground_state import GroundStateController, GE_FILE_STORE_SCRIPT
 from skytemple_ssb_debugger.controller.local_variable import LocalVariableController
 from skytemple_ssb_debugger.controller.global_state import GlobalStateController
 from skytemple_ssb_debugger.controller.variable import VariableController
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread, supports_joystick
 from skytemple_ssb_debugger.model.breakpoint_file_state import BreakpointFileState
-from skytemple_ssb_debugger.model.breakpoint_manager import BreakpointManager
-from skytemple_ssb_debugger.model.breakpoint_state import BreakpointState, BreakpointStateType
+from skytemple_ssb_emulator import BreakpointState, BreakpointStateType
 from skytemple_ssb_debugger.model.script_runtime_struct import ScriptRuntimeStruct
 from skytemple_ssb_debugger.model.settings import DebuggerSettingsStore, TEXTBOX_TOOL_URL
 from skytemple_ssb_debugger.model.ssb_files.file_manager import SsbFileManager
 from skytemple_ssb_debugger.renderer.async_software import AsyncSoftwareRenderer
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu, threadsafe_emu_nonblocking, threadsafe_gtk_nonblocking, \
-    generate_emulator_proxy
 from skytemple_files.common.i18n_util import f, _
 
 gi.require_version('Gtk', '3.0')
 
 from gi.repository import Gtk, Gdk, GLib
 
 logger = logging.getLogger(__name__)
@@ -75,17 +79,15 @@
 class MainController:
     
     def __init__(self, builder: Gtk.Builder, window: Gtk.Window, control_context: AbstractDebuggerControlContext):
         self.builder = builder
         self.window = window
         self.context: AbstractDebuggerControlContext = control_context
         self.settings = DebuggerSettingsStore()
-        self.emu_thread: Optional[EmulatorThread] = None
         self.ssb_fm: Optional[SsbFileManager] = None
-        self.breakpoint_manager: Optional[BreakpointManager] = None
         self.rom_was_loaded = False
         self._emu_is_running = False
 
         self._enable_explorerscript = True
 
         self.debugger: Optional[DebuggerController] = None
         self.debug_overlay: Optional[DebugOverlayController] = None
@@ -154,69 +156,68 @@
         self._filter_gba_ds.set_name(_("Nintendo DS ROMs with binary loader (*.ds.gba)"))
         self._filter_gba_ds.add_pattern("*.nds")
 
         self._filter_any = Gtk.FileFilter()
         self._filter_any.set_name(_("All files"))
         self._filter_any.add_pattern("*")
 
+        self._poll_emulator_event_id = None
+
         self.main_draw = builder.get_object("draw_main")
         self.main_draw.set_events(Gdk.EventMask.ALL_EVENTS_MASK)
         self.main_draw.show()
         self.sub_draw = builder.get_object("draw_sub")
         self.sub_draw.set_events(Gdk.EventMask.ALL_EVENTS_MASK)
         self.sub_draw.show()
 
         self.renderer = None
         self.init_emulator()
 
-        if self.emu_thread:
-
-            self.debugger = DebuggerController(self.emu_thread, self._debugger_print_callback, self)
+        self.debugger = DebuggerController(self._debugger_print_callback, self)
 
-            self.debug_overlay = DebugOverlayController(self.debugger)
-            self.renderer = AsyncSoftwareRenderer(self.emu_thread, self.main_draw, self.sub_draw, self.debug_overlay.draw)
-            self.renderer.init()
-            self.renderer.start()
-
-            threadsafe_emu(
-                self.emu_thread, lambda: self.emu_thread.load_controls(self.settings)
-            )
-            self._keyboard_tmp = self.emu_thread.get_kbcfg()
+        self.debug_overlay = DebugOverlayController(self.debugger)
+        self.renderer = AsyncSoftwareRenderer(self.main_draw, self.sub_draw, self.debug_overlay.draw)
+        self.renderer.start()
+
+        emulator_load_controls(
+            self.settings.get_emulator_keyboard_cfg(),
+            self.settings.get_emulator_joystick_cfg()
+        )
 
-            lang = self.settings.get_emulator_language()
-            if lang:
-                self._suppress_event = True
-                if lang == Language.JAPANESE:
-                    self.builder.get_object('menu_emulator_language_jp').set_active(True)
-                elif lang == Language.ENGLISH:
-                    self.builder.get_object('menu_emulator_language_en').set_active(True)
-                elif lang == Language.FRENCH:
-                    self.builder.get_object('menu_emulator_language_fr').set_active(True)
-                elif lang == Language.GERMAN:
-                    self.builder.get_object('menu_emulator_language_de').set_active(True)
-                elif lang == Language.ITALIAN:
-                    self.builder.get_object('menu_emulator_language_it').set_active(True)
-                elif lang == Language.SPANISH:
-                    self.builder.get_object('menu_emulator_language_es').set_active(True)
-                self._suppress_event = False
+        lang = self.settings.get_emulator_language()
+        if lang:
+            self._suppress_event = True
+            if lang == Language.Japanese:
+                self.builder.get_object('menu_emulator_language_jp').set_active(True)
+            elif lang == Language.English:
+                self.builder.get_object('menu_emulator_language_en').set_active(True)
+            elif lang == Language.French:
+                self.builder.get_object('menu_emulator_language_fr').set_active(True)
+            elif lang == Language.German:
+                self.builder.get_object('menu_emulator_language_de').set_active(True)
+            elif lang == Language.Italian:
+                self.builder.get_object('menu_emulator_language_it').set_active(True)
+            elif lang == Language.Spanish:
+                self.builder.get_object('menu_emulator_language_es').set_active(True)
+            self._suppress_event = False
 
         self.editor_notebook: EditorNotebookController = EditorNotebookController(
-            self.builder, self, self.window, self._enable_explorerscript)  # type: ignore
-        self.variable_controller: VariableController = VariableController(self.emu_thread, self.builder, self.context)
-        self.global_state_controller: GlobalStateController = GlobalStateController(self.emu_thread, self.builder)
-        self.local_variable_controller: LocalVariableController = LocalVariableController(self.emu_thread, self.builder, self.debugger)
-        self.ground_state_controller = GroundStateController(self.emu_thread, self.debugger, self.builder)  # type: ignore
+            self.builder, self, self.window, self._enable_explorerscript
+        )
+        self.variable_controller: VariableController = VariableController(self.builder, self.context)
+        self.global_state_controller: GlobalStateController = GlobalStateController(self.builder)
+        self.local_variable_controller: LocalVariableController = LocalVariableController(self.builder, self.debugger)
+        self.ground_state_controller = GroundStateController(self.debugger, self.builder)
 
         # Load more initial settings
         self.on_debug_log_cntrl_ops_toggled(builder.get_object('debug_log_cntrl_ops'))
         self.on_debug_log_cntrl_script_toggled(builder.get_object('debug_log_cntrl_script'))
         self.on_debug_log_cntrl_internal_toggled(builder.get_object('debug_log_cntrl_internal'))
         self.on_debug_log_cntrl_ground_state_toggled(builder.get_object('debug_log_cntrl_ground_state'))
         self.on_debug_settings_debug_mode_toggled(builder.get_object('debug_settings_debug_mode'))
-        self.on_debug_settings_debug_dungeon_skip_toggled(builder.get_object('debug_settings_debug_dungeon_skip'))
         self.on_debug_settings_overlay_toggled(builder.get_object('debug_settings_overlay'))
         self.on_emulator_controls_volume_toggled(builder.get_object('emulator_controls_volume'))
         self.on_debug_log_scroll_to_bottom_toggled(builder.get_object('debug_log_scroll_to_bottom'))
 
         # Trees / Lists
         ssb_file_tree: Gtk.TreeView = self.builder.get_object('ssb_file_tree')
         column_main = Gtk.TreeViewColumn(_("Name"), Gtk.CellRendererText(), text=1)
@@ -262,31 +263,27 @@
 
     @emu_is_running.setter
     def emu_is_running(self, value):
         self._emu_is_running = value
 
     @property
     def _keyboard_cfg(self):
-        if self.emu_thread is None:
-            return None
-        return self.emu_thread.get_kbcfg()
+        return emulator_get_kbcfg()
 
     @_keyboard_cfg.setter
     def _keyboard_cfg(self, value):
-        self.emu_thread.set_kbcfg(value)
+        emulator_set_kbcfg(value)
 
     @property
     def _joystick_cfg(self):
-        if self.emu_thread is None:
-            return None
-        return self.emu_thread.get_jscfg()
+        return emulator_get_jscfg()
 
     @_joystick_cfg.setter
     def _joystick_cfg(self, value):
-        self.emu_thread.set_jscfg(value)
+        emulator_set_jscfg(value, False)
 
     @property
     def global_state__breaks_disabled(self):
         return self.builder.get_object('menu_debugger_disable_breaks').get_active()
 
     @global_state__breaks_disabled.setter
     def global_state__breaks_disabled(self, value):
@@ -296,50 +293,79 @@
 
     @property
     def global_state__audio_enabled(self):
         return self.builder.get_object('emulator_controls_volume').get_active()
 
     def init_emulator(self):
         try:
-            # Load desmume
-            self.emu_thread = EmulatorThread(self)
-            self.emu_thread.start()
+            # Load emulator
+            emulator_start()
 
             # Init joysticks
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.joy_init())
+            emulator_joy_init()
+
+            # Poll the emulator for events periodically
+            self.install_poll_emulator()
         except BaseException as ex:
-            self.emu_thread = None
             self.context.display_error(
                 sys.exc_info(),
-                f(_("DeSmuME couldn't be loaded. "
+                f(_("The emulator couldn't be loaded. "
                     "Debugging functionality will not be available:\n\n"
                     "{ex}")),
                 _("Error loading the emulator!")
             )
             return
 
+    def install_poll_emulator(self):
+        # 30 FPS
+        self._poll_emulator_event_id = GLib.timeout_add(1000 // 30, self.do_poll_emulator)
+
+    def uninstall_poll_emulator(self):
+        if self._poll_emulator_event_id is not None:
+            GLib.source_remove(self._poll_emulator_event_id)
+
+    def do_poll_emulator(self):
+        try:
+            errs = []
+            while emulator_poll(lambda err: errs.append(err)):
+                pass
+            if len(errs) > 0:
+                # noinspection PyUnusedLocal
+                errs_as_str = "\n".join(errs)
+                self.context.display_error(
+                    None,
+                    f(_("The emulator reported an error:\n\n{errs_as_str}")),
+                    _("Emulator Error")
+                )
+        except Exception as ex:
+            self.context.display_error(
+                sys.exc_info(),
+                f(_("The emulator reported an internal error:\n\n")),
+                _("Emulator Error")
+            )
+        return True
+
     def on_main_window_delete_event(self, *args):
         if not self.editor_notebook.close_all_tabs() or not self.context.before_quit():
             return True
         if self.rom_was_loaded:
             self.uninit_project()
         self.gtk_main_quit()
         return False
 
     def on_main_window_destroy(self, *args):
         self.gtk_main_quit()
 
     def gtk_main_quit(self, *args):
         if self.breakpoint_state:
             self.breakpoint_state.fail_hard()
-        if self.emu_thread:
-            if not self._stopped:
-                self.emu_stop()
-        if self.emu_thread:
-            EmulatorThread.end()
+        if not self._stopped:
+            self.emu_stop()
+        self.uninstall_poll_emulator()
+        emulator_shutdown()
         self.context.on_quit()
 
     def gtk_widget_hide_on_delete(self, w: Gtk.Widget, *args):
         w.hide_on_delete()
         return True
 
     def gtk_widget_hide(self, w: Gtk.Widget, *args):
@@ -357,38 +383,36 @@
         scale = widget.get_child().get_allocated_width() / SCREEN_WIDTH
         if self.renderer:
             self.renderer.set_scale(scale)
         self._current_screen_height = SCREEN_HEIGHT * scale
         self._current_screen_width = SCREEN_WIDTH * scale
 
     def on_main_window_key_press_event(self, widget: Gtk.Widget, event: Gdk.EventKey, *args):
-        if self.emu_thread:
-            # Don't enable controls when in any entry or text view
-            if isinstance(self.window.get_focus(), Gtk.Entry) or isinstance(self.window.get_focus(), Gtk.TextView):
-                return False
-            key = self.lookup_key(event.keyval)
-            # shift,ctrl, both alts
-            mask = Gdk.ModifierType.SHIFT_MASK | Gdk.ModifierType.CONTROL_MASK | Gdk.ModifierType.MOD1_MASK | Gdk.ModifierType.MOD5_MASK
-            if event.state & mask == 0:
-                if key and self.emu_is_running:
-                    threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.input.keypad_add_key(key))
-                    if key == keymask(Keys.KEY_BOOST):
-                        # Handle boost
-                        self.toggle_boost(True)
-                    return True
+        # Don't enable controls when in any entry or text view
+        if isinstance(self.window.get_focus(), Gtk.Entry) or isinstance(self.window.get_focus(), Gtk.TextView):
             return False
-
-    def on_main_window_key_release_event(self, widget: Gtk.Widget, event: Gdk.EventKey, *args):
-        if self.emu_thread:
-            key = self.lookup_key(event.keyval)
+        key = self.lookup_key(event.keyval)
+        # shift,ctrl, both alts
+        mask = Gdk.ModifierType.SHIFT_MASK | Gdk.ModifierType.CONTROL_MASK | Gdk.ModifierType.MOD1_MASK | Gdk.ModifierType.MOD5_MASK
+        if event.state & mask == 0:
             if key and self.emu_is_running:
-                threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.input.keypad_rm_key(key))
-                if key == keymask(Keys.KEY_BOOST):
+                emulator_keypad_add_key(key)
+                if key == emulator_keymask(EmulatorKeys.KEY_BOOST):
                     # Handle boost
-                    self.toggle_boost(False)
+                    self.toggle_boost(True)
+                return True
+        return False
+
+    def on_main_window_key_release_event(self, widget: Gtk.Widget, event: Gdk.EventKey, *args):
+        key = self.lookup_key(event.keyval)
+        if key and self.emu_is_running:
+            emulator_keypad_rm_key(key)
+            if key == emulator_keymask(EmulatorKeys.KEY_BOOST):
+                # Handle boost
+                self.toggle_boost(False)
 
     def on_draw_main_draw(self, widget: Gtk.DrawingArea, ctx: cairo.Context, *args):
         if self.renderer:
             return self.renderer.screen(self._current_screen_width, self._current_screen_height, ctx, 0)
 
     def on_draw_main_configure_event(self, widget: Gtk.DrawingArea, *args):
         if self.renderer:
@@ -419,54 +443,50 @@
     def on_draw_sub_button_release_event(self, widget: Gtk.Widget, event: Gdk.EventButton, *args):
         return self.on_draw_button_release_event(widget, event, 1)
 
     def on_draw_sub_button_press_event(self, widget: Gtk.Widget, event: Gdk.EventButton, *args):
         return self.on_draw_button_press_event(widget, event, 1)
 
     def on_draw_motion_notify_event(self, widget: Gtk.Widget, event: Gdk.EventMotion, display_id: int):
-        if self.emu_thread:
-            if display_id == 1 and self._click:
-                if event.is_hint:
-                    _, x, y, state = widget.get_window().get_pointer()
-                else:
-                    x = event.x
-                    y = event.y
-                    state = event.state
-                if state & Gdk.ModifierType.BUTTON1_MASK:
-                    self.set_touch_pos(x, y)
+        if display_id == 1 and self._click:
+            if event.is_hint:
+                _, x, y, state = widget.get_window().get_pointer()
+            else:
+                x = event.x
+                y = event.y
+                state = event.state
+            if state & Gdk.ModifierType.BUTTON1_MASK:
+                self.set_touch_pos(x, y)
 
     def on_draw_button_release_event(self, widget: Gtk.Widget, event: Gdk.EventButton, display_id: int):
-        if self.emu_thread:
-            if display_id == 1 and self._click:
-                self._click = False
-                threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.input.touch_release())
-            return True
+        if display_id == 1 and self._click:
+            self._click = False
+            emulator_touch_release()
+        return True
 
     def on_draw_button_press_event(self, widget: Gtk.Widget, event: Gdk.EventButton, display_id: int):
         widget.grab_focus()
-        if self.emu_thread:
-            if event.button == 1:
-                if display_id == 1 and self.emu_is_running:
-                    self._click = True
-                    _, x, y, state = widget.get_window().get_pointer()
-                    if state & Gdk.ModifierType.BUTTON1_MASK:
-                        self.set_touch_pos(x, y)
-            return True
+        if event.button == 1:
+            if display_id == 1 and self.emu_is_running:
+                self._click = True
+                _, x, y, state = widget.get_window().get_pointer()
+                if state & Gdk.ModifierType.BUTTON1_MASK:
+                    self.set_touch_pos(x, y)
+        return True
 
     def on_right_event_box_button_press_event(self, widget: Gtk.Widget, *args):
         """If the right area of the window is pressed, focus it, to disable any entry/textview focus."""
         widget.grab_focus()
         return False
 
     # MENU FILE
     def on_menu_open_activate(self, *args):
         if not self.context.allows_interactive_file_management():
             return
-        if self.emu_thread:
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.pause())
+        emulator_pause()
 
         response, fn = self._file_chooser(Gtk.FileChooserAction.OPEN, _("Open..."), (self._filter_nds, self._filter_gba_ds, self._filter_any))
 
         if response == Gtk.ResponseType.OK:
             try:
                 self.context.open_rom(fn)
             except BaseException as ex:
@@ -564,43 +584,47 @@
     def on_menu_emulator_keyboard_controls_activate(self, button: Gtk.CheckMenuItem, *args):
         new_keyboard_cfg = KeyboardControlsDialogController(self.window).run(self._keyboard_cfg)
         if new_keyboard_cfg is not None:
             self._keyboard_cfg = new_keyboard_cfg
             self.settings.set_emulator_keyboard_cfg(self._keyboard_cfg)
 
     def on_menu_emulator_joystick_controls_activate(self, button: Gtk.CheckMenuItem, *args):
-        if not supports_joystick():
+        if not emulator_supports_joystick():
             self.context.display_error(
                 None,
                 _("Joypads are not supported on macOS. Sorry!"),
             )
             return
-        self._joystick_cfg = JoystickControlsDialogController(self.window).run(
-            self._joystick_cfg, generate_emulator_proxy(self.emu_thread, self.emu_thread.emu.input),  # type: ignore
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.is_running())  # type: ignore
+
+        def update(jscfg):
+            self._joystick_cfg = jscfg
+            self.settings.set_emulator_joystick_cfg(self._joystick_cfg)
+
+        JoystickControlsDialogController(self.window).run(
+            self.do_poll_emulator, self._joystick_cfg, emulator_is_running(), update
         )
-        self.settings.set_emulator_joystick_cfg(self._joystick_cfg)
+
 
     def on_menu_emulator_language_jp_toggled(self, button: Gtk.RadioMenuItem):
-        self.on_menu_emulator_language_XX_toggled(Language.JAPANESE)
+        self.on_menu_emulator_language_XX_toggled(Language.Japanese)
 
     def on_menu_emulator_language_en_toggled(self, button: Gtk.RadioMenuItem):
-        self.on_menu_emulator_language_XX_toggled(Language.ENGLISH)
+        self.on_menu_emulator_language_XX_toggled(Language.English)
 
     def on_menu_emulator_language_fr_toggled(self, button: Gtk.RadioMenuItem):
-        self.on_menu_emulator_language_XX_toggled(Language.FRENCH)
+        self.on_menu_emulator_language_XX_toggled(Language.French)
 
     def on_menu_emulator_language_de_toggled(self, button: Gtk.RadioMenuItem):
-        self.on_menu_emulator_language_XX_toggled(Language.GERMAN)
+        self.on_menu_emulator_language_XX_toggled(Language.German)
 
     def on_menu_emulator_language_it_toggled(self, button: Gtk.RadioMenuItem):
-        self.on_menu_emulator_language_XX_toggled(Language.ITALIAN)
+        self.on_menu_emulator_language_XX_toggled(Language.Italian)
 
     def on_menu_emulator_language_es_toggled(self, button: Gtk.RadioMenuItem):
-        self.on_menu_emulator_language_XX_toggled(Language.SPANISH)
+        self.on_menu_emulator_language_XX_toggled(Language.Spanish)
 
     def on_menu_emulator_language_XX_toggled(self, lang: Language):
         if self._suppress_event:
             return
         self.settings.set_emulator_language(lang)
 
     def on_menu_emulator_savestate1_activate(self, button: Gtk.CheckMenuItem, *args):
@@ -630,15 +654,19 @@
         filter_png.add_pattern("*.png")
 
         response, fn = self._file_chooser(Gtk.FileChooserAction.SAVE, _("Save Screenshot..."),
                                           (filter_png, self._filter_any))
 
         if response == Gtk.ResponseType.OK:
             fn = add_extension_if_missing(fn, 'png')
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.screenshot().save(fn))  # type: ignore
+            Image.frombuffer(
+                'RGBA',
+                (SCREEN_WIDTH, SCREEN_HEIGHT_BOTH),
+                emulator_display_buffer_as_rgbx(), 'raw', 'RGBA', 0, 1
+            ).save(fn)
 
     # MENU HELP
     def on_menu_help_exps_docs_activate(self, btn: Gtk.MenuItem, *args):
         webbrowser.open_new_tab("https://explorerscript.readthedocs.io/en/latest/language_spec.html")
 
     def on_menu_help_textbox_tool_activate(self, btn: Gtk.MenuItem, *args):
         webbrowser.open_new_tab(TEXTBOX_TOOL_URL)
@@ -658,69 +686,59 @@
             # Cool bug??? And it only works on the left as well, wtf?
             header_bar.set_decoration_layout('close')
         about.set_version(get_debugger_version())
         about.run()
 
     # EMULATOR CONTROLS
     def on_emulator_controls_playstop_clicked(self, button: Gtk.Button):
-        if self.emu_thread:
-            if not self._stopped:
-                self.emu_stop()
-            else:
-                if not self.variable_controller.variables_changed_but_not_saved or self._warn_about_unsaved_vars():
-                    self.emu_reset()
-                    self.emu_resume()
+        if not self._stopped:
+            self.emu_stop()
+        else:
+            if not self.variable_controller.variables_changed_but_not_saved or self._warn_about_unsaved_vars():
+                self.emu_reset()
+                self.emu_resume()
 
     def on_emulator_controls_pause_clicked(self, *args):
-        if self.emu_thread:
-            if self.emu_is_running and self.emu_thread.registered_main_loop:
-                self.emu_pause()
-            elif not self._stopped:
-                self.emu_resume()
+        if self.emu_is_running:
+            self.emu_pause()
+        elif not self._stopped:
+            self.emu_resume()
 
     def on_emulator_controls_reset_clicked(self, *args):
-        if self.emu_thread:
-            self.emu_reset()
-            self.emu_resume()
+        self.emu_reset()
+        self.emu_resume()
 
     def on_emulator_controls_volume_toggled(self, button: Gtk.ToggleButton):
         if self._suppress_event:
             return
-        if self.emu_thread:
-            if button.get_active():
-                threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.volume_set(100))
-            else:
-                threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.volume_set(0))
+        if button.get_active():
+            emulator_volume_set(100)
+        else:
+            emulator_volume_set(0)
         self._suppress_event = True
         self.builder.get_object('menu_emulator_volume').set_active(button.get_active())
         self._suppress_event = False
 
     def on_emulator_controls_savestate1_clicked(self, *args):
-        if self.emu_thread:
-            self.savestate(1)
+        self.savestate(1)
 
     def on_emulator_controls_savestate2_clicked(self, *args):
-        if self.emu_thread:
-            self.savestate(2)
+        self.savestate(2)
 
     def on_emulator_controls_savestate3_clicked(self, *args):
-        if self.emu_thread:
-            self.savestate(3)
+        self.savestate(3)
 
     def on_emulator_controls_loadstate1_clicked(self, *args):
-        if self.emu_thread:
-            self.loadstate(1)
+        self.loadstate(1)
 
     def on_emulator_controls_loadstate2_clicked(self, *args):
-        if self.emu_thread:
-            self.loadstate(2)
+        self.loadstate(2)
 
     def on_emulator_controls_loadstate3_clicked(self, *args):
-        if self.emu_thread:
-            self.loadstate(3)
+        self.loadstate(3)
 
     # OPTION TOGGLES
     def on_debug_log_cntrl_ops_toggled(self, btn: Gtk.Widget):
         if self.debugger:
             self.debugger.log_operations(btn.get_active())
 
     def on_debug_log_cntrl_script_toggled(self, btn: Gtk.Widget):
@@ -731,17 +749,17 @@
         if self.debugger:
             self.debugger.log_printfs(btn.get_active())
 
     def on_debug_log_cntrl_ground_state_toggled(self, btn: Gtk.Widget):
         if self.debugger:
             self.debugger.log_ground_engine_state(btn.get_active())
 
-    def on_debug_settings_debug_mode_toggled(self, btn: Gtk.Widget):
-        if self.debugger:
-            self.debugger.debug_mode(btn.get_active())
+    @staticmethod
+    def on_debug_settings_debug_mode_toggled(btn: Gtk.Widget):
+        emulator_set_debug_mode(btn.get_active())
 
     def on_debug_settings_debug_dungeon_skip_toggled(self, btn: Gtk.Widget):
         if self.debugger:
             self.debugger.debug_dungeon_skip(btn.get_active())
 
     def on_debug_settings_overlay_toggled(self, btn: Gtk.Widget):
         if self.debug_overlay:
@@ -865,14 +883,15 @@
     def init_file_tree(self):
         ssb_file_tree_store: Gtk.TreeStore = self._file_tree_store
         ssb_file_tree_store.clear()
 
         if not self._ssb_item_filter:
             self._ssb_item_filter = ssb_file_tree_store.filter_new()
             self.builder.get_object('ssb_file_tree').set_model(self._ssb_item_filter)
+            assert self._ssb_item_filter is not None
             self._ssb_item_filter.set_visible_column(COL_VISIBLE)
 
         self._set_sensitve('ssb_file_search', True)
 
         script_files = self.context.load_script_files()
 
         # EXPLORERSCRIPT MACROS
@@ -956,46 +975,51 @@
         
     def on_global_state_reload_clicked(self, *args):
         self.global_state_controller.sync()
         
     def on_global_state_alloc_dump_clicked(self, *args):
         active_rows: List[Gtk.TreePath] = self.builder.get_object('global_state_alloc_treeview').get_selection().get_selected_rows()[1]
         if len(active_rows) >= 1:
-            data = self.global_state_controller.dump(active_rows[0].get_indices()[0])
-            dialog = Gtk.FileChooserNative.new(
-                _("Save dumped block..."),
-                self.window,
-                Gtk.FileChooserAction.SAVE,
-                _('_Save'), None
-            )
+            def do_dump(data):
+                dialog = Gtk.FileChooserNative.new(
+                    _("Save dumped block..."),
+                    self.window,
+                    Gtk.FileChooserAction.SAVE,
+                    _('_Save'), None
+                )
 
-            response = dialog.run()
-            fn = dialog.get_filename()
-            dialog.destroy()
-
-            if response == Gtk.ResponseType.ACCEPT:
-                with open(fn, 'wb') as f:
-                    f.write(data)
+                response = dialog.run()
+                fn = dialog.get_filename()
+                dialog.destroy()
+
+                if response == Gtk.ResponseType.ACCEPT:
+                    with open(fn, 'wb') as f:
+                        f.write(data)
+
+            self.global_state_controller.dump(active_rows[0].get_indices()[0], do_dump)
 
     # VARIABLES VIEW
 
     def on_variables_reload_clicked(self, *args):
         self.variable_controller.sync()
 
     def on_variables_load1_clicked(self, *args):
         if self.context.is_project_loaded():
             self.variable_controller.load(1, self.context.get_project_debugger_dir())
+            self.variable_controller.sync()
 
     def on_variables_load2_clicked(self, *args):
         if self.context.is_project_loaded():
             self.variable_controller.load(2, self.context.get_project_debugger_dir())
+            self.variable_controller.sync()
 
     def on_variables_load3_clicked(self, *args):
         if self.context.is_project_loaded():
             self.variable_controller.load(3, self.context.get_project_debugger_dir())
+            self.variable_controller.sync()
 
     def on_variables_save1_clicked(self, *args):
         if self.context.is_project_loaded():
             self.variable_controller.save(1, self.context.get_project_debugger_dir())
 
     def on_variables_save2_clicked(self, *args):
         if self.context.is_project_loaded():
@@ -1070,43 +1094,49 @@
         self.rom_was_loaded = False
 
     def load_rom(self):
         try:
             # Unload old ROM first
             if self.rom_was_loaded:
                 self.uninit_project()
-            self.ssb_fm = SsbFileManager(self.context, self.debugger)
+            self.ssb_fm = SsbFileManager(self.context)
             fn = self.context.get_rom_filename()
-            self.breakpoint_manager = BreakpointManager(
-                os.path.join(self.context.get_project_debugger_dir(), f'{os.path.basename(fn)}.breakpoints.json'),
-                self.ssb_fm
+            emulator_debug_init_breakpoint_manager(
+                os.path.join(self.context.get_project_debugger_dir(), f'{os.path.basename(fn)}.breakpoints.json')
             )
             # Immediately save, because the module packs the ROM differently.
             self.context.save_rom()
             rom_data = self.context.get_static_data()
             if self.debugger:
-                self.debugger.enable(rom_data, self.ssb_fm, self.breakpoint_manager,
-                                     self.on_ground_engine_start)
+                fl1 = []
+                fl2 = []
+                for i in range(0, 12):
+                    fl1.append(self.builder.get_object(f"chk_debug_flag_1_{i}").get_active())
+                for j in range(0, 16):
+                    fl2.append(self.builder.get_object(f"chk_debug_flag_2_{j}").get_active())
+                self.debugger.enable(
+                    rom_data, self.ssb_fm, self.on_ground_engine_start,
+                    debug_mode=self.builder.get_object('debug_settings_debug_mode').get_active(),
+                    debug_flag_1=fl1, debug_flag_2=fl2
+                )
             self.init_file_tree()
             self.global_state_controller.init(rom_data)
             self.variable_controller.init(rom_data)
             self.local_variable_controller.init(rom_data)
-            self.editor_notebook.init(self.ssb_fm, self.breakpoint_manager, rom_data)
+            self.editor_notebook.init(self.ssb_fm, rom_data)
             self.rom_was_loaded = True
         except BaseException as ex:
             self.context.display_error(
                 sys.exc_info(),
                 f"Unable to load: {self.context.get_rom_filename()}\n{ex}"
             )
             self.ssb_fm = None
-            self.breakpoint_manager = None
         else:
             self.enable_editing_features()
-            if self.emu_thread:
-                self.enable_debugging_features()
+            self.enable_debugging_features()
             self.emu_stop()
 
     def enable_editing_features(self):
         code_editor_main: Gtk.Box = self.builder.get_object('code_editor_main')
         code_editor_notebook: Gtk.Notebook = self.builder.get_object('code_editor_notebook')
         code_editor_main.remove(self.builder.get_object('main_label'))
         code_editor_main.pack_start(code_editor_notebook, True, True, 0)
@@ -1145,21 +1175,26 @@
         #self._set_sensitve("variables_load3", on_off)
         #self._set_sensitve("variables_notebook_parent", on_off)
         self._set_sensitve("ground_state_files_tree_sw", on_off)
         self._set_sensitve("ground_state_entities_tree_sw", on_off)
         self._set_sensitve("macro_variables_sw", on_off)
         self._set_sensitve("local_variables_sw", on_off)
 
-    def load_debugger_state(self, breaked_for: ScriptRuntimeStruct = None, file_state: BreakpointFileState = None):
+    def load_debugger_state(
+            self,
+            breaked_for: Optional[ScriptRuntimeStruct] = None,
+            file_state: Optional[BreakpointFileState] = None,
+            local_vars_values: Optional[Sequence[int]] = None
+    ):
         self.toggle_paused_debugging_features(True)
         # Load Ground State
         self.ground_state_controller.sync(self.editor_notebook, breaked_for)
         # This will show the local and macro variables
-        if breaked_for and file_state:
-            self.local_variable_controller.sync(breaked_for, file_state)
+        if local_vars_values and file_state:
+            self.local_variable_controller.sync(local_vars_values, file_state)
         else:
             self.local_variable_controller.disable()
 
     def savestate(self, i: int):
         """Save both the emulator state and the ground engine state to files."""
         if not self.context.is_project_loaded():
             return
@@ -1173,16 +1208,15 @@
             ground_engine_savestate_path = os.path.join(
                 self.context.get_project_debugger_dir(), f'{rom_basename}.save.{i}.{SAVESTATE_EXT_GROUND_ENGINE}'
             )
 
             with open_utf8(ground_engine_savestate_path, 'w') as f:
                 assert self.debugger
                 json.dump(self.debugger.ground_engine_state.serialize(), f)  # type: ignore
-            assert self.emu_thread
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.savestate.save_file(desmume_savestate_path))  # type: ignore
+            emulator_savestate_save_file(desmume_savestate_path)
         except BaseException as err:
             self.context.display_error(
                 sys.exc_info(),
                 str(err),
                 _("Unable to save savestate!")
             )
             return
@@ -1195,25 +1229,24 @@
         desmume_savestate_path = os.path.join(
             self.context.get_project_debugger_dir(), f'{rom_basename}.save.{i}.{SAVESTATE_EXT_DESUME}'
         )
         ground_engine_savestate_path = os.path.join(
             self.context.get_project_debugger_dir(), f'{rom_basename}.save.{i}.{SAVESTATE_EXT_GROUND_ENGINE}'
         )
 
-        assert self.emu_thread
         assert self.debugger
         if os.path.exists(ground_engine_savestate_path):
             try:
-                was_running = threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.is_running())  # type: ignore
+                was_running = emulator_is_running()
                 self._stopped = False
                 self.emu_reset()
-                threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.savestate.load_file(desmume_savestate_path))  # type: ignore
+                emulator_savestate_load_file(desmume_savestate_path)
                 with open_utf8(ground_engine_savestate_path, 'r') as f:
                     self.debugger.ground_engine_state.deserialize(json.load(f))  # type: ignore
-                self.emu_is_running = threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.is_running())  # type: ignore
+                self.emu_is_running = emulator_is_running()
                 self.load_debugger_state()
                 self.variable_controller.sync()
                 if was_running:
                     self._set_buttons_running()
                 else:
                     self._set_buttons_paused()
             except BaseException as ex:
@@ -1242,96 +1275,124 @@
             emu_x = SCREEN_WIDTH - 1
 
         if emu_y < 9:
             emu_y = 0
         elif emu_y > SCREEN_HEIGHT:
             emu_y = SCREEN_HEIGHT
 
-        threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.input.touch_set_pos(int(emu_x), int(emu_y)))
+        emulator_touch_set_pos(int(emu_x), int(emu_y))
 
     def lookup_key(self, keyval):
-        key = False
-        for i in range(0, Keys.NB_KEYS):
+        key = 0
+        for i in range(0, EmulatorKeys.NB_KEYS):
             if keyval == self._keyboard_cfg[i]:
-                key = keymask(i + 1)
+                key = emulator_keymask(i + 1)
                 break
         return key
 
     def emu_reset(self):
-        if self.emu_thread:
-            if self.breakpoint_state:
-                self.breakpoint_state.fail_hard()
-            if self.debugger.ground_engine_state:
-                self.debugger.ground_engine_state.reset(fully=True)
-            try:
-                lang = self.settings.get_emulator_language()
-                if lang:
-                    threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.set_language(lang))
-                threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.open(self.context.get_rom_filename()))
-                self.emu_is_running = threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.is_running())
-            except RuntimeError:
-                self.context.display_error(
-                    sys.exc_info(),
-                    f"Emulator failed to load: {self.context.get_rom_filename()}"
-                )
+        if self.breakpoint_state:
+            self.breakpoint_state.fail_hard()
+        loaded_overl_grp1_addr = 0
+        script_vars_addr = 0
+        script_vars_local_addr = 0
+        global_script_var_values = 0
+        game_state_values = 0
+        language_info_data = 0
+        game_mode = 0
+        debug_special_episode_number = 0
+        notify_note = 0
+        if self.debugger and self.debugger.ground_engine_state:
+            self.debugger.ground_engine_state.reset(fully=True)
+            assert self.debugger.rom_data is not None
+            arm9data = self.debugger.rom_data.bin_sections.arm9.data
+            ramdata = self.debugger.rom_data.bin_sections.ram.data
+            loaded_overl_grp1_addr = arm9data.LOADED_OVERLAY_GROUP_1.absolute_address
+            script_vars_addr = arm9data.SCRIPT_VARS.absolute_address
+            script_vars_local_addr = arm9data.SCRIPT_VARS_LOCALS.absolute_address
+
+            global_script_var_values = ramdata.SCRIPT_VARS_VALUES.absolute_address
+            game_state_values = arm9data.GAME_STATE_VALUES.absolute_address
+            language_info_data = arm9data.LANGUAGE_INFO_DATA.absolute_address
+            game_mode = arm9data.GAME_MODE.absolute_address
+            debug_special_episode_number = ramdata.DEBUG_SPECIAL_EPISODE_NUMBER.absolute_address
+            notify_note = arm9data.NOTIFY_NOTE.absolute_address
+        try:
+            lang = self.settings.get_emulator_language()
+            if lang:
+                emulator_set_language(lang)
+            emulator_open_rom(
+                self.context.get_rom_filename(),
+
+                address_loaded_overlay_group_1=u32(loaded_overl_grp1_addr),
+                global_variable_table_start_addr=u32(script_vars_addr),
+                local_variable_table_start_addr=u32(script_vars_local_addr),
+                global_script_var_values=u32(global_script_var_values),
+                game_state_values=u32(game_state_values),
+                language_info_data=u32(language_info_data),
+                game_mode=u32(game_mode),
+                debug_special_episode_number=u32(debug_special_episode_number),
+                notify_note=u32(notify_note),
+            )
+            self.emu_is_running = emulator_is_running()
+        except RuntimeError:
+            self.context.display_error(
+                sys.exc_info(),
+                f"Emulator failed to load: {self.context.get_rom_filename()}"
+            )
 
-    def emu_resume(self, state_type=BreakpointStateType.RESUME, step_manual_addr=None):
+    def emu_resume(self, state_type=BreakpointStateType.Resume, step_manual_addr=None):
         """Resume the emulator. If the debugger is currently breaked, the state will transition to state_type."""
         self._stopped = False
         self.toggle_paused_debugging_features(False)
         self.clear_info_bar()
-        if self.emu_thread:
-            self._set_buttons_running()
-            if not self._emu_is_running:
-                threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.resume())
-            if self.breakpoint_state and state_type == BreakpointStateType.STEP_MANUAL:
-                self.breakpoint_state.step_manual(step_manual_addr)
-            elif self.breakpoint_state:
-                self.breakpoint_state.transition(state_type)
-            else:
-                threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.input.keypad_update(0))
-                self.emu_thread.register_main_loop()
-            self.emu_is_running = True
+        self._set_buttons_running()
+        if not self._emu_is_running:
+            emulator_resume()
+        if self.breakpoint_state and state_type == BreakpointStateType.StepManual:
+            self.breakpoint_state.step_manual(step_manual_addr)
+        elif self.breakpoint_state:
+            self.breakpoint_state.transition(state_type)
+        else:
+            emulator_unpress_all_keys()
+        self.emu_is_running = True
 
     def emu_stop(self):
         self._stopped = True
-        if self.emu_thread:
-            if self.breakpoint_state:
-                self.breakpoint_state.fail_hard()
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.reset())
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.pause())
-            self.emu_is_running = False
-
-            self._set_buttons_stopped()
-            self.load_debugger_state()
-            self.write_info_bar(Gtk.MessageType.WARNING, _("The game is stopped."))
+        if self.breakpoint_state:
+            self.breakpoint_state.fail_hard()
+        emulator_reset()
+        emulator_pause()
+        self.emu_is_running = False
+
+        self._set_buttons_stopped()
+        self.load_debugger_state()
+        self.write_info_bar(Gtk.MessageType.WARNING, _("The game is stopped."))
 
     def emu_pause(self):
         if self.breakpoint_state and self.breakpoint_state.is_stopped():
             # This shouldn't happen...? It would lead to an invalid state, so just return.
             return
         if self.emu_is_running:
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.pause())
+            emulator_pause()
         self.load_debugger_state()
         self.write_info_bar(Gtk.MessageType.INFO, _("The game is paused."))
 
         self._set_buttons_paused()
         self.emu_is_running = False
 
-    # Runs in emu thread
     def on_ground_engine_start(self):
         """The ground engine started"""
         # TODO: This is more a quick fix for some issue with the variable syncing.
-        threadsafe_gtk_nonblocking(lambda: self.variable_controller.sync())
+        self.variable_controller.sync()
 
-    # Runs in emu thread
     def on_ground_engine_stop(self):
         """The ground engine stopped"""
         # TODO: This is more a quick fix for some issue with the variable syncing.
-        threadsafe_gtk_nonblocking(lambda: self.variable_controller.sync())
+        self.variable_controller.sync()
 
     def on_script_added(self, ssb_path, mapname, scene_type, scene_name):
         """Handle a newly added SSB file."""
         ssb_path = ssb_path.replace(SCRIPT_DIR + '/', '')
         if scene_type == 'sse':
             branch_name = f'{mapname}_enter'
         elif scene_type == 'ssa':
@@ -1375,84 +1436,93 @@
 
     def on_script_removed(self, ssb_path):
         """Handle a SSB file removal."""
         # todo
 
     # Debug Flags Checkbox
     def on_chk_debug_flag_1_toggled(self, w):
-        self.debugger.set_debug_flag_1(int(w.get_name()[len("debug_flag_1_"):]), int(w.get_active()))
+        emulator_set_debug_flag_1(int(w.get_name()[len("chk_debug_flag_1_"):]), w.get_active())
     def on_chk_debug_flag_2_toggled(self, w):
-        self.debugger.set_debug_flag_2(int(w.get_name()[len("debug_flag_2_"):]), int(w.get_active()))
-    
-    def set_check_debug_flag_1(self, flag_id, value):
-        self.builder.get_object("chk_debug_flag_1_"+str(flag_id)).set_active(bool(value))
-    def set_check_debug_flag_2(self, flag_id, value):
-        self.builder.get_object("chk_debug_flag_2_"+str(flag_id)).set_active(bool(value))
+        emulator_set_debug_flag_2(int(w.get_name()[len("chk_debug_flag_2_"):]), w.get_active())
+
+    def set_check_debug_flag(self, var_id, flag_id, value):
+        self.builder.get_object(f"chk_debug_flag_{var_id}_{flag_id}").set_active(bool(value))
 
     def break_pulled(self, state: BreakpointState):
         """
         The DebuggerController has paused at an instruction.
         - Update reference to state object.
         - Update the main UI (info bar, emulator controls).
         - Tell the GroundStateController about the hanger, to mark it in the list.
         - Tell the code editor about which file to open and which instruction to jump to.
         - Add release hook.
         """
-        assert self.emu_thread
         assert self.ssb_fm
-        srs = state.script_struct
-        threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.volume_set(0))
+        assert self.debugger and self.debugger.rom_data
+        srs = ScriptRuntimeStruct.from_data(
+            self.debugger.rom_data,
+            state.script_runtime_struct_addr,
+            state.script_runtime_struct_mem,
+            state.script_target_slot_id
+        )
+        emulator_volume_set(0)
 
         ssb = self.debugger.ground_engine_state.loaded_ssb_files[state.hanger_id]  # type: ignore
         opcode_addr = srs.current_opcode_addr_relative
         self.breakpoint_state = state
         self._set_buttons_paused()
 
         # Build the breakpoint file state: This state object controls which source file is handling the breakpoint
         # and whether we are currently halted on a macro call
         breakpoint_file_state = BreakpointFileState(ssb.file_name, opcode_addr, state)
         breakpoint_file_state.process(
             self.ssb_fm.get(ssb.file_name), opcode_addr, self._enable_explorerscript,
             self.context.get_project_filemanager()
         )
-        state.set_file_state(breakpoint_file_state)
+        state.file_state = breakpoint_file_state
 
         self.write_info_bar(Gtk.MessageType.WARNING, f(_("The debugger is halted at {ssb.file_name}.")))
         # This will mark the hanger as being breaked:
         self.debugger.ground_engine_state.break_pulled(state)  # type: ignore
         # This will tell the code editor to refresh the debugger controls for all open editors
         self.editor_notebook.break_pulled(state)
         self.editor_notebook.focus_by_opcode_addr(ssb.file_name, opcode_addr)
-        self.load_debugger_state(srs, breakpoint_file_state)
+        self.load_debugger_state(srs, breakpoint_file_state, state.local_vars_values)
         self.debug_overlay.break_pulled()  # type: ignore
 
         state.add_release_hook(self.break_released)
 
     def step_into_macro_call(self, file_state: BreakpointFileState):
         """Step into a macro call, by simulating it via the BreakpointFileState."""
         assert self.debugger
         file_state.step_into_macro_call()
-        self.debugger.ground_engine_state.step_into_macro_call(file_state.parent)  # type: ignore
+        assert file_state.parent is not None
+        assert self.debugger.ground_engine_state is not None
+        assert self.debugger.rom_data is not None
+        self.debugger.ground_engine_state.step_into_macro_call(file_state.parent)
         self.editor_notebook.step_into_macro_call(file_state)
         self.editor_notebook.focus_by_opcode_addr(file_state.ssb_filename, file_state.opcode_addr)
-        self.load_debugger_state(
-            file_state.parent.script_struct, file_state  # type: ignore
+        srs = ScriptRuntimeStruct.from_data(
+            self.debugger.rom_data,
+            file_state.parent.script_runtime_struct_addr,
+            file_state.parent.script_runtime_struct_mem,
+            file_state.parent.script_target_slot_id
         )
+        self.load_debugger_state(srs, file_state, file_state.parent.local_vars_values)
 
     def break_released(self, state: BreakpointState):
         """
         The BreakpointState went into a resuming state (hook added via BreakpointState.add_release_hook).
         - Delete local reference to state object
         - Update the main UI (info bar, emulator controls).
         - The ground state controller and code editors have their own hooks for the releasing.
         """
-        assert self.emu_thread
         assert self.debug_overlay
         if self.global_state__audio_enabled:
-            threadsafe_emu_nonblocking(self.emu_thread, lambda: self.emu_thread.emu.volume_set(100))
+            emulator_volume_set(100)
         self.breakpoint_state = None
         self._set_buttons_running()
         self.toggle_paused_debugging_features(False)
         self.clear_info_bar()
         # This is faster than syncing the entire debugger state again.
         self.ground_state_controller.sync_break_hanger()
         self.debug_overlay.break_released()
@@ -1468,16 +1538,15 @@
         """Try to find the ssb file's scene type. if not found, returns an empty string"""
         ssb_rom_path = ssb_rom_path.replace('SCRIPT/', '')
         if ssb_rom_path in self._scene_types :
             return self._scene_types[ssb_rom_path]
         return ''
 
     def toggle_boost(self, state):
-        if self.emu_thread:
-            self.emu_thread.set_boost(state)
+        emulator_set_boost(state)
         if self.debug_overlay:
             self.debug_overlay.set_boost(state)
         if self.debugger:
             self.debugger.set_boost(state)
         if self.variable_controller:
             self.variable_controller.set_boost(state)
         if self.renderer:
@@ -1489,14 +1558,15 @@
         item_store = self._file_tree_store
         if self._search_text == "":
             item_store.foreach(self._filter__reset_row, True)
         else:
             self.builder.get_object('ssb_file_tree').collapse_all()
             item_store.foreach(self._filter__reset_row, False)
             item_store.foreach(self._filter__show_matches)
+            assert self._ssb_item_filter is not None
             self._ssb_item_filter.foreach(self._filter__expand_all_visible)
 
     def _filter__reset_row(self, model, path, iter, make_visible):
         """Change the visibility of the given row"""
         model[iter][COL_VISIBLE] = make_visible
 
     def _filter__make_path_visible(self, model, iter):
@@ -1600,35 +1670,35 @@
         info_bar.set_revealed(False)
 
     def _set_buttons_running(self):
         btn: Gtk.Button = self.builder.get_object('emulator_controls_playstop')
         if self.builder.get_object('img_play').get_parent():
             btn.remove(self.builder.get_object('img_play'))
             btn.add(self.builder.get_object('img_stop'))
-        btn: Gtk.Button = self.builder.get_object('emulator_controls_pause')
+        btn = self.builder.get_object('emulator_controls_pause')
         if self.builder.get_object('img_play2').get_parent():
             btn.remove(self.builder.get_object('img_play2'))
             btn.add(self.builder.get_object('img_pause'))
 
     def _set_buttons_stopped(self):
         btn: Gtk.Button = self.builder.get_object('emulator_controls_playstop')
         if self.builder.get_object('img_stop').get_parent():
             btn.remove(self.builder.get_object('img_stop'))
             btn.add(self.builder.get_object('img_play'))
-        btn: Gtk.Button = self.builder.get_object('emulator_controls_pause')
+        btn = self.builder.get_object('emulator_controls_pause')
         if self.builder.get_object('img_play2').get_parent():
             btn.remove(self.builder.get_object('img_play2'))
             btn.add(self.builder.get_object('img_pause'))
 
     def _set_buttons_paused(self):
         btn: Gtk.Button = self.builder.get_object('emulator_controls_pause')
         if self.builder.get_object('img_pause').get_parent():
             btn.remove(self.builder.get_object('img_pause'))
             btn.add(self.builder.get_object('img_play2'))
-        btn: Gtk.Button = self.builder.get_object('emulator_controls_playstop')
+        btn = self.builder.get_object('emulator_controls_playstop')
         if self.builder.get_object('img_play').get_parent():
             btn.remove(self.builder.get_object('img_play'))
             btn.add(self.builder.get_object('img_stop'))
 
     def _show_are_you_sure_delete(self, text):
         dialog: Gtk.MessageDialog = self.context.message_dialog_cls()(
             self.window,
```

## skytemple_ssb_debugger/controller/script_editor.py

```diff
@@ -11,29 +11,32 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-import locale
+from __future__ import annotations
 import logging
 import os
 import re
 import webbrowser
 from functools import partial
-from typing import Tuple, List, Optional, TYPE_CHECKING, Callable, Dict
+from typing import Tuple, List, Optional, TYPE_CHECKING, Callable, Dict, Iterable
 
 from gi.repository import GtkSource, Gtk
 from gi.repository.GtkSource import LanguageManager
 from gtkspellcheck import SpellChecker
 
 from explorerscript.error import ParseError
 from explorerscript.ssb_converting.ssb_data_types import SsbRoutineType
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
+from skytemple_ssb_emulator import emulator_debug_breakpoints_resync, emulator_debug_breakpoint_add, \
+    emulator_debug_breakpoint_remove, emulator_breakpoints_get_saved_in_ram_for
+
 from skytemple_ssb_debugger.model.completion.calltips.calltip_emitter import CalltipEmitter
 from skytemple_ssb_debugger.model.completion.calltips.string_event_emitter import StringEventEmitter
 from skytemple_ssb_debugger.model.completion.constants import GtkSourceCompletionSsbConstants
 from skytemple_ssb_debugger.model.completion.exps_statements import GtkSourceCompletionExplorerScriptStatements
 from skytemple_ssb_debugger.model.completion.functions import GtkSourceCompletionSsbFunctions
 from skytemple_ssb_debugger.model.completion.util import filter_special_exps_opcodes
 from skytemple_ssb_debugger.model.constants import ICON_ACTOR, ICON_OBJECT, ICON_PERFORMER, ICON_GLOBAL_SCRIPT
@@ -99,16 +102,16 @@
         self._ssb_script_search: Gtk.SearchEntry = None
         self._explorerscript_search: Gtk.SearchEntry = None
         self._ssb_script_search_context: GtkSource.SearchContext = None
         self._explorerscript_search_context: GtkSource.SearchContext = None
         self._saving_dialog: Optional[Gtk.Dialog] = None
 
         self._still_loading = True
-        self._foucs_opcode_after_load = None
-        self._on_break_pulled_after_load = None
+        self._foucs_opcode_after_load: Optional[Tuple[str, int]] = None
+        self._on_break_pulled_after_load: Optional[Tuple[str, int, bool]] = None
         self._hanger_halt_lines_after_load: Optional[Tuple[str, List[Tuple[SsbRoutineType, int, int]]]] = None
         self._spellchecker_loaded = False
 
         self._loaded_search_window: Optional[Gtk.Dialog] = None
         self._active_search_context: Optional[GtkSource.SearchContext] = None
 
         self._mrk_attrs__breakpoint: GtkSource.MarkAttributes = GtkSource.MarkAttributes.new()
@@ -240,30 +243,30 @@
                 )
 
     def save(self):
         """
         Save the script file. As a constraint only the ssbs or exps views should be editable, so in theory only one can
         have changes... - we save that one!
         """
-        modified_buffer = None
+        modified_buffer: GtkSource.Buffer
         save_exps = False
         save_text = None
 
         if not self._explorerscript_active and self._ssb_script_view.get_buffer().get_modified():
-            modified_buffer: GtkSource.Buffer = self._ssb_script_view.get_buffer()
+            modified_buffer = self._ssb_script_view.get_buffer()
             save_exps = False
             save_text = modified_buffer.props.text
         elif self._explorerscript_view.get_buffer().get_modified():
-            modified_buffer: GtkSource.Buffer = self._explorerscript_view.get_buffer()
+            modified_buffer = self._explorerscript_view.get_buffer()
             save_exps = True
             save_text = modified_buffer.props.text
         if not save_text:
             return
 
-        self._saving_dialog: Gtk.Dialog = self.builder.get_object('file_saving_dialog')
+        self._saving_dialog = self.builder.get_object('file_saving_dialog')
         self._saving_dialog.set_transient_for(self._main_window)
         self.builder.get_object('file_saving_dialog_label').set_label(
             f(_('Compiling script "{self.filename}"...'))
         )
 
         self.file_context.save(save_text=save_text,
                                save_exps=save_exps,
@@ -305,15 +308,16 @@
             if len(marks) > 0:
                 for ssb_filename, opcode_offset in EditorTextMarkUtil.get_tmp_opcodes_in_line(modified_buffer, line):
                     if ssb_filename not in breakpoints_to_resync:
                         breakpoints_to_resync[ssb_filename] = []
                     breakpoints_to_resync[ssb_filename].append(opcode_offset)
 
         for ssb_filename, b_points in breakpoints_to_resync.items():
-            self.file_context.breakpoint_manager.resync(ssb_filename, b_points)
+            assert self.parent.file_manager is not None
+            emulator_debug_breakpoints_resync(ssb_filename, b_points, self.parent.file_manager.get(ssb_filename))
 
     def load_views(self, ssbs_bx: Gtk.Box, exps_bx: Optional[Gtk.Box]):
         self._activate_spinner(ssbs_bx)
         if exps_bx:
             self._activate_spinner(exps_bx)
 
         (ssbs_ovl, self._ssb_script_view, self._ssb_script_revealer,
@@ -399,21 +403,22 @@
             self.on_break_pulled(*self._on_break_pulled_after_load)
         if self._hanger_halt_lines_after_load:
             self.insert_hanger_halt_lines(*self._hanger_halt_lines_after_load)
 
     def add_breakpoint(self, line_number: int, view: GtkSource.View):
         buffer: Gtk.TextBuffer = view.get_buffer()
         for ssb_filename, opcode_offset in EditorTextMarkUtil.get_opcodes_in_line(buffer, line_number - 1):
-            self.file_context.breakpoint_manager.add(ssb_filename, opcode_offset)
+            emulator_debug_breakpoint_add(ssb_filename, opcode_offset)
 
     def remove_breakpoint(self, mark: GtkSource.Mark):
         ssb_filename, opcode_offset = EditorTextMarkUtil.extract_opcode_data_from_line_mark(mark)
-        self.file_context.breakpoint_manager.remove(ssb_filename, opcode_offset)
+        emulator_debug_breakpoint_remove(ssb_filename, opcode_offset)
 
     def on_breakpoint_added(self, ssb_filename, opcode_offset, also_update_explorerscript=True):
+        view_list: Iterable[GtkSource.View]
         if also_update_explorerscript:
             view_list = (self._ssb_script_view, self._explorerscript_view)
         else:
             view_list = (self._ssb_script_view, )
         for view in view_list:
             buffer: GtkSource.Buffer = view.get_buffer()
             EditorTextMarkUtil.add_breakpoint_line_mark(buffer, ssb_filename, opcode_offset, 'breakpoint')
@@ -437,15 +442,15 @@
 
             # Remove all regular text marks and rename temporary
             # Only do this, if we are actively waiting for a reload, because only then, the breakpoint markers exist.
             if self._waiting_for_reload:
                 EditorTextMarkUtil.switch_to_new_op_marks(buffer, ssb_filename)
 
         # Re-add all breakpoints
-        for opcode_offset in self.file_context.breakpoint_manager.saved_in_rom_get_for(ssb_filename):
+        for opcode_offset in emulator_breakpoints_get_saved_in_ram_for(ssb_filename):
             self.on_breakpoint_added(ssb_filename, opcode_offset)
 
     def insert_opcode_text_mark(self, is_exps: bool, ssb_filename: str,
                                 opcode_offset: int, line: int, column: int, is_temp: bool, is_for_macro_call=False):
         view = self._ssb_script_view
         if is_exps:
             view = self._explorerscript_view
@@ -454,15 +459,15 @@
         )
 
     # Signal & event handlers
     def on_ssbs_state_change(self, breakable, ram_state_up_to_date):
         """Fully rebuild the active info bar message based on the current state of the SSB."""
         info_bar: Gtk.InfoBar = self.builder.get_object('code_editor_box_ssbscript_bar')
         if self._explorerscript_active:
-            info_bar: Gtk.InfoBar = self.builder.get_object('code_editor_box_es_bar')
+            info_bar = self.builder.get_object('code_editor_box_es_bar')
 
         if not breakable:
             self._refill_info_bar(
                 info_bar, Gtk.MessageType.WARNING,
                 _("An old version of this script is still loaded in RAM, but breakpoints are not available.\n"
                   "Debugging is disabled for this file, until it is reloaded.")
             )
@@ -743,15 +748,15 @@
         widget = self._active_view()
         # REPLACE
         if not self._loaded_search_window:
             self._active_search_context = self._explorerscript_search_context
             if widget == self._ssb_script_view:
                 self._active_search_context = self._ssb_script_search_context
             search_settings: GtkSource.SearchSettings = self._active_search_context.get_settings()
-            self._loaded_search_window: Gtk.Dialog = self.builder.get_object('sr_dialog')
+            self._loaded_search_window = self.builder.get_object('sr_dialog')
             self.builder.get_object('sr_search_setting_case_sensitive').set_active(
                 search_settings.get_case_sensitive())
             self.builder.get_object('sr_search_setting_match_words').set_active(
                 search_settings.get_at_word_boundaries())
             self.builder.get_object('sr_search_setting_regex').set_active(search_settings.get_regex_enabled())
             self.builder.get_object('sr_search_setting_wrap_around').set_active(search_settings.get_wrap_around())
             self._loaded_search_window.set_title(f(_('Search and Replace in {self.filename}')))
@@ -876,29 +881,40 @@
 
     def _load_ssbs_completion(self):
         view = self._ssb_script_view
         completion: GtkSource.Completion = view.get_completion()
 
         completion.add_provider(GtkSourceCompletionSsbConstants(self.rom_data))
         completion.add_provider(GtkSourceCompletionSsbFunctions(self.rom_data.script_data.op_codes))
-        CalltipEmitter(self._ssb_script_view, self.rom_data.script_data.op_codes,
-                       self.mapname, *self.file_context.get_scene_name_and_type(), self.parent.get_context(), is_ssbs=True)
+        CalltipEmitter(
+            self._ssb_script_view,
+            self.rom_data.script_data.op_codes,
+            self.mapname,  # type: ignore
+            *self.file_context.get_scene_name_and_type(),  # type: ignore
+            self.parent.get_context(),
+            is_ssbs=True
+        )
         StringEventEmitter(self._ssb_script_view, self.parent.get_context())
 
     def _load_explorerscript_completion(self):
         view = self._explorerscript_view
         completion: GtkSource.Completion = view.get_completion()
 
         completion.add_provider(GtkSourceCompletionSsbConstants(self.rom_data))
         completion.add_provider(GtkSourceCompletionSsbFunctions(
             filter_special_exps_opcodes(self.rom_data.script_data.op_codes)
         ))
         completion.add_provider(GtkSourceCompletionExplorerScriptStatements())
-        CalltipEmitter(self._explorerscript_view, self.rom_data.script_data.op_codes,
-                       self.mapname, *self.file_context.get_scene_name_and_type(), self.parent.get_context())
+        CalltipEmitter(
+            self._explorerscript_view,
+            self.rom_data.script_data.op_codes,
+            self.mapname,  # type: ignore
+            *self.file_context.get_scene_name_and_type(),  # type: ignore
+            self.parent.get_context()
+        )
         StringEventEmitter(self._explorerscript_view, self.parent.get_context())
 
     def _update_view_editable_state(self):
         """Update which view is editable based on self._explorerscript_active"""
         if self._explorerscript_active:
             # Enable ES editing
             self._explorerscript_view.set_editable(True)
```

## skytemple_ssb_debugger/controller/variable.py

```diff
@@ -10,132 +10,127 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import json
+import logging
 import math
 import os
 import sys
 from functools import partial
-from threading import Lock
-from typing import Optional, List, Dict
+from typing import Optional, List, Dict, Mapping, Sequence
 
 import gi
 
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptGameVar, GameVariableType
 from skytemple_files.common.util import open_utf8
+from skytemple_ssb_emulator import emulator_register_script_variable_set, emulator_unregister_script_variable_set, \
+    emulator_write_game_variable, emulator_sync_vars
+
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.game_variable import GameVariable
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu_nonblocking, threadsafe_gtk_nonblocking, synchronized, \
-    threadsafe_emu
 from skytemple_files.common.i18n_util import f, _
 
 gi.require_version('Gtk', '3.0')
 
 from gi.repository import Gtk
 
-
-variables_lock = Lock()
+logger = logging.getLogger(__name__)
 
 
 class VariableController:
     CATEGORIES = {
         _('Scenario'): ['SCENARIO_MAIN', 'SCENARIO_MAIN_BIT_FLAG', 'SCENARIO_TALK_BIT_FLAG', 'SCENARIO_SIDE',
                         'SCENARIO_SUB1', 'SCENARIO_SUB2', 'SCENARIO_SUB3', 'SCENARIO_SUB4', 'SCENARIO_SUB5',
                         'SCENARIO_SUB6', 'SCENARIO_SUB7', 'SCENARIO_SUB8', 'SCENARIO_BALANCE_FLAG',
                         'COMPULSORY_SAVE_POINT', 'COMPULSORY_SAVE_POINT_SIDE', 'PERFORMANCE_PROGRESS_LIST',
                         'SCENARIO_BALANCE_DEBUG'],
         _('Init'): ['SCENARIO_SELECT', 'GROUND_ENTER', 'GROUND_ENTER_LINK', 'GROUND_GETOUT', 'GROUND_MAP',
                     'GROUND_PLACE', 'GROUND_START_MODE'],
-        _('Dungeon Progress'): ['DUNGEON_OPEN_LIST', 'DUNGEON_ENTER_LIST', 'DUNGEON_ARRIVE_LIST', 'DUNGEON_CONQUEST_LIST',
+        _('Dungeon Progress'): ['DUNGEON_OPEN_LIST', 'DUNGEON_ENTER_LIST', 'DUNGEON_ARRIVE_LIST',
+                                'DUNGEON_CONQUEST_LIST',
                                 'DUNGEON_PRESENT_LIST', 'DUNGEON_REQUEST_LIST'],
         _('Dungeon Init'): ['DUNGEON_SELECT', 'DUNGEON_ENTER', 'DUNGEON_ENTER_MODE', 'DUNGEON_ENTER_INDEX',
                             'DUNGEON_ENTER_FREQUENCY', 'DUNGEON_RESULT'],
         _('World Map'): ['WORLD_MAP_MARK_LIST_NORMAL', 'WORLD_MAP_MARK_LIST_SPECIAL', 'WORLD_MAP_LEVEL'],
         _('Specific'): ['SIDE02_TALK', 'SIDE06_ROOM', 'SIDE08_BOSS2ND', 'SIDE01_BOSS2ND',
-                        'CRYSTAL_COLOR_01', 'CRYSTAL_COLOR_02', 'CRYSTAL_COLOR_03', 'EVENT_LOCAL', 'DUNGEON_EVENT_LOCAL',
+                        'CRYSTAL_COLOR_01', 'CRYSTAL_COLOR_02', 'CRYSTAL_COLOR_03', 'EVENT_LOCAL',
+                        'DUNGEON_EVENT_LOCAL',
                         'BIT_FUWARANTE_LOCAL', 'LOTTERY_RESULT', 'SUB30_TREASURE_DISCOVER', 'SUB30_SPOT_DISCOVER',
                         'SUB30_SPOT_LEVEL', 'SUB30_PROJECTP'],
         _('Player'): ['PLAYER_KIND', 'ATTENDANT1_KIND', 'ATTENDANT2_KIND', 'CARRY_GOLD', 'BANK_GOLD',
                       'HERO_FIRST_KIND', 'HERO_FIRST_NAME', 'PARTNER_FIRST_KIND', 'PARTNER_FIRST_NAME',
                       'HERO_TALK_KIND', 'PARTNER_TALK_KIND', 'RANDOM_REQUEST_NPC03_KIND', 'CONFIG_COLOR_KIND',
-                     ],
+                      ],
         _('Mode'): ['GAME_MODE', 'EXECUTE_SPECIAL_EPISODE_TYPE', 'SPECIAL_EPISODE_TYPE', 'SPECIAL_EPISODE_OPEN',
                     'SPECIAL_EPISODE_OPEN_OLD', 'SPECIAL_EPISODE_CONQUEST'],
         _('Backup'): ['SCENARIO_SELECT_BACKUP', 'SCENARIO_MAIN_BIT_FLAG_BACKUP', 'GROUND_ENTER_BACKUP',
                       'GROUND_ENTER_LINK_BACKUP', 'GROUND_GETOUT_BACKUP', 'GROUND_MAP_BACKUP', 'GROUND_PLACE_BACKUP',
                       'DUNGEON_ENTER_BACKUP', 'DUNGEON_ENTER_MODE_BACKUP', 'DUNGEON_ENTER_INDEX_BACKUP',
                       'DUNGEON_ENTER_FREQUENCY_BACKUP', 'DUNGEON_RESULT_BACKUP', 'GROUND_START_MODE_BACKUP',
                       'PLAYER_KIND_BACKUP', 'ATTENDANT1_KIND_BACKUP', 'ATTENDANT2_KIND_BACKUP',
-                     'ITEM_BACKUP', 'ITEM_BACKUP_KUREKURE', 'ITEM_BACKUP_TAKE', 'ITEM_BACKUP_GET'],
+                      'ITEM_BACKUP', 'ITEM_BACKUP_KUREKURE', 'ITEM_BACKUP_TAKE', 'ITEM_BACKUP_GET'],
         _('Misc'): ['VERSION', 'CONDITION', 'ROM_VARIATION', 'LANGUAGE_TYPE',
-                 'FRIEND_SUM', 'UNIT_SUM',
-                 'POSITION_X', 'POSITION_Y', 'POSITION_HEIGHT', 'POSITION_DIRECTION',
-                 'STATION_ITEM_STATIC', 'STATION_ITEM_TEMP', 'DELIVER_ITEM_STATIC', 'DELIVER_ITEM_TEMP',
-                 'REQUEST_CLEAR_COUNT', 'REQUEST_THANKS_RESULT_KIND', 'REQUEST_THANKS_RESULT_VARIATION',
-                 'RECYCLE_COUNT', 'TEAM_RANK_EVENT_LEVEL', 'PLAY_OLD_GAME', 'NOTE_MODIFY_FLAG'],
+                    'FRIEND_SUM', 'UNIT_SUM',
+                    'POSITION_X', 'POSITION_Y', 'POSITION_HEIGHT', 'POSITION_DIRECTION',
+                    'STATION_ITEM_STATIC', 'STATION_ITEM_TEMP', 'DELIVER_ITEM_STATIC', 'DELIVER_ITEM_TEMP',
+                    'REQUEST_CLEAR_COUNT', 'REQUEST_THANKS_RESULT_KIND', 'REQUEST_THANKS_RESULT_VARIATION',
+                    'RECYCLE_COUNT', 'TEAM_RANK_EVENT_LEVEL', 'PLAY_OLD_GAME', 'NOTE_MODIFY_FLAG'],
     }
 
-    def __init__(self, emu_thread: Optional[EmulatorThread], builder: Gtk.Builder, context: AbstractDebuggerControlContext):
+    def __init__(self, builder: Gtk.Builder, context: AbstractDebuggerControlContext):
         super().__init__()
-        self.emu_thread = emu_thread
         self.builder = builder
         self.context = context
         self.rom_data: Optional[Pmd2Data] = None
         self.var_form_elements: Optional[List[Optional[List[Optional[Gtk.Widget]]]]] = None
         self._suppress_events = False
         self._boost = False
         # Cached variable values
         self._variable_cache: Dict[Pmd2ScriptGameVar, List[int]] = {}
+        self._pending_sync = False
 
         self.variables_changed_but_not_saved = False
 
     def sync(self):
         """Manual force sync of all variables"""
-        if not self.emu_thread:
-            return
+
+        def update(vals: Mapping[int, Sequence[int]]):
+            self._pending_sync = False
+            assert self.rom_data is not None
+            self._variable_cache = {
+                self.rom_data.script_data.game_variables__by_id[k]: list(v) for k, v in vals.items()
+            }
+            self._apply_sync()
+
+        self._pending_sync = True
         notebook: Gtk.Notebook = self.builder.get_object('variables_notebook')
         notebook.set_sensitive(False)
-        threadsafe_emu_nonblocking(self.emu_thread, self._do_sync)
+        emulator_sync_vars(update)
 
-    # RUNNING IN EMULATOR THREAD:
-    @synchronized(variables_lock)
-    def _do_sync(self):
-        for var in self.rom_data.script_data.game_variables:
-            var_values = []
-            for offset in range(0, var.nbvalues):
-                if not var.is_local:
-                    _, val = GameVariable.read(self.emu_thread.emu.memory, self.rom_data, var.id, offset)
-                    var_values.append(val)
-            self._variable_cache[self.rom_data.script_data.game_variables__by_id[var.id]] = var_values
-        threadsafe_gtk_nonblocking(self._do_sync_gtk)
-
-    @synchronized(variables_lock)
-    def _do_sync_gtk(self):
+    def _apply_sync(self):
         self._suppress_events = True
+        assert self.var_form_elements is not None and self.rom_data is not None
         for i, sub in enumerate(self.var_form_elements):
             if sub is not None:
                 for offset, el in enumerate(sub):
                     if el is not None:
                         val = self._variable_cache[self.rom_data.script_data.game_variables__by_id[i]][offset]
                         if isinstance(el, Gtk.Entry):
                             el.set_text(str(val))
                         else:
                             el.set_active(bool(val))
         self.builder.get_object('variables_notebook').set_sensitive(True)
         self._suppress_events = False
 
     def init(self, rom_data: Pmd2Data):
-        if not self.emu_thread:
-            return
         self.rom_data = rom_data
         self.var_form_elements = [None for _ in range(0, len(rom_data.script_data.game_variables))]
         notebook: Gtk.Notebook = self.builder.get_object('variables_notebook')
 
         # Build the GTK form
         for category, items in self.CATEGORIES.items():
             tab_label = Gtk.Label.new(category)
@@ -182,40 +177,29 @@
                     for i in range(0, var.nbvalues):
                         sub_box.pack_start(self.create_var_form_element(var, i), True, True, 0)
                 row += 2
 
         notebook.show_all()
         self.sync()
 
-        if self.emu_thread:
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_exec(  # type: ignore
-                self.rom_data.bin_sections.arm9.functions.SaveScriptVariableValue.absolute_address,  # type: ignore
-                self.hook__variable_set
-            ))
-            threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_exec(  # type: ignore
-                self.rom_data.bin_sections.arm9.functions.SaveScriptVariableValueAtIndex.absolute_address,  # type: ignore
-                self.hook__variable_set_with_offset
-            ))
+        emulator_register_script_variable_set(
+            self.rom_data.bin_sections.arm9.functions.SaveScriptVariableValue.absolute_addresses,
+            self.rom_data.bin_sections.arm9.functions.SaveScriptVariableValueAtIndex.absolute_addresses,
+            self.hook__variable_set
+        )
 
     def uninit(self):
         notebook: Gtk.Notebook = self.builder.get_object('variables_notebook')
         for _ in range(0, notebook.get_n_pages()):
             # TODO: Do the children need to be destroyed?
             notebook.remove_page(0)
 
-        threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_exec(
-            self.rom_data.bin_sections.arm9.functions.SaveScriptVariableValue.absolute_address,
-            None
-        ))
-        threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_exec(
-            self.rom_data.bin_sections.arm9.functions.SaveScriptVariableValueAtIndex.absolute_address,
-            None
-        ))
+        emulator_unregister_script_variable_set()
 
-    def create_var_form_element(self, var: Pmd2ScriptGameVar, offset: int, label: str = None, no_label=False):
+    def create_var_form_element(self, var: Pmd2ScriptGameVar, offset: int, label: Optional[str] = None, no_label=False):
         box: Gtk.ButtonBox = Gtk.ButtonBox.new(Gtk.Orientation.HORIZONTAL)
         box.set_margin_bottom(2)
         box.set_halign(Gtk.Align.END)
         if not no_label:
             if not label:
                 label = f'{offset}'
             else:
@@ -248,63 +232,61 @@
         box.pack_start(wgd, True, True, 0)
         self.var_form_elements[var.id][offset] = wgd  # type: ignore
         return box
 
     def on_var_changed_entry(self, var: Pmd2ScriptGameVar, offset: int, wdg: Gtk.Entry, *args):
         if self._suppress_events:
             return
-        with variables_lock:
-            self.variables_changed_but_not_saved = True
+        self.variables_changed_but_not_saved = True
+        try:
             try:
-                try:
-                    value = int(wdg.get_text())
-                except ValueError as err:
-                    raise ValueError(_("The variable must have a number as value.")) from err
-                if var.type == GameVariableType.BIT:
-                    if value < 0 or value > 1:
-                        raise ValueError("This variable must have one of these values: 0, 1.")
-                elif var.type == GameVariableType.UINT8:
-                    if value < 0 or value > 255:
-                        raise ValueError("This variable must have a value between: 0 and 255.")
-                elif var.type == GameVariableType.INT8:
-                    if value < -128 or value > 127:
-                        raise ValueError("This variable must have a value between: -128 and 127.")
-                elif var.type == GameVariableType.UINT16:
-                    if value < 0 or value > 65535:
-                        raise ValueError("This variable must have a value between: 0 and 65535.")
-                elif var.type == GameVariableType.INT16:
-                    if value < -32768 or value > 32767:
-                        raise ValueError("This variable must have a value between: -32768 and 32767.")
-                elif var.type == GameVariableType.UINT32:
-                    if value < 0 or value > 4294967295:
-                        raise ValueError("This variable must have a value between: 0 and 4294967295.")
-                elif var.type == GameVariableType.INT32:
-                    if value < -2147483648 or value > 2147483647:
-                        raise ValueError("This variable must have a value between: -2147483648 and 2147483647.")
+                value = int(wdg.get_text())
             except ValueError as err:
-                md = self.context.message_dialog_cls()(self.builder.get_object('main_window'),
-                                                       Gtk.DialogFlags.DESTROY_WITH_PARENT, Gtk.MessageType.ERROR,
-                                                       Gtk.ButtonsType.OK, f(_("Invalid variable value:\n{err}\nThe value was not written to RAM.")),
-                                                       title=_("Error!"))
-                md.set_position(Gtk.WindowPosition.CENTER)
-                md.run()
-                md.destroy()
-                return True
-            self._queue_variable_write(var.id, offset, value)
+                raise ValueError(_("The variable must have a number as value.")) from err
+            if var.type == GameVariableType.BIT:
+                if value < 0 or value > 1:
+                    raise ValueError("This variable must have one of these values: 0, 1.")
+            elif var.type == GameVariableType.UINT8:
+                if value < 0 or value > 255:
+                    raise ValueError("This variable must have a value between: 0 and 255.")
+            elif var.type == GameVariableType.INT8:
+                if value < -128 or value > 127:
+                    raise ValueError("This variable must have a value between: -128 and 127.")
+            elif var.type == GameVariableType.UINT16:
+                if value < 0 or value > 65535:
+                    raise ValueError("This variable must have a value between: 0 and 65535.")
+            elif var.type == GameVariableType.INT16:
+                if value < -32768 or value > 32767:
+                    raise ValueError("This variable must have a value between: -32768 and 32767.")
+            elif var.type == GameVariableType.UINT32:
+                if value < 0 or value > 4294967295:
+                    raise ValueError("This variable must have a value between: 0 and 4294967295.")
+            elif var.type == GameVariableType.INT32:
+                if value < -2147483648 or value > 2147483647:
+                    raise ValueError("This variable must have a value between: -2147483648 and 2147483647.")
+        except ValueError as err:
+            md = self.context.message_dialog_cls()(self.builder.get_object('main_window'),
+                                                   Gtk.DialogFlags.DESTROY_WITH_PARENT, Gtk.MessageType.ERROR,
+                                                   Gtk.ButtonsType.OK,
+                                                   f(_("Invalid variable value:\n{err}\nThe value was not written to RAM.")),
+                                                   title=_("Error!"))
+            md.set_position(Gtk.WindowPosition.CENTER)
+            md.run()
+            md.destroy()
             return True
+        self._queue_variable_write(var.id, offset, value)
+        return True
 
     def on_var_changed_check(self, var: Pmd2ScriptGameVar, offset: int, wdg: Gtk.CheckButton, *args):
         if self._suppress_events:
             return
-        with variables_lock:
-            self.variables_changed_but_not_saved = True
-            self._queue_variable_write(var.id, offset, 1 if wdg.get_active() else 0)
-            return True
+        self.variables_changed_but_not_saved = True
+        self._queue_variable_write(var.id, offset, 1 if wdg.get_active() else 0)
+        return True
 
-    @synchronized(variables_lock)
     def load(self, index: int, config_dir: str):
         # TODO: Not very efficient at the moment but ok.
         self.variables_changed_but_not_saved = False
         path = os.path.join(config_dir, f'vars.{index}.json')
         if not os.path.exists(path):
             return
         try:
@@ -318,73 +300,50 @@
             self.context.display_error(
                 sys.exc_info(),
                 str(err),
                 _("Unable to load variables!")
             )
             return
 
-    @synchronized(variables_lock)
     def save(self, index: int, config_dir: str):
         self.variables_changed_but_not_saved = False
         vars = {k.name: v for k, v in self._variable_cache.items()}
         with open_utf8(os.path.join(config_dir, f'vars.{index}.json'), 'w') as f:
             json.dump(vars, f)
 
     def _queue_variable_write(self, var_id: int, offset: int, value: int):
-        threadsafe_emu(
-            self.emu_thread, lambda: GameVariable.write(self.emu_thread.emu.memory, self.rom_data, var_id, offset, value)  # type: ignore
-        )
+        try:
+            emulator_write_game_variable(var_id, offset, value)
+        except:
+            logger.error(f"failed writing game var: {var_id}@{offset} = {value}")
+            raise
 
         # Also update the cached values
         for var in self._variable_cache.keys():
             if var.id == var_id:
                 self._variable_cache[var][offset] = value
                 break
 
-    @synchronized(variables_lock)
-    def hook__variable_set(self, address: int, size: int):
-        if self._boost:
-            return
-        var_id = self.emu_thread.emu.memory.register_arm9.r1  # type: ignore
-        if var_id >= 0x400:
+    def hook__variable_set(self, var_id, var_offset, value):
+        assert self.rom_data is not None and self.var_form_elements is not None
+        var = self.rom_data.script_data.game_variables__by_id[var_id]
+        if var not in self._variable_cache:
+            if not self._pending_sync:
+                self.sync()
             return
-        var_offset = 0
-        value_raw = self.emu_thread.emu.memory.register_arm9.r2  # type: ignore
-        # TODO: Do we need to process the raw value...?
-
-        self._variable_cache[self.rom_data.script_data.game_variables__by_id[var_id]][var_offset] = value_raw  # type: ignore
-        threadsafe_gtk_nonblocking(partial(self.hook__variable_set_gtk, var_id, var_offset, value_raw))
-
-    @synchronized(variables_lock)
-    def hook__variable_set_with_offset(self, address: int, size: int):
-        if self._boost:
-            return
-        var_id = self.emu_thread.emu.memory.register_arm9.r1  # type: ignore
-        if var_id >= 0x400:
-            return
-        var_offset = self.emu_thread.emu.memory.register_arm9.r2  # type: ignore
-        value_raw = self.emu_thread.emu.memory.register_arm9.r3  # type: ignore
-        # TODO: Do we need to process the raw value...?
-
-        self._variable_cache[self.rom_data.script_data.game_variables__by_id[var_id]][var_offset] = value_raw  # type: ignore
-        threadsafe_gtk_nonblocking(partial(self.hook__variable_set_gtk, var_id, var_offset, value_raw))
-
-    @synchronized(variables_lock)
-    def hook__variable_set_gtk(self, var_id, var_offset, value):
         self._suppress_events = True
         entry_list = self.var_form_elements[var_id]
         if entry_list is not None:
             entry = self.var_form_elements[var_id][var_offset]
             if entry is not None:
                 if isinstance(entry, Gtk.Entry):
                     entry.set_text(str(value))
                 else:
                     entry.set_active(bool(value))
         self._suppress_events = False
 
     def set_boost(self, state):
-        with variables_lock:
-            boost_before = self._boost
-            self._boost = state
+        boost_before = self._boost
+        self._boost = state
 
         if not state and boost_before:
             self.sync()
```

## skytemple_ssb_debugger/model/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/model/breakpoint_file_state.py

```diff
@@ -10,23 +10,24 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import os
 from typing import Optional, Union, Dict, TYPE_CHECKING
 
 from explorerscript.source_map import MacroSourceMapping
 from skytemple_files.common.project_file_manager import ProjectFileManager
 from skytemple_ssb_debugger.model.ssb_files.file import SsbLoadedFile
 
 if TYPE_CHECKING:
-    from skytemple_ssb_debugger.model.breakpoint_state import BreakpointState
+    from skytemple_ssb_emulator import BreakpointState
 
 
 class BreakpointFileState:
     """
     Additional information about the debugger state, when halted (eg. if halted on maco and the source file that
     is stopped in).
```

## skytemple_ssb_debugger/model/constants.py

```diff
@@ -11,14 +11,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 
 
 ICON_ACTOR = 'skytemple-e-actor-symbolic'
 ICON_OBJECT = 'skytemple-e-object-symbolic'
 ICON_PERFORMER = 'skytemple-e-performer-symbolic'
 ICON_GLOBAL_SCRIPT = 'skytemple-e-script-symbolic'
 ICON_EVENTS = 'skytemple-e-event-symbolic'
```

## skytemple_ssb_debugger/model/editor_text_mark_util.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import re
 from typing import List, Iterable, Tuple, Optional
 
 from gi.repository import GtkSource, Gtk
 
 # file, opcode offset, optional attribute
```

## skytemple_ssb_debugger/model/ground_engine_state.py

```diff
@@ -10,132 +10,142 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-import typing
+from __future__ import annotations
 import warnings
-from threading import Lock
-from typing import Optional, List, Tuple
+from itertools import chain
+from typing import Optional, List, Tuple, Iterable, Callable, cast, no_type_check
 
 from gi.repository import Gtk, GLib
+from range_typed_integers import u32
 
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
+from skytemple_ssb_emulator import emulator_register_exec_ground, emulator_register_ssb_load, \
+    emulator_register_ssx_load, emulator_register_talk_load, emulator_register_unionall_load_addr_change, \
+    emulator_unregister_ssb_load, emulator_unregister_ssx_load, emulator_unregister_talk_load, \
+    emulator_unregister_unionall_load_addr_change, emulator_unionall_load_address_update, emulator_wait_one_cycle, \
+    emulator_breakpoints_set_loaded_ssb_files, emulator_breakpoints_set_load_ssb_for
+
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
-from skytemple_ssb_debugger.model.breakpoint_state import BreakpointState
+from skytemple_ssb_emulator import BreakpointState
+
+from skytemple_ssb_debugger.model.breakpoint_file_state import BreakpointFileState
+from skytemple_ssb_debugger.model.ground_state import AbstractEntity
 from skytemple_ssb_debugger.model.ground_state.actor import Actor
 from skytemple_ssb_debugger.model.ground_state.event import Event
 from skytemple_ssb_debugger.model.ground_state.global_script import GlobalScript
 from skytemple_ssb_debugger.model.ground_state.map import Map
 from skytemple_ssb_debugger.model.ground_state.object import Object
 from skytemple_ssb_debugger.model.ground_state.performer import Performer
 from skytemple_ssb_debugger.model.ground_state.ssb_file_in_ram import SsbFileInRam
 from skytemple_ssb_debugger.model.ground_state.ssx_file_in_ram import SsxFileInRam
 from skytemple_ssb_debugger.model.ssb_files.file_manager import SsbFileManager
-from skytemple_ssb_debugger.threadsafe import threadsafe_gtk_nonblocking, threadsafe_emu, synchronized, synchronized_now
 
 TALK_HANGER_OFFSET = 3
 MAX_SSX = 3
 MAX_SSB = MAX_SSX + TALK_HANGER_OFFSET
 O11_BYTE_CHECK = bytes([0xf0, 0x4f, 0x2d, 0xe9, 0x34, 0xd0, 0x4d, 0xe2, 0x64, 0x2a, 0x9f, 0xe5])
 
 
-ground_engine_lock = Lock()
-
-
 class GroundEngineState:
-    def __init__(self, emu_thread: EmulatorThread, rom_data: Pmd2Data, print_callback, inform_ground_engine_start_cb,
-                 ssb_file_manager: SsbFileManager, context: AbstractDebuggerControlContext):
+    def __init__(
+            self,
+            rom_data: Pmd2Data,
+            print_callback: Callable[[str], None],
+            inform_ground_engine_start_cb: Callable[[], None],
+            poll_emulator: Callable[[], None],
+            ssb_file_manager: SsbFileManager,
+            context: AbstractDebuggerControlContext
+    ):
         super().__init__()
-        self.emu_thread = emu_thread
         self.rom_data = rom_data
         self.ssb_file_manager = ssb_file_manager
         self.context = context
         self.logging_enabled = False
         self._boost = False
+        self._breaked = False
 
         self.pnt_map = rom_data.bin_sections.overlay11.data.GROUND_STATE_MAP.absolute_address
         base_pnt = rom_data.bin_sections.overlay11.data.GROUND_STATE_PTRS.absolute_address
         self.pnt_main_script_struct = base_pnt
         #self.pnt_unk = base_pnt + 4
         self.pnt_actors = base_pnt + 8
         self.pnt_objects = base_pnt + 12
         self.pnt_performers = base_pnt + 16
         self.pnt_events = base_pnt + 20
         self.pnt_unionall_load_addr = rom_data.bin_sections.overlay11.data.UNIONALL_RAM_ADDRESS.absolute_address
-        self.unionall_load_addr = AddressContainer(0)
 
-        self._load_ssb_for = None
+        self._load_ssb_for: Optional[int] = None
 
         self._running = False
         self._print_callback = print_callback
+        self._poll_emulator = poll_emulator
         self._inform_ground_engine_start_cb = inform_ground_engine_start_cb
 
-        self._global_script = GlobalScript(self.emu_thread, self.rom_data, self.pnt_main_script_struct, self.unionall_load_addr)
-        self._map = Map(self.emu_thread, self.rom_data, self.pnt_map)
+        self._global_script = GlobalScript(self.pnt_main_script_struct, u32(0), self.rom_data)
+        self._map = Map(self.pnt_map, u32(0), self.rom_data)
 
         self._actors = []
         info = self.rom_data.script_data.ground_state_structs['Actors']
         for i in range(0, info.maxentries):
-            self._actors.append(Actor(self.emu_thread, self.rom_data, self.pnt_actors, i * info.entrylength, self.unionall_load_addr))
+            self._actors.append(Actor(self.pnt_actors, u32(i * info.entrylength), self.rom_data))
 
         self._objects = []
         info = self.rom_data.script_data.ground_state_structs['Objects']
         for i in range(0, info.maxentries):
-            self._objects.append(Object(self.emu_thread, self.rom_data, self.pnt_objects, i * info.entrylength, self.unionall_load_addr))
+            self._objects.append(Object(self.pnt_objects, u32(i * info.entrylength), self.rom_data))
 
         self._performers = []
         info = self.rom_data.script_data.ground_state_structs['Performers']
         for i in range(0, info.maxentries):
-            self._performers.append(Performer(self.emu_thread, self.rom_data, self.pnt_performers, i * info.entrylength, self.unionall_load_addr))
+            self._performers.append(Performer(self.pnt_performers, u32(i * info.entrylength), self.rom_data))
 
         self._events = []
         info = self.rom_data.script_data.ground_state_structs['Events']
         for i in range(0, info.maxentries):
-            self._events.append(Event(self.emu_thread, self.rom_data, self.pnt_events, i * info.entrylength))
+            self._events.append(Event(self.pnt_events, u32(i * info.entrylength), self.rom_data))
 
         self._loaded_ssx_files: List[Optional[SsxFileInRam]] = []
         self._loaded_ssb_files: List[Optional[SsbFileInRam]] = []
         self.reset()
 
-    @synchronized_now(ground_engine_lock)
-    @typing.no_type_check
+    @no_type_check
     def break_pulled(self, state: BreakpointState):
         """Set the breaked property of the SSB file in the state's hanger."""
+        self._breaked = True
         self._loaded_ssb_files[state.hanger_id].breaked = True
-        self._loaded_ssb_files[state.hanger_id].breaked__handler_file = state.get_file_state().handler_filename
+        self._loaded_ssb_files[state.hanger_id].breaked__handler_file = cast(BreakpointFileState, state.file_state).handler_filename
         state.add_release_hook(self.break_released)
 
-    @typing.no_type_check
+    @no_type_check
     def step_into_macro_call(self, state: BreakpointState):
-        self._loaded_ssb_files[state.hanger_id].breaked__handler_file = state.get_file_state().handler_filename
+        assert self._loaded_ssb_files[state.hanger_id] is not None
+        self._loaded_ssb_files[state.hanger_id].breaked__handler_file = cast(BreakpointFileState, state.file_state).handler_filename
 
-    @synchronized_now(ground_engine_lock)
     def break_released(self, state: BreakpointState):
         """Reset the breaked property of loaded ssb files again."""
+        self._breaked = False
         for x in self._loaded_ssb_files:
             if x is not None:
                 x.breaked = False
                 x.breaked__handler_file = None
 
     @property
     def running(self):
         return self._running
 
-    @property  # type: ignore
-    @synchronized_now(ground_engine_lock)
+    @property
     def loaded_ssx_files(self):
         return self._loaded_ssx_files
 
-    @property  # type: ignore
-    @synchronized_now(ground_engine_lock)
+    @property
     def loaded_ssb_files(self):
         return self._loaded_ssb_files
 
     @property
     def global_script(self) -> GlobalScript:
         return self._global_script
 
@@ -183,91 +193,108 @@
 
     def get_event(self, index: int) -> Optional[Event]:
         evt = self._events[index]
         if evt.valid:
             return evt
         return None
 
-    def collect(self) -> Tuple[GlobalScript, List[SsbFileInRam], List[SsxFileInRam], List[Actor], List[Object], List[Performer], List[Event]]:
+    def force_reload_ground_objects(self):
+        all_entities: Iterable[AbstractEntity] = chain(
+            self._actors, self._objects, self._performers, self._events, (self._global_script, self._map)
+        )
+
+        for obj in all_entities:
+            obj.refresh()
+
+        if not self._breaked:
+            emulator_wait_one_cycle()
+            emulator_wait_one_cycle()
+        self._poll_emulator()
+
+
+    def collect(self) -> Tuple[GlobalScript, List[SsbFileInRam], List[SsxFileInRam], List[Actor], List[Object], List[Performer], List[Event], Map]:
         loaded_ssb_files = self.loaded_ssb_files
         loaded_ssx_files = self.loaded_ssx_files
+
+        self.force_reload_ground_objects()
+
         actors = [x for x in self.actors if x is not None]
         objects = [x for x in self.objects if x is not None]
         performers = [x for x in self.performers if x is not None]
         events = [x for x in self.events if x is not None]
 
-        return self.global_script, loaded_ssb_files, loaded_ssx_files, actors, objects, performers, events
+        return self.global_script, loaded_ssb_files, loaded_ssx_files, actors, objects, performers, events, self.map
 
     def watch(self):
         ov11 = self.rom_data.bin_sections.overlay11
 
-        self.register_exec(ov11.functions.GroundMainLoop.absolute_address + 0x3C, self.hook__ground_start)
-        self.register_exec(ov11.functions.GroundMainLoop.absolute_address + 0x210, self.hook__ground_quit)
-        self.register_exec(ov11.functions.GroundMainLoop.absolute_address + 0x598, self.hook__ground_map_change)
-        self.register_exec(ov11.functions.SsbLoad1.absolute_address, self.hook__ssb_load)
-        self.register_exec(ov11.functions.SsbLoad2.absolute_address, self.hook__ssb_load)
-        self.register_exec(ov11.functions.StationLoadHanger.absolute_address + 0xC0, self.hook__ssx_load)
-        self.register_exec(ov11.functions.ScriptStationLoadTalk.absolute_address, self.hook__talk_load)
-        threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_write(
-            self.pnt_unionall_load_addr, self.hook__write_unionall_address, 4
-        ))
+        emulator_register_exec_ground(ov11.functions.GroundMainLoop.absolute_address + 0x3C, self.hook__ground_start)
+        emulator_register_exec_ground(ov11.functions.GroundMainLoop.absolute_address + 0x210, self.hook__ground_quit)
+        emulator_register_exec_ground(ov11.functions.GroundMainLoop.absolute_address + 0x598, self.hook__ground_map_change)
+        emulator_register_ssb_load([
+            ov11.functions.SsbLoad1.absolute_address, ov11.functions.SsbLoad2.absolute_address
+        ], self.hook__ssb_load)
+        emulator_register_ssx_load([ov11.functions.StationLoadHanger.absolute_address + 0xC0], self.hook__ssx_load)
+        emulator_register_talk_load(ov11.functions.ScriptStationLoadTalk.absolute_addresses, self.hook__talk_load)
+        emulator_register_unionall_load_addr_change(self.pnt_unionall_load_addr)
 
     def remove_watches(self):
         ov11 = self.rom_data.bin_sections.overlay11
 
-        self.register_exec(ov11.functions.GroundMainLoop.absolute_address + 0x3C, None)
-        self.register_exec(ov11.functions.GroundMainLoop.absolute_address + 0x210, None)
-        self.register_exec(ov11.functions.GroundMainLoop.absolute_address + 0x598, None)
-        self.register_exec(ov11.functions.SsbLoad1.absolute_address, None)
-        self.register_exec(ov11.functions.SsbLoad2.absolute_address, None)
-        self.register_exec(ov11.functions.StationLoadHanger.absolute_address + 0xC0, None)
-        self.register_exec(ov11.functions.ScriptStationLoadTalk.absolute_address, None)
+        emulator_register_exec_ground(ov11.functions.GroundMainLoop.absolute_address + 0x3C, None)
+        emulator_register_exec_ground(ov11.functions.GroundMainLoop.absolute_address + 0x210, None)
+        emulator_register_exec_ground(ov11.functions.GroundMainLoop.absolute_address + 0x598, None)
+        emulator_unregister_ssb_load()
+        emulator_unregister_ssx_load()
+        emulator_unregister_talk_load()
+        emulator_unregister_unionall_load_addr_change()
 
-    def register_exec(self, pnt, cb):
-        threadsafe_emu(self.emu_thread, lambda: self.emu_thread.emu.memory.register_exec(pnt, cb))
-
-    @synchronized_now(ground_engine_lock)
     def reset(self, keep_global=False, fully=False):
-        # ! Runs from either GTK or emu thread !
         if fully:
             self._running = False
         self._loaded_ssx_files = [None for _ in range(0, MAX_SSX + 1)]
         if keep_global:
             glob = self._loaded_ssb_files[0]
         for i, ssb in enumerate(self._loaded_ssb_files):
             if (i != 0 or not keep_global) and ssb is not None:
                 self.ssb_file_manager.close_in_ground_engine(ssb.file_name)
         self._loaded_ssb_files = [None for _ in range(0, MAX_SSB + 1)]
+        glob_fn = None
         if keep_global:
             self._loaded_ssb_files[0] = glob
+            glob_fn = glob.file_name if glob is not None else None
+
+        emulator_breakpoints_set_loaded_ssb_files(glob_fn, None, None, None, None, None, None)
 
-    @synchronized_now(ground_engine_lock)
     def serialize(self):
         """Convert the state (that's not directly tied to the game's memory) to a dict for saving."""
         return {
             'running': self.running,
             'ssbs': [
                 [x.file_name, self.ssb_file_manager.hash_for(x.file_name)]
                 if x is not None else None
                 for x in self._loaded_ssb_files
             ],
             'ssxs': [x.file_name if x is not None else None for x in self._loaded_ssx_files],
             'load_ssb_for': self._load_ssb_for
         }
 
-    @synchronized_now(ground_engine_lock)
     def deserialize(self, state: dict):
         """Load a saved state back from a dict"""
         self._running = state['running']
         self._load_ssb_for = state['load_ssb_for']
         self._loaded_ssb_files = [
             SsbFileInRam(fn_and_hash[0], hng, fn_and_hash[1])
             if fn_and_hash is not None else None
             for hng, fn_and_hash in enumerate(state['ssbs'])
         ]
+        emulator_breakpoints_set_load_ssb_for(int(self._load_ssb_for) if self._load_ssb_for is not None else None)
+        emulator_breakpoints_set_loaded_ssb_files(
+            *((x.file_name if x is not None else None) for x in self._loaded_ssb_files)
+        )
         # - Load SSB file hashes from ground state file, if the hashes don't match on reload with the saved
         #   files, mark them as not up to date in RAM and show warning for affected files.
         were_invalid = []
         for f in self._loaded_ssb_files:
             if f is not None and f.hash != self.ssb_file_manager.hash_for(f.file_name):
                 were_invalid.append(f.file_name)
         if len(were_invalid) > 0:
@@ -288,96 +315,58 @@
             if ssb is not None:
                 self.ssb_file_manager.open_in_ground_engine(ssb.file_name)
                 if ssb.file_name in were_invalid:
                     self.ssb_file_manager.mark_invalid(ssb.file_name)
         self._loaded_ssx_files = [SsxFileInRam(fn, hng) if fn is not None else None for hng, fn in enumerate(state['ssxs'])]
 
         # Also update the load address for unionall
-        threadsafe_emu(self.emu_thread, lambda: self.unionall_load_addr.set(self.emu_thread.emu.memory.unsigned.read_long(self.pnt_unionall_load_addr)))
+        emulator_unionall_load_address_update()
 
     def _print(self, string):
         if self.logging_enabled and not self._boost:
             self._print_callback(f"Ground Event >> {string}")
 
-    # >>> ALL CALLBACKS BELOW ARE RUNNING IN THE EMULATOR THREAD <<<
-
-    def hook__ground_start(self, address, size):
-        if not self.overlay11_loaded():
-            return
+    def hook__ground_start(self):
         self._print("Ground Start")
-        threadsafe_gtk_nonblocking(lambda: self.reset())
-        ground_engine_lock.acquire()
+        self.reset()
         self._running = True
-        ground_engine_lock.release()
         self._inform_ground_engine_start_cb()
 
-    def hook__ground_quit(self, address, size):
-        if not self.overlay11_loaded():
-            return
+    def hook__ground_quit(self):
         self._print("Ground Quit")
-        ground_engine_lock.acquire()
         self._running = False
-        ground_engine_lock.release()
 
-    def hook__ground_map_change(self, address, size):
-        if not self.overlay11_loaded():
-            return
+    def hook__ground_map_change(self):
         self._print("Ground Map Change")
         self.reset(keep_global=True)
 
-    @synchronized_now(ground_engine_lock)
-    def hook__ssb_load(self, address, size):
-        if not self.overlay11_loaded():
-            return
-        name = self.emu_thread.emu.memory.read_string(self.emu_thread.emu.memory.register_arm9.r1)
+    def hook__ssb_load(self, name: str):
         load_for = self._load_ssb_for if self._load_ssb_for is not None else 0
         self._print(f"SSB Load {name} for hanger {load_for}")
         self._load_ssb_for = None
 
         if load_for > MAX_SSB:
             warnings.warn(f"Ground Engine debugger: Invalid hanger ID for ssb: {load_for}")
             return
-        threadsafe_gtk_nonblocking(lambda: self.ssb_file_manager.open_in_ground_engine(name))
+        self.ssb_file_manager.open_in_ground_engine(name)
         self._loaded_ssb_files[load_for] = (SsbFileInRam(name, load_for))
 
-    @synchronized(ground_engine_lock)
-    def hook__ssx_load(self, address, size):
-        if not self.overlay11_loaded():
-            return
-        hanger = self.emu_thread.emu.memory.register_arm9.r2
-        name = self.emu_thread.emu.memory.read_string(self.emu_thread.emu.memory.register_arm9.r3)
+    def hook__ssx_load(self, hanger: int, name: str):
         self._print(f"SSX Load {name} for hanger {hanger}")
         self._load_ssb_for = hanger
         if hanger > MAX_SSX:
             warnings.warn(f"Ground Engine debugger: Invalid hanger ID for ssx: {hanger}")
             return
 
         self._loaded_ssx_files[hanger] = (SsxFileInRam(name, hanger))
 
-    @synchronized_now(ground_engine_lock)
-    def hook__talk_load(self, address, size):
-        if not self.overlay11_loaded():
-            return
-        hanger = self.emu_thread.emu.memory.register_arm9.r0
+    def hook__talk_load(self, hanger):
         # TODO:
         #    If the hanger is 1 - 3, this is a load for SSA/SSE/SSS.
         #    Otherwise just take the number. It's unknown what the exact mechanism / side effects are here.
         if hanger <= TALK_HANGER_OFFSET:
             hanger += TALK_HANGER_OFFSET
         self._print(f"Talk Load for hanger {hanger}")
         self._load_ssb_for = hanger
 
-    @synchronized_now(ground_engine_lock)
-    def hook__write_unionall_address(self, address, size):
-        """Write the location of the unionall script into the container object for this"""
-        if not self.overlay11_loaded():
-            return
-        self.unionall_load_addr.set(self.emu_thread.emu.memory.unsigned.read_long(self.pnt_unionall_load_addr))
-
-    def overlay11_loaded(self):
-        """TODO: Replace with a proper check..."""
-        begin_offset = self.rom_data.bin_sections.overlay11.functions.GroundMainLoop.absolute_address
-        return self.emu_thread.emu.memory.unsigned[begin_offset:begin_offset+len(O11_BYTE_CHECK)] == O11_BYTE_CHECK
-
-    @synchronized(ground_engine_lock)
     def set_boost(self, state):
         self._boost = state
```

## skytemple_ssb_debugger/model/script_runtime_struct.py

```diff
@@ -10,154 +10,148 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from typing import Callable, Union
+from __future__ import annotations
 
 from explorerscript.ssb_converting.ssb_data_types import SsbRoutineType
+from range_typed_integers import u32
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptOpCode
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
-from skytemple_ssb_debugger.threadsafe import wrap_threadsafe_emu
+from skytemple_files.common.util import read_u32, read_u16, read_i16
+from skytemple_ssb_emulator import emulator_unionall_load_address, emulator_read_mem_from_ptr
+
+# This is not the actual size, increase this if we need to read more!
+STRUCT_SIZE = u32(0x34)
 
 
 class ScriptRuntimeStruct:
-    def __init__(self, emu_thread: EmulatorThread, rom_data: Pmd2Data, pnt: Union[int, Callable], unionall_load_addr: AddressContainer, parent=None):
+    def __init__(self, rom_data: Pmd2Data, pnt_to_block_start: u32, script_struct_offset_from_start: u32, parent=None, *, _do_not_refresh=False):
         super().__init__()
-        self.emu_thread = emu_thread
         self.rom_data = rom_data
-        # Can either be int or a callable. If it's a callable, it's called each time
-        # a value is accesed to retreive the current position.
-        self._pnt = pnt
+        self.pnt_to_block_start = pnt_to_block_start
+        self.script_struct_offset_from_start = script_struct_offset_from_start
+        self.buffer = bytes(STRUCT_SIZE)
+        self._cached_target_id: int = 0
+        self._do_not_refresh = _do_not_refresh
+        self.refresh()
+        
         # for debugging
         self._parent = parent
-        self.unionall_load_addr = unionall_load_addr
 
-    @property
-    def pnt(self):
-        if callable(self._pnt):
-            return self._pnt()
-        return self._pnt
+    @classmethod
+    def from_data(cls, rom_data: Pmd2Data, pnt_to_block_start: u32, data: bytes, target_slot_id: u32):
+        slf = cls(rom_data, pnt_to_block_start, None, _do_not_refresh=True)  # type: ignore
+        slf.buffer = data
+        slf._cached_target_id = target_slot_id
+        return slf
+
+    def refresh(self):
+        def set_val(val: bytes):
+            self.buffer = val
+            self.refresh_target_id()
+
+        if self.pnt_to_block_start is not None and not self._do_not_refresh:
+            self._cached_target_id = 0
+            emulator_read_mem_from_ptr(self.pnt_to_block_start, self.script_struct_offset_from_start, STRUCT_SIZE, set_val)
+
+    def refresh_target_id(self):
+        def set_cached_target_id(val: bytes):
+            self._cached_target_id = read_u16(val, 0)
+
+        script_target_address = read_u32(self.buffer, 0x04)
+        if script_target_address != 0:
+            emulator_read_mem_from_ptr(script_target_address, u32(0), u32(2), set_cached_target_id)
 
     @property
     def valid(self):
         """The first entry contains a pointer to something unknown (global script state?) when valid"""
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt) != 0
+        return read_u32(self.buffer, 0) != 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def script_target_type(self) -> SsbRoutineType:
         """The type of target for this script struct (ACTOR, OBJECT, PERFORMER) or GENERIC for global script"""
-        idx = self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x08)
+        idx = read_u32(self.buffer, 0x08)
         return SsbRoutineType.create_for_index(idx)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def script_target_slot_id(self) -> int:
         """The slot id of the target type's entity list (always 0 for global script)"""
-        script_target_id = script_target_address = self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x04)
-        if script_target_address != 0:
-            script_target_id = self.emu_thread.emu.memory.unsigned.read_short(script_target_address)
-        return script_target_id
-
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
-    def current_opcode(self) -> Pmd2ScriptOpCode:
-        address_current_opcode = self.current_opcode_addr
-        return self.rom_data.script_data.op_codes__by_id[self.emu_thread.emu.memory.unsigned.read_short(address_current_opcode)]
+        return self._cached_target_id
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def start_addr_routine_infos(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x14)
+        return read_u32(self.buffer, 0x14)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def start_addr_opcodes(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x18)
+        return read_u32(self.buffer, 0x18)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def current_opcode_addr(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x1c)
+        return read_u32(self.buffer, 0x1c)
 
     @property
     def current_opcode_addr_relative(self) -> int:
         """The current opcode address relative to the start of the SSB file (after header), in words."""
         return int((self.current_opcode_addr - self.start_addr_routine_infos) / 2)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def start_addr_str_table(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x20)
+        return read_u32(self.buffer, 0x20)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def has_call_stack(self) -> bool:
         """Whether or not there is a script return address on the stack -> the debugger can step out"""
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x2c) != 0
+        return read_u32(self.buffer, 0x2c) != 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def call_stack__start_addr_routine_infos(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x24)
+        return read_u32(self.buffer, 0x24)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def call_stack__start_addr_opcodes(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x28)
+        return read_u32(self.buffer, 0x28)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def call_stack__current_opcode_addr(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x2c)
+        return read_u32(self.buffer, 0x2c)
 
     @property
     def call_stack__current_opcode_addr_relative(self) -> int:
         """The stack opcode address relative to the start of the SSB file (after header), in words."""
         return int((self.call_stack__current_opcode_addr - self.call_stack__start_addr_routine_infos) / 2)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def call_stack__start_addr_str_table(self) -> int:
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x30)
+        return read_u32(self.buffer, 0x30)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def target_type(self) -> SsbRoutineType:
-        return SsbRoutineType(self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 8))
+        return SsbRoutineType(read_u16(self.buffer, 8))
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def is_in_unionall(self):
-        return self.start_addr_routine_infos == self.unionall_load_addr.get() and self.unionall_load_addr.get() != 0
+        unionall_load_addr = emulator_unionall_load_address()
+        return self.start_addr_routine_infos == unionall_load_addr and unionall_load_addr != 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def hanger_ssb(self):
         """
         The number of the SSB script this operation is in!
         Normally just returns the value stored in RAM for this field. If the current loaded address of the script
         is the same as unionall it will return 0 instead.
         """
         if not self.valid:
             return -1
         if self.is_in_unionall:
             return 0
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + 0x10)
-
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
-    def target_id(self) -> int:
-        script_target_id = script_target_address = self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 4)
-        if script_target_address != 0:
-            script_target_id = self.emu_thread.emu.memory.unsigned.read_short(script_target_address)
-        return script_target_id
+        return read_i16(self.buffer, 0x10)
 
     def __eq__(self, other):
         if not isinstance(other, ScriptRuntimeStruct):
             return False
-        return self.pnt == other.pnt
+        if self.pnt_to_block_start is None or other.pnt_to_block_start is None:
+            return self.buffer == other.buffer
+        return self.pnt_to_block_start == other.pnt_to_block_start and self.script_struct_offset_from_start == other.script_struct_offset_from_start
```

## skytemple_ssb_debugger/model/settings.py

```diff
@@ -10,27 +10,24 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import configparser
 import logging
 import os
-import threading
-from typing import Optional, Tuple, List
+from typing import Optional, Tuple, List, Sequence
 
-from desmume.controls import key_names
-from desmume.emulator import Language
 from skytemple_files.common.project_file_manager import ProjectFileManager
 from skytemple_files.common.util import open_utf8
-from skytemple_ssb_debugger.threadsafe import synchronized
+from skytemple_ssb_emulator import emulator_get_key_names, Language
 
-settings_lock = threading.Lock()
 CONFIG_DIR_NAME = 'debugger'
 CONFIG_FILE_NAME = 'config.ini'
 
 SECT_GENERAL = 'General'
 SECT_WINDOW = 'Window'
 SECT_KEYS = 'KEYS'
 SECT_JOYKEYS = 'JOYKEYS'
@@ -58,128 +55,112 @@
         if os.path.exists(self.config_file):
             try:
                 with open_utf8(self.config_file, 'r') as f:
                     self.loaded_config.read_file(f)
             except BaseException as err:
                 logger.error("Error reading config, falling back to default.", exc_info=err)
 
-    @synchronized(settings_lock)
     def get_style_scheme(self) -> Optional[str]:
         if SECT_GENERAL in self.loaded_config:
             if KEY_STYLE_SCHEME in self.loaded_config[SECT_GENERAL]:
                 return self.loaded_config[SECT_GENERAL][KEY_STYLE_SCHEME]
         return None
 
-    @synchronized(settings_lock)
     def set_style_scheme(self, scheme_id: str):
         if SECT_GENERAL not in self.loaded_config:
             self.loaded_config[SECT_GENERAL] = {}
         self.loaded_config[SECT_GENERAL][KEY_STYLE_SCHEME] = scheme_id
         self._save()
 
-    @synchronized(settings_lock)
     def get_assistant_shown(self) -> bool:
         if SECT_GENERAL in self.loaded_config:
             if KEY_ASSISTANT_SHOWN in self.loaded_config[SECT_GENERAL]:
                 return int(self.loaded_config[SECT_GENERAL][KEY_ASSISTANT_SHOWN]) > 0
         return False
 
-    @synchronized(settings_lock)
     def set_assistant_shown(self, value: bool):
         if SECT_GENERAL not in self.loaded_config:
             self.loaded_config[SECT_GENERAL] = {}
         self.loaded_config[SECT_GENERAL][KEY_ASSISTANT_SHOWN] = '1' if value else '0'
         self._save()
 
-    @synchronized(settings_lock)
     def get_window_size(self) -> Optional[Tuple[int, int]]:
         if SECT_WINDOW in self.loaded_config:
             if KEY_WINDOW_SIZE_X in self.loaded_config[SECT_WINDOW] and KEY_WINDOW_SIZE_Y in self.loaded_config[SECT_WINDOW]:
                 return int(self.loaded_config[SECT_WINDOW][KEY_WINDOW_SIZE_X]), int(self.loaded_config[SECT_WINDOW][KEY_WINDOW_SIZE_Y])
         return None
 
-    @synchronized(settings_lock)
     def set_window_size(self, dim: Tuple[int, int]):
         if SECT_WINDOW not in self.loaded_config:
             self.loaded_config[SECT_WINDOW] = {}
         self.loaded_config[SECT_WINDOW][KEY_WINDOW_SIZE_X] = str(dim[0])
         self.loaded_config[SECT_WINDOW][KEY_WINDOW_SIZE_Y] = str(dim[1])
         self._save()
 
-    @synchronized(settings_lock)
     def get_window_position(self) -> Optional[Tuple[int, int]]:
         if SECT_WINDOW in self.loaded_config:
             if KEY_WINDOW_POS_X in self.loaded_config[SECT_WINDOW] and KEY_WINDOW_POS_Y in self.loaded_config[SECT_WINDOW]:
                 return int(self.loaded_config[SECT_WINDOW][KEY_WINDOW_POS_X]), int(self.loaded_config[SECT_WINDOW][KEY_WINDOW_POS_Y])
         return None
 
-    @synchronized(settings_lock)
     def set_window_position(self, pos: Tuple[int, int]):
         if SECT_WINDOW not in self.loaded_config:
             self.loaded_config[SECT_WINDOW] = {}
         self.loaded_config[SECT_WINDOW][KEY_WINDOW_POS_X] = str(pos[0])
         self.loaded_config[SECT_WINDOW][KEY_WINDOW_POS_Y] = str(pos[1])
         self._save()
 
-    @synchronized(settings_lock)
     def get_emulator_keyboard_cfg(self) -> Optional[List[int]]:
         if SECT_KEYS in self.loaded_config:
             cfg = []
-            for key_name in key_names:
+            for key_name in emulator_get_key_names():
                 cfg.append(int(self.loaded_config[SECT_KEYS][key_name]))
             return cfg
         return None
 
-    @synchronized(settings_lock)
     def set_emulator_keyboard_cfg(self, keys: List[int]):
         if SECT_KEYS not in self.loaded_config:
             self.loaded_config[SECT_KEYS] = {}
-        for key_name, key_value in zip(key_names, keys):
+        for key_name, key_value in zip(emulator_get_key_names(), keys):
             self.loaded_config[SECT_KEYS][key_name] = str(key_value)
         self._save()
 
-    @synchronized(settings_lock)
     def get_emulator_joystick_cfg(self):
         if SECT_JOYKEYS in self.loaded_config:
             cfg = []
-            for key_name in key_names:
+            for key_name in emulator_get_key_names():
                 cfg.append(int(self.loaded_config[SECT_JOYKEYS][key_name]))
             return cfg
         return None
 
-    @synchronized(settings_lock)
-    def set_emulator_joystick_cfg(self, keys: List[int]):
+    def set_emulator_joystick_cfg(self, keys: Sequence[int]):
         if SECT_JOYKEYS not in self.loaded_config:
             self.loaded_config[SECT_JOYKEYS] = {}
-        for key_name, key_value in zip(key_names, keys):
+        for key_name, key_value in zip(emulator_get_key_names(), keys):
             self.loaded_config[SECT_JOYKEYS][key_name] = str(key_value)
         self._save()
 
-    @synchronized(settings_lock)
     def get_emulator_language(self) -> Optional[Language]:
         if SECT_GENERAL in self.loaded_config:
             if KEY_EMULATOR_LANG in self.loaded_config[SECT_GENERAL]:
                 return Language(int(self.loaded_config[SECT_GENERAL][KEY_EMULATOR_LANG]))
         return None
 
-    @synchronized(settings_lock)
     def set_emulator_language(self, lang: Language):
         if SECT_GENERAL not in self.loaded_config:
             self.loaded_config[SECT_GENERAL] = {}
         self.loaded_config[SECT_GENERAL][KEY_EMULATOR_LANG] = str(lang.value)
         self._save()
 
-    @synchronized(settings_lock)
     def get_spellcheck_enabled(self) -> bool:
         if SECT_GENERAL in self.loaded_config:
             if KEY_SPELLCHECK in self.loaded_config[SECT_GENERAL]:
                 return int(self.loaded_config[SECT_GENERAL][KEY_SPELLCHECK]) > 0
         return False
 
-    @synchronized(settings_lock)
     def set_spellcheck_enabled(self, value: bool):
         if SECT_GENERAL not in self.loaded_config:
             self.loaded_config[SECT_GENERAL] = {}
         self.loaded_config[SECT_GENERAL][KEY_SPELLCHECK] = str(int(value))
         self._save()
 
     def _save(self):
```

## skytemple_ssb_debugger/model/completion/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/model/completion/constants.py

```diff
@@ -10,25 +10,26 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from typing import Iterable, Tuple
 
 from gi.repository import GObject, GtkSource, Gtk
 
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.common.ppmdu_config.script_data import *
 from skytemple_files.script.ssb.constants import SsbConstant
 from skytemple_ssb_debugger.model.completion.util import common_do_match, common_do_populate, \
     backward_until_special_char
 from skytemple_ssb_debugger.model.constants import ICON_ACTOR, ICON_OBJECT, ICON_GLOBAL_SCRIPT
-from skytemple_files.common.i18n_util import f, _
+from skytemple_files.common.i18n_util import _
 
 
 class GtkSourceCompletionSsbConstants(GObject.Object, GtkSource.CompletionProvider):
     def __init__(self, rom_data: Pmd2Data):
         super().__init__()
         self.constant_source = rom_data.script_data
```

## skytemple_ssb_debugger/model/completion/exps_statements.py

```diff
@@ -10,21 +10,22 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from typing import Tuple, Optional, Iterable
 
 from gi.repository import GObject
 from gi.repository import GtkSource, Gtk
 
 from skytemple_ssb_debugger.model.completion.util import common_do_match, common_do_populate
-from skytemple_files.common.i18n_util import f, _
+from skytemple_files.common.i18n_util import _
 
 ALL_STATEMENTS = ['return', 'end', 'hold', 'if', 'elseif', 'else', 'with', 'actor', 'object', 'performer', 'jump',
                   'for', 'while', 'forever', 'break', 'break_loop', 'continue', 'case',
                   'default', 'clear', 'reset', 'init']
 
 
 class GtkSourceCompletionExplorerScriptStatements(GObject.Object, GtkSource.CompletionProvider):
```

## skytemple_ssb_debugger/model/completion/functions.py

```diff
@@ -10,21 +10,22 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from typing import List, Iterable, Tuple, Optional
 
 from gi.repository import GObject, GtkSource, Gtk
 
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptOpCode
 from skytemple_ssb_debugger.model.completion.util import common_do_match, common_do_populate
-from skytemple_files.common.i18n_util import f, _
+from skytemple_files.common.i18n_util import _
 
 
 class GtkSourceCompletionSsbFunctions(GObject.Object, GtkSource.CompletionProvider):
     def __init__(self, opcodes: List[Pmd2ScriptOpCode]):
         super().__init__()
         self.opcodes = opcodes
```

## skytemple_ssb_debugger/model/completion/util.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import string
 from typing import List
 
 from gi.repository import GtkSource, Gtk
 
 from explorerscript.ssb_converting.ssb_special_ops import OPS_ALL_SPECIAL
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptOpCode
```

## skytemple_ssb_debugger/model/completion/calltips/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/model/completion/calltips/calltip_emitter.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from typing import List, Optional
 
 from gi.repository import GtkSource, Gtk
 
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptOpCode
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
 from skytemple_ssb_debugger.model.completion.calltips.position_mark import PositionMarkEditorCalltip
```

## skytemple_ssb_debugger/model/completion/calltips/position_mark.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 
 from typing import Optional, Tuple, List
 
 from gi.repository import GtkSource, GObject, Gtk
 
 from explorerscript.error import ParseError
 from explorerscript.explorerscript_reader import ExplorerScriptReader
```

## skytemple_ssb_debugger/model/completion/calltips/string_event_emitter.py

```diff
@@ -10,22 +10,19 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from typing import List, Optional
+from __future__ import annotations
 
-from gi.repository import GtkSource, Gtk
+from gi.repository import GtkSource
 
-from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptOpCode
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.model.completion.calltips.position_mark import PositionMarkEditorCalltip
-from skytemple_ssb_debugger.model.completion.util import backward_until_space
 
 
 class StringEventEmitter:
     """Emits the string changed event to the context when a string was selected or changed."""
     def __init__(self, view: GtkSource.View, context: AbstractDebuggerControlContext):
         self.view = view
         self.buffer: GtkSource.Buffer = view.get_buffer()
```

## skytemple_ssb_debugger/model/ground_state/__init__.py

```diff
@@ -10,22 +10,24 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from abc import abstractmethod, ABC
+from typing import Optional
 
+from range_typed_integers import u32
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.script.ssa_sse_sss.position import TILE_SIZE
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
+from skytemple_ssb_emulator import emulator_read_mem_from_ptr, emulator_read_mem_from_ptr_with_validity_check
+
 from skytemple_ssb_debugger.model.script_runtime_struct import ScriptRuntimeStruct
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu
 
 
 def pos_for_display_camera(pos: int, camera_pos: int) -> float:
     """Subtracts the camera positon, but also turns the 'subpixel' position into a float"""
     # TODO: is this actually correct...?
     pos_abs = (pos >> 8) - camera_pos
     pos_sub = (pos & 0xFF) / 0xFF
@@ -37,32 +39,51 @@
     # Positions are centered on hitbox:
     center = low_coord + (high_coord - low_coord) / 2
     # TODO: How exactly is the number calculated?
     #       Theory: 256 subpixel precision and then 8 pixel per tile.
     return round(center / 0x100 / TILE_SIZE, 1)
 
 
-class AbstractEntityWithScriptStruct(ABC):
-    """An entity that has a script struct embedded into it's data struct."""
-    def __init__(self, emu_thread: EmulatorThread, pnt_to_block_start: int, rom_data: Pmd2Data, unionall_load_addr: AddressContainer):
+class AbstractEntity(ABC):
+    """An entity"""
+    def __init__(self, pnt_to_block_start: u32, offset: u32, rom_data: Pmd2Data):
         super().__init__()
-        self.emu_thread: EmulatorThread = emu_thread
         self.pnt_to_block_start = pnt_to_block_start
         self.rom_data = rom_data
-        self.unionall_load_addr = unionall_load_addr
+        self.offset = offset
+        self.buffer = bytes(self._block_size)
+        self.refresh()
+
+    def refresh(self):
+        self.buffer = bytes(self._block_size)
+        def set_val(val):
+            self.buffer = val
+
+        if self._block_size != 0:
+            if self._validity_offset is not None:
+                emulator_read_mem_from_ptr_with_validity_check(self.pnt_to_block_start, self.offset, self._block_size, self._validity_offset, set_val)
+            else:
+                emulator_read_mem_from_ptr(self.pnt_to_block_start, self.offset, self._block_size, set_val)
 
     @property
-    def pnt(self):
-        return threadsafe_emu(
-            self.emu_thread, lambda: self.emu_thread.emu.memory.unsigned.read_long(self.pnt_to_block_start)
-        )
+    @abstractmethod
+    def _block_size(self):
+        pass
 
-    @property  # type: ignore
+    @property
+    @abstractmethod
+    def _validity_offset(self) -> Optional[u32]:
+        """If defined, only refresh the memory if the i16 at the given offset starting at the block start is > 0."""
+
+
+class AbstractEntityWithScriptStruct(AbstractEntity, ABC):
+    """An entity that has a script struct embedded into it's data struct."""
+    @property
     @abstractmethod
     def _script_struct_offset(self):
         pass
 
     @property
     def script_struct(self):
         return ScriptRuntimeStruct(
-            self.emu_thread, self.rom_data.script_data, lambda: self.pnt + self._script_struct_offset, self.unionall_load_addr, self
+            self.rom_data, self.pnt_to_block_start, self.offset + self._script_struct_offset, self
         )
```

## skytemple_ssb_debugger/model/ground_state/actor.py

```diff
@@ -10,103 +10,94 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from range_typed_integers import u16
+from __future__ import annotations
+
+from typing import Optional, cast
+
+from range_typed_integers import u16, u32
 
-from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptEntity
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
+from skytemple_files.common.util import read_i16, read_u16, read_u8, read_u32
+
 from skytemple_ssb_debugger.model.ground_state import pos_for_display_camera, AbstractEntityWithScriptStruct, \
     pos_in_map_coord
 from skytemple_ssb_debugger.model.ground_state.map import Map
-from skytemple_ssb_debugger.threadsafe import wrap_threadsafe_emu
 
 ACTOR_BEGIN_SCRIPT_STRUCT = 0x38
 
 
 class Actor(AbstractEntityWithScriptStruct):
-    def __init__(self, emulator_thread: EmulatorThread, rom_data: Pmd2Data, pnt_to_block_start: int, offset: int, unionall_load_addr: AddressContainer):
-        super().__init__(emulator_thread, pnt_to_block_start, rom_data, unionall_load_addr)
-        self.offset = offset
+    @property
+    def _block_size(self):
+        # This is not the actual size, increase this if we need to read more!
+        return u32(0x172)
 
     @property
-    def pnt(self):
-        return super().pnt + self.offset
+    def _validity_offset(self) -> Optional[u32]:
+        return self._script_struct_offset  # type: ignore
 
     @property
     def _script_struct_offset(self):
         return ACTOR_BEGIN_SCRIPT_STRUCT
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def valid(self):
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + self._script_struct_offset) > 0
+        return read_i16(self.buffer, cast(u32, self._validity_offset)) > 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def id(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x00)
+        return read_u16(self.buffer, 0x00)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def kind(self) -> Pmd2ScriptEntity:
-        kind_id = self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x02)
+        kind_id = read_u16(self.buffer, 0x02)
         try:
             return self.rom_data.script_data.level_entities__by_id[kind_id]
         except KeyError:
             return Pmd2ScriptEntity(u16(kind_id), u16(0), 'UNKNOWN', u16(0), u16(0), u16(0))
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def hanger(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x06)
+        return read_u16(self.buffer, 0x06)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def sector(self):
-        return self.emu_thread.emu.memory.unsigned.read_byte(self.pnt + 0x08)
+        return read_u8(self.buffer, 0x08)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def direction(self):
-        return self.rom_data.script_data.directions__by_ssb_id[self.emu_thread.emu.memory.unsigned.read_byte(self.pnt + 0x15A)]
+        return self.rom_data.script_data.directions__by_ssb_id[read_u8(self.buffer, 0x15A)]
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_north(self):
         # via code near 0x22FC310
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x15C)
+        return read_u32(self.buffer, 0x15C)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_west(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x160)
+        return read_u32(self.buffer, 0x160)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_south(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x164)
+        return read_u32(self.buffer, 0x164)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_east(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x168)
+        return read_u32(self.buffer, 0x168)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_map(self):
         return pos_in_map_coord(self.x_north, self.x_south)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_map(self):
         return pos_in_map_coord(self.y_west, self.y_east)
 
     def get_bounding_box_camera(self, map: Map):
         return (
             pos_for_display_camera(self.x_north, map.camera_x_pos), pos_for_display_camera(self.y_west, map.camera_y_pos),
             pos_for_display_camera(self.x_south, map.camera_x_pos), pos_for_display_camera(self.y_east, map.camera_y_pos)
```

## skytemple_ssb_debugger/model/ground_state/event.py

```diff
@@ -10,89 +10,78 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.ground_state import pos_for_display_camera, pos_in_map_coord
+from __future__ import annotations
+
+from typing import Optional, cast
+
+from range_typed_integers import u32
+from skytemple_files.common.util import read_i16, read_u16, read_u8, read_u32
+
+from skytemple_ssb_debugger.model.ground_state import pos_for_display_camera, pos_in_map_coord, AbstractEntity
 from skytemple_ssb_debugger.model.ground_state.map import Map
-from skytemple_ssb_debugger.threadsafe import wrap_threadsafe_emu, threadsafe_emu
 
 EVENT_EXISTS_CHECK_OFFSET = 0x02
 
 
-class Event:
-    def __init__(self, emu_thread: EmulatorThread, rom_data: Pmd2Data, pnt_to_block_start: int, offset: int):
-        super().__init__()
-        self.emu_thread = emu_thread
-        self.rom_data = rom_data
-        self.pnt_to_block_start = pnt_to_block_start
-        self.offset = offset
-
-    @property
-    def pnt(self):
-        return threadsafe_emu(
-            self.emu_thread, lambda: self.emu_thread.emu.memory.unsigned.read_long(self.pnt_to_block_start)
-        ) + self.offset
+class Event(AbstractEntity):
+    @property
+    def _block_size(self):
+        # This is not the actual size, increase this if we need to read more!
+        return u32(0x20)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
+    def _validity_offset(self) -> Optional[u32]:
+        return EVENT_EXISTS_CHECK_OFFSET  # type: ignore
+
+    @property
     def valid(self):
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + EVENT_EXISTS_CHECK_OFFSET) > 0
+        return read_i16(self.buffer, cast(u32, self._validity_offset)) > 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def id(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x00)
+        return read_u16(self.buffer, 0x00)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def kind(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x02)
+        return read_u16(self.buffer, 0x02)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def hanger(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x04)
+        return read_u16(self.buffer, 0x04)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def sector(self):
-        return self.emu_thread.emu.memory.unsigned.read_byte(self.pnt + 0x06)
+        return read_u8(self.buffer, 0x06)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_north(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x10)
+        return read_u32(self.buffer, 0x10)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_west(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x14)
+        return read_u32(self.buffer, 0x14)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_south(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x18)
+        return read_u32(self.buffer, 0x18)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_east(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x1C)
+        return read_u32(self.buffer, 0x1C)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_map(self):
         return pos_in_map_coord(self.x_north, self.x_south)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_map(self):
         return pos_in_map_coord(self.y_west, self.y_east)
 
     def get_bounding_box_camera(self, map: Map):
         return (
             pos_for_display_camera(self.x_north, map.camera_x_pos), pos_for_display_camera(self.y_west, map.camera_y_pos),
             pos_for_display_camera(self.x_south, map.camera_x_pos), pos_for_display_camera(self.y_east, map.camera_y_pos)
```

## skytemple_ssb_debugger/model/ground_state/global_script.py

```diff
@@ -10,20 +10,28 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
+
+from typing import Optional
+
+from range_typed_integers import u32
 from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
 from skytemple_ssb_debugger.model.ground_state import AbstractEntityWithScriptStruct
 
 
 class GlobalScript(AbstractEntityWithScriptStruct):
-    def __init__(self, emu_thread: EmulatorThread, rom_data: Pmd2Data, pnt_to_block_start: int, unionall_load_addr: AddressContainer):
-        super().__init__(emu_thread, pnt_to_block_start, rom_data, unionall_load_addr)
+    @property
+    def _block_size(self):
+        return 0
+
+    @property
+    def _validity_offset(self) -> Optional[u32]:
+        return None
 
     @property
     def _script_struct_offset(self):
         return 0
```

## skytemple_ssb_debugger/model/ground_state/map.py

```diff
@@ -10,36 +10,36 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.threadsafe import threadsafe_emu, wrap_threadsafe_emu
+from __future__ import annotations
 
+from typing import Optional
 
-class Map:
-    def __init__(self, emu_thread: EmulatorThread, rom_data: Pmd2Data, pnt_to_block_start: int):
-        super().__init__()
-        self.emu_thread = emu_thread
-        self.rom_data = rom_data
-        self.pnt_to_block_start = pnt_to_block_start
+from range_typed_integers import u32
+from skytemple_files.common.util import read_u32
+
+from skytemple_ssb_debugger.model.ground_state import AbstractEntity
+
+
+class Map(AbstractEntity):
+    @property
+    def _block_size(self):
+        # This is not the actual size, increase this if we need to read more!
+        return u32(0x208)
 
     @property
-    def pnt(self):
-        return threadsafe_emu(
-            self.emu_thread, lambda: self.emu_thread.emu.memory.unsigned.read_long(self.pnt_to_block_start)
-        )
+    def _validity_offset(self) -> Optional[u32]:
+        return None
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def camera_x_pos(self):
         """Returns the center position of the camera"""
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x200)
+        return read_u32(self.buffer, 0x200)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def camera_y_pos(self):
         """Returns the center position of the camera"""
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x204)
+        return read_u32(self.buffer, 0x204)
```

## skytemple_ssb_debugger/model/ground_state/object.py

```diff
@@ -10,102 +10,93 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from range_typed_integers import u16, u8
+from __future__ import annotations
+
+from typing import cast, Optional
+
+from range_typed_integers import u16, u8, u32
 
-from skytemple_files.common.ppmdu_config.data import Pmd2Data
 from skytemple_files.common.ppmdu_config.script_data import Pmd2ScriptObject
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
+from skytemple_files.common.util import read_i16, read_u16, read_u8, read_u32
+
 from skytemple_ssb_debugger.model.ground_state import pos_for_display_camera, AbstractEntityWithScriptStruct, \
     pos_in_map_coord
 from skytemple_ssb_debugger.model.ground_state.map import Map
-from skytemple_ssb_debugger.threadsafe import wrap_threadsafe_emu
 
 OBJECT_BEGIN_SCRIPT_STRUCT = 0x3C
 
 
 class Object(AbstractEntityWithScriptStruct):
-    def __init__(self, emulator_thread: EmulatorThread, rom_data: Pmd2Data, pnt_to_block_start: int, offset: int, unionall_load_addr: AddressContainer):
-        super().__init__(emulator_thread, pnt_to_block_start, rom_data, unionall_load_addr)
-        self.offset = offset
+    @property
+    def _block_size(self):
+        # This is not the actual size, increase this if we need to read more!
+        return u32(0x144)
 
     @property
-    def pnt(self):
-        return super().pnt + self.offset
+    def _validity_offset(self) -> Optional[u32]:
+        return self._script_struct_offset  # type: ignore
 
     @property
     def _script_struct_offset(self):
         return OBJECT_BEGIN_SCRIPT_STRUCT
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def valid(self):
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + self._script_struct_offset) > 0
+        return read_i16(self.buffer, cast(u32, self._validity_offset)) > 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def id(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x04)
+        return read_u16(self.buffer, 0x04)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def kind(self) -> Pmd2ScriptObject:
-        kind_id = self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x06)
+        kind_id = read_u16(self.buffer, 0x06)
         try:
             return self.rom_data.script_data.objects__by_id[kind_id]
         except KeyError:
             return Pmd2ScriptObject(u16(kind_id), u16(0), u16(0), u8(0), 'UNKNOWN')
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def hanger(self):
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + 0x0A)
+        return read_i16(self.buffer, 0x0A)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def sector(self):
-        return self.emu_thread.emu.memory.signed.read_byte(self.pnt + 0x0C)
+        return read_u8(self.buffer, 0x0C)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def direction(self):
         return self.rom_data.script_data.directions__by_ssb_id[0]  # TODO!!
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_north(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x134)
+        return read_u32(self.buffer, 0x134)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_west(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x138)
+        return read_u32(self.buffer, 0x138)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_south(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x13C)
+        return read_u32(self.buffer, 0x13C)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_east(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x140)
+        return read_u32(self.buffer, 0x140)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_map(self):
         return pos_in_map_coord(self.x_north, self.x_south)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_map(self):
         return pos_in_map_coord(self.y_west, self.y_east)
 
     def get_bounding_box_camera(self, map: Map):
         return (
             pos_for_display_camera(self.x_north, map.camera_x_pos), pos_for_display_camera(self.y_west, map.camera_y_pos),
             pos_for_display_camera(self.x_south, map.camera_x_pos), pos_for_display_camera(self.y_east, map.camera_y_pos)
```

## skytemple_ssb_debugger/model/ground_state/performer.py

```diff
@@ -10,95 +10,87 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from skytemple_files.common.ppmdu_config.data import Pmd2Data
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread
-from skytemple_ssb_debugger.model.address_container import AddressContainer
+from __future__ import annotations
+
+from typing import Optional, cast
+
+from range_typed_integers import u32
+from skytemple_files.common.util import read_u16, read_u8, read_u32
+
 from skytemple_ssb_debugger.model.ground_state import pos_for_display_camera, AbstractEntityWithScriptStruct, \
     pos_in_map_coord
 from skytemple_ssb_debugger.model.ground_state.map import Map
-from skytemple_ssb_debugger.threadsafe import wrap_threadsafe_emu
 
 PERFORMER_BEGIN_SCRIPT_STRUCT = 0x3C
 
 
 class Performer(AbstractEntityWithScriptStruct):
-    def __init__(self, emulator_thread: EmulatorThread, rom_data: Pmd2Data, pnt_to_block_start: int, offset: int, unionall_load_addr: AddressContainer):
-        super().__init__(emulator_thread, pnt_to_block_start, rom_data, unionall_load_addr)
-        self.offset = offset
+    @property
+    def _block_size(self):
+        # This is not the actual size, increase this if we need to read more!
+        return u32(0x140)
 
     @property
-    def pnt(self):
-        return super().pnt + self.offset
+    def _validity_offset(self) -> Optional[u32]:
+        return self._script_struct_offset  # type: ignore
 
     @property
     def _script_struct_offset(self):
         return PERFORMER_BEGIN_SCRIPT_STRUCT
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def valid(self):
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + self._script_struct_offset) > 0
+        return read_u16(self.buffer, cast(u32, self._validity_offset)) > 0
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def id(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x04)
+        return read_u16(self.buffer, 0x04)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def kind(self):
-        return self.emu_thread.emu.memory.unsigned.read_short(self.pnt + 0x06)
+        return read_u16(self.buffer, 0x06)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def hanger(self):
-        return self.emu_thread.emu.memory.signed.read_short(self.pnt + 0x0A)
+        return read_u16(self.buffer, 0x0A)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def sector(self):
-        return self.emu_thread.emu.memory.signed.read_byte(self.pnt + 0x0E)
+        return read_u8(self.buffer, 0x0E)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def direction(self):
         return self.rom_data.script_data.directions__by_ssb_id[0]  # TODO!!
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_north(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x130)
+        return read_u32(self.buffer, 0x130)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_west(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x134)
+        return read_u32(self.buffer, 0x134)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_south(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x138)
+        return read_u32(self.buffer, 0x138)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_east(self):
-        return self.emu_thread.emu.memory.unsigned.read_long(self.pnt + 0x13C)
+        return read_u32(self.buffer, 0x13C)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def x_map(self):
         return pos_in_map_coord(self.x_north, self.x_south)
 
-    @property  # type: ignore
-    @wrap_threadsafe_emu()
+    @property
     def y_map(self):
         return pos_in_map_coord(self.y_west, self.y_east)
 
     def get_bounding_box_camera(self, map: Map):
         return (
             pos_for_display_camera(self.x_north, map.camera_x_pos), pos_for_display_camera(self.y_west, map.camera_y_pos),
             pos_for_display_camera(self.x_south, map.camera_x_pos), pos_for_display_camera(self.y_east, map.camera_y_pos)
```

## skytemple_ssb_debugger/model/ground_state/ssb_file_in_ram.py

```diff
@@ -10,19 +10,20 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from typing import Optional
 
 
 class SsbFileInRam:
-    def __init__(self, file_name: str, hanger: int, hash: str = None):
+    def __init__(self, file_name: str, hanger: int, hash: Optional[str] = None):
         self.file_name = file_name
         self.hanger = hanger
         # If true, the debugger is currently breaking at this file.
         self.breaked = False
         # If breaked is true: This contains the path of the file that handles the breakpoint.
         # May either be the same as file_name, then the SsbScript or ExplorerScript file for the SSB itself
         # handles the breakpoint, or the absolute path to an ExplorerScript source file that contains a macro
```

## skytemple_ssb_debugger/model/ground_state/ssx_file_in_ram.py

```diff
@@ -10,13 +10,14 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 
 
 class SsxFileInRam:
     def __init__(self, file_name: str, hanger: int):
         self.file_name = file_name
         self.hanger = hanger
```

## skytemple_ssb_debugger/model/script_file_context/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/model/script_file_context/abstract.py

```diff
@@ -10,19 +10,19 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from abc import ABC, abstractmethod
 from typing import List, Optional, Callable, Tuple, Any
 
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.model.breakpoint_manager import BreakpointManager
 from skytemple_ssb_debugger.model.ssb_files.file import SsbLoadedFile
 
 
 class AbstractScriptFileContext(ABC):
     """TODO Doc"""
     def __init__(self):
         self._registered_ssbs: List[SsbLoadedFile] = []
@@ -46,28 +46,23 @@
     def register_ssbs_reload_handler(self, on_ssbs_reload: Callable[[str], None]):
         self._on_ssbs_reload = on_ssbs_reload
 
     def register_insert_opcode_text_mark_handler(self,
                                                  handler: Optional[Callable[[bool, str, int, int, int, bool, bool], None]]):
         self._do_insert_opcode_text_mark = handler
 
-    @property  # type: ignore
+    @property
     @abstractmethod
     def ssb_filepath(self) -> Optional[str]:
         pass
 
-    @property  # type: ignore
+    @property
     @abstractmethod
     def exps_filepath(self) -> str:
         pass
-
-    @property  # type: ignore
-    @abstractmethod
-    def breakpoint_manager(self) -> BreakpointManager:
-        pass
         
     @abstractmethod
     def on_ssb_reload(self, loaded_ssb: SsbLoadedFile):
         pass
         
     @abstractmethod
     def on_ssb_property_change(self, loaded_ssb: SsbLoadedFile, name, value):
```

## skytemple_ssb_debugger/model/script_file_context/exps_macro.py

```diff
@@ -10,89 +10,86 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import json
 import logging
 import os
 import sys
 import threading
 from functools import partial
 from typing import Callable, Optional, Dict, Tuple, TYPE_CHECKING, Any
 
 from gi.repository import GLib, Gtk
 
 from explorerscript.source_map import MacroSourceMapping
 from skytemple_files.common.project_file_manager import EXPLORERSCRIPT_INCLUSION_MAP_SUFFIX
 from skytemple_files.common.util import open_utf8
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.model.breakpoint_manager import BreakpointManager
 from skytemple_ssb_debugger.model.script_file_context.abstract import AbstractScriptFileContext
 from skytemple_ssb_debugger.model.ssb_files.file import SsbLoadedFile
 from skytemple_ssb_debugger.model.ssb_files.file_manager import SsbFileManager
 from skytemple_files.common.i18n_util import f, _
 
 if TYPE_CHECKING:
     from skytemple_ssb_debugger.controller.editor_notebook import EditorNotebookController
 logger = logging.getLogger(__name__)
 
 
 class ExpsMacroFileScriptFileContext(AbstractScriptFileContext):
     """A file context for an exps macro file. Keeps track of all macros that use the file."""
     def __init__(self, absolute_path: str, ssb_fm: SsbFileManager,
-                 breakpoint_manager: BreakpointManager, editor_notebook_controller: 'EditorNotebookController'):
+                 editor_notebook_controller: 'EditorNotebookController'):
         super().__init__()
         self._ssb_fm = ssb_fm
         self._absolute_path = absolute_path
         self._relative_path = absolute_path.replace(self._ssb_fm.project_fm.dir() + os.path.sep, "")
         if self._absolute_path == self._relative_path:
             # You gotta love path handling!
             self._relative_path = absolute_path.replace(self._ssb_fm.project_fm.dir().replace('\\', '/') + '/', "")
             assert self._absolute_path != self._relative_path
-        self._breakpoint_manager = breakpoint_manager
         self._editor_notebook_controller = editor_notebook_controller
         # A map of all managed ssb states (breakable, ram_state_up_to_date)
         self._ssbs_states: Dict[str, Tuple[bool, bool]] = {}
         self._we_triggered_the_reload = False
 
     @property
     def ssb_filepath(self) -> Optional[str]:
         return None
 
     @property
     def exps_filepath(self) -> str:
         return self._absolute_path
 
-    @property
-    def breakpoint_manager(self) -> BreakpointManager:
-        return self._breakpoint_manager
-
     def on_ssb_reload(self, loaded_ssb: SsbLoadedFile):
         logger.debug(f"{loaded_ssb.filename}: Reloaded")
         if self._on_ssbs_state_change and self._on_ssbs_reload:
             self._on_ssbs_reload(loaded_ssb.filename)
 
     def on_ssb_property_change(self, loaded_ssb: SsbLoadedFile, name, value):
         logger.debug(f"{loaded_ssb.filename}: Property change")
         self._ssbs_states[loaded_ssb.filename] = (not loaded_ssb.not_breakable, loaded_ssb.ram_state_up_to_date)
 
     def request_ssbs_state(self):
         logger.debug(f"State requested.")
         self._inform_ssbs_state_change()
-        for ssb_file in self._registered_ssbs:
-            self._on_ssbs_reload(ssb_file.filename)
+        if self._on_ssbs_reload is not None:
+            for ssb_file in self._registered_ssbs:
+                self._on_ssbs_reload(ssb_file.filename)
 
     def _inform_ssbs_state_change(self):
         if len(self._ssbs_states) < 1:
             return
         breakables, ram_states = zip(*self._ssbs_states.values())
-        self._on_ssbs_state_change(all(breakables), all(ram_states))
+        if self._on_ssbs_state_change is not None:
+            self._on_ssbs_state_change(all(breakables), all(ram_states))
 
     def load(
         self,
         load_exps: bool, load_ssbs: bool,
         load_view_callback: Callable[[str, bool, str], None],
         after_callback: Callable[[], None],
         exps_exception_callback: Callable[[Any, BaseException], None],
```

## skytemple_ssb_debugger/model/script_file_context/ssb_file.py

```diff
@@ -10,74 +10,70 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import logging
 import sys
 import threading
 from functools import partial
 from typing import Callable, Optional, TYPE_CHECKING, Tuple, Any
 
 from gi.repository import GLib
 
-from explorerscript.source_map import SourceMap, MacroSourceMapping
+from explorerscript.source_map import MacroSourceMapping
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
-from skytemple_ssb_debugger.model.breakpoint_manager import BreakpointManager
 from skytemple_ssb_debugger.model.script_file_context.abstract import AbstractScriptFileContext
 from skytemple_ssb_debugger.model.ssb_files.explorerscript import SsbHashError
 from skytemple_ssb_debugger.model.ssb_files.file import SsbLoadedFile
 
 if TYPE_CHECKING:
     from skytemple_ssb_debugger.controller.editor_notebook import EditorNotebookController
 logger = logging.getLogger(__name__)
 
 
 class SsbFileScriptFileContext(AbstractScriptFileContext):
     """Context for a script file that directly represents a single compiled SSB script."""
 
     def __init__(self, ssb_loaded_file: SsbLoadedFile, scene_type: str, scene_name: str,
-                 breakpoint_manager: BreakpointManager, editor_notebook_controller: 'EditorNotebookController'):
+                 editor_notebook_controller: 'EditorNotebookController'):
         super().__init__()
         self._ssb_file = ssb_loaded_file
         self.scene_type = scene_type
         self.scene_name = scene_name
         self._register_ssb_handler(ssb_loaded_file)
-        self._breakpoint_manager = breakpoint_manager
         self._editor_notebook_controller = editor_notebook_controller
 
     def destroy(self):
         super().destroy()
 
     @property
     def ssb_filepath(self) -> Optional[str]:
         return self._ssb_file.filename
 
     @property
     def exps_filepath(self) -> str:
         return self._ssb_file.exps.full_path
 
-    @property
-    def breakpoint_manager(self) -> BreakpointManager:
-        return self._breakpoint_manager
-
     def on_ssb_reload(self, loaded_ssb: SsbLoadedFile):
         logger.debug(f"{loaded_ssb.filename}: Reloaded")
         if self._on_ssbs_state_change:
             self._on_ssbs_reload(loaded_ssb.filename)  # type: ignore
 
     def on_ssb_property_change(self, loaded_ssb: SsbLoadedFile, name, value):
         logger.debug(f"{loaded_ssb.filename}: Property change")
         if self._on_ssbs_state_change:
             self._on_ssbs_state_change(not loaded_ssb.not_breakable, loaded_ssb.ram_state_up_to_date)
 
     def request_ssbs_state(self):
         logger.debug(f"State requested.")
+        assert self._on_ssbs_state_change is not None and self._on_ssbs_reload is not None
         self._on_ssbs_state_change(not self._ssb_file.not_breakable, self._ssb_file.ram_state_up_to_date)
         self._on_ssbs_reload(self._ssb_file.filename)
 
     def load(
         self,
         load_exps: bool, load_ssbs: bool,
         load_view_callback: Callable[[str, bool, str], None],
@@ -164,14 +160,15 @@
              error_callback: Callable[[Any, BaseException], None],
              success_callback: Callable[[], None]):
 
         logger.debug(f"Saving SSB. From exps? {save_exps}")
 
         def save_thread():
             try:
+                assert self._ssb_file is not None and self._ssb_file.file_manager is not None
                 included_exps_files = None
                 if save_exps:
                     ready_to_reload, included_exps_files = self._ssb_file.file_manager.save_from_explorerscript(
                         self._ssb_file.filename, save_text
                     )
                 else:
                     ready_to_reload = self._ssb_file.file_manager.save_from_ssb_script(
```

## skytemple_ssb_debugger/model/ssb_files/__init__.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 from abc import abstractmethod
 from typing import TYPE_CHECKING
 
 if TYPE_CHECKING:
     from skytemple_ssb_debugger.model.ssb_files.file import SsbLoadedFile
 
 
@@ -25,11 +26,11 @@
     def __init__(self, parent: 'SsbLoadedFile'):
         self.parent = parent
 
     @abstractmethod
     def load(self):
         pass
 
-    @property  # type: ignore
+    @property
     @abstractmethod
     def text(self):
         pass
```

## skytemple_ssb_debugger/model/ssb_files/explorerscript.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import logging
 import os
 from typing import Optional, TYPE_CHECKING
 
 from explorerscript.source_map import SourceMap
 from skytemple_ssb_debugger.model.ssb_files import AbstractScriptFile
```

## skytemple_ssb_debugger/model/ssb_files/file.py

```diff
@@ -10,20 +10,23 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import logging
 from typing import TYPE_CHECKING, List, Optional, Callable
 
 from explorerscript.source_map import SourceMapPositionMark
 from skytemple_files.common.project_file_manager import ProjectFileManager
 from skytemple_files.script.ssb.model import Ssb
+from skytemple_ssb_emulator import emulator_debug_set_loaded_ssb_breakable
+
 from skytemple_ssb_debugger.model.ssb_files.explorerscript import ExplorerScriptFile
 from skytemple_ssb_debugger.model.ssb_files.ssb_script import SsbScriptFile
 
 if TYPE_CHECKING:
     from skytemple_ssb_debugger.model.ssb_files.file_manager import SsbFileManager
 
 logger = logging.getLogger(__name__)
@@ -43,20 +46,23 @@
 
         # The SSB file is currently open in an editor.
         self._opened_in_editor = False
         # The SSB file is currently loaded in RAM by the Ground Engine.
         self._opened_in_ground_engine = False
         # The state in RAM differs from the currently saved SSB to ROM.
         self._ram_state_up_to_date = True
-        # The file is not debuggable at the moment, because an old state is
+        # A file is not debuggable at the moment, if an old state is
         # loaded in RAM and old breakpoint mappings
         # are not available (because the source view for it was closed).
-        self._not_breakable = False
+        self._not_breakable_cache = False
+        emulator_debug_set_loaded_ssb_breakable(self.filename, True)
 
+        # Called once, then removed.
         self._event_handlers_manager: List[Callable] = []
+        # Called once, kept.
         self._event_handlers_editor: List[Callable] = []
 
         self._event_handlers_property_change: List[Callable] = []
 
     @property
     def position_markers(self) -> Optional[List[SourceMapPositionMark]]:
         """
@@ -97,44 +103,42 @@
     @ram_state_up_to_date.setter
     def ram_state_up_to_date(self, value):
         self._ram_state_up_to_date = value
         self._trigger_property_change('ram_state_up_to_date', value)
 
     @property
     def not_breakable(self):
-        return self._not_breakable
+        return self._not_breakable_cache
 
     @not_breakable.setter
     def not_breakable(self, value):
-        self._not_breakable = value
+        self._not_breakable_cache = value
+        emulator_debug_set_loaded_ssb_breakable(self.filename, not value)
         self._trigger_property_change('not_breakable', value)
 
     def register_reload_event_manager(self, on_ssb_reload):
+        """Called once, then removed."""
         self._event_handlers_manager.append(on_ssb_reload)
 
-    def unregister_reload_event_manager(self, on_ssb_reload):
-        try:
-            self._event_handlers_manager.remove(on_ssb_reload)
-        except ValueError:
-            pass
-
     def register_reload_event_editor(self, on_ssb_reload):
+        """Called once, kept. Remove with unregister_reload_event_editor"""
         self._event_handlers_editor.append(on_ssb_reload)
 
     def unregister_reload_event_editor(self, on_ssb_reload):
         try:
             self._event_handlers_editor.remove(on_ssb_reload)
         except ValueError:
             pass
 
     def signal_editor_reload(self):
         logger.debug(f"{self.filename}: Reload triggered.")
         # Breakpoint manager update it's breakpoint
         for handler in self._event_handlers_manager:
             handler(self)
+        self._event_handlers_manager = []
         # Editors updates it's marks and uses the updated breakpoints.
         for handler in self._event_handlers_editor:
             handler(self)
 
     def register_property_callback(self, cb):
         self._event_handlers_property_change.append(cb)
```

## skytemple_ssb_debugger/model/ssb_files/file_manager.py

```diff
@@ -10,37 +10,35 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 # 
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import hashlib
 import logging
 import os
-from functools import partial
-from typing import TYPE_CHECKING, List, Tuple, Set
+from typing import TYPE_CHECKING, List, Tuple, Set, Optional
 
 from explorerscript.included_usage_map import IncludedUsageMap
 from skytemple_files.common.types.file_types import FileType
 from skytemple_files.common.util import open_utf8
 from skytemple_files.script.ssb.script_compiler import ScriptCompiler
 from skytemple_ssb_debugger.context.abstract import AbstractDebuggerControlContext
 from skytemple_ssb_debugger.model.ssb_files.file import SsbLoadedFile
-from skytemple_ssb_debugger.threadsafe import threadsafe_now_or_gtk_nonblocking
 
 if TYPE_CHECKING:
     from skytemple_ssb_debugger.controller.debugger import DebuggerController
 
 logger = logging.getLogger(__name__)
 
 
 class SsbFileManager:
-    def __init__(self, context: AbstractDebuggerControlContext, debugger: 'DebuggerController'):
-        self.debugger = debugger
+    def __init__(self, context: AbstractDebuggerControlContext):
         self.context: AbstractDebuggerControlContext = context
 
     @property
     def project_fm(self):
         return self.context.get_project_filemanager()
 
     def get(self, filename: str) -> SsbLoadedFile:
@@ -212,33 +210,33 @@
         """
         # - If the file is no longer loaded in Ground Engine: Regenerate text marks from source map.
         Is threadsafe.
         """
         self.get(filename).opened_in_ground_engine = False
         self.get(filename).not_breakable = False
         if not self.get(filename).ram_state_up_to_date:
-            threadsafe_now_or_gtk_nonblocking(lambda: self.get(filename).signal_editor_reload())
+            self.get(filename).signal_editor_reload()
         self.get(filename).ram_state_up_to_date = True
         logger.debug(f"{filename}: Closed in Ground Engine")
         pass
 
     def _handle_after_save(self, filename: str):
         """
         # - If the file is no longer loaded in Ground Engine: Regenerate text marks from source map.
         Returns whether a reload is possible.
         """
         def set_ram_state(state):
             self.get(filename).ram_state_up_to_date = state
 
         if not self.get(filename).opened_in_ground_engine:
-            threadsafe_now_or_gtk_nonblocking(partial(set_ram_state, True))
+            set_ram_state(True)
             logger.debug(f"{filename}: Can be reloaded")
             return True
         else:
-            threadsafe_now_or_gtk_nonblocking(partial(set_ram_state, False))
+            set_ram_state(False)
 
         logger.debug(f"{filename}: Can NOT be reloaded")
         return False
 
     def hash_for(self, filename: str):
         return self.hash(self.get(filename).ssb_model.original_binary_data)
```

## skytemple_ssb_debugger/model/ssb_files/ssb_script.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import logging
 from typing import Optional, TYPE_CHECKING
 
 from explorerscript.source_map import SourceMap
 from skytemple_ssb_debugger.model.ssb_files import AbstractScriptFile
 
 if TYPE_CHECKING:
```

## skytemple_ssb_debugger/pixbuf/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/pixbuf/icons.py

```diff
@@ -10,14 +10,15 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
 import math
 
 import cairo
 from gi.repository import Gdk
 
 from skytemple_ssb_debugger.controller.debug_overlay import COLOR_ACTOR, COLOR_OBJECTS, COLOR_PERFORMER
```

## skytemple_ssb_debugger/renderer/__init__.py

```diff
@@ -10,8 +10,9 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
+from __future__ import annotations
```

## skytemple_ssb_debugger/renderer/async_software.py

```diff
@@ -10,51 +10,62 @@
 #  SkyTemple is distributed in the hope that it will be useful,
 #  but WITHOUT ANY WARRANTY; without even the implied warranty of
 #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 #  GNU General Public License for more details.
 #
 #  You should have received a copy of the GNU General Public License
 #  along with SkyTemple.  If not, see <https://www.gnu.org/licenses/>.
-from threading import Lock
-from typing import Callable
+from __future__ import annotations
+from math import radians
+from typing import Optional, Callable
 
 import cairo
 from gi.repository import Gtk, GLib
+from skytemple_ssb_emulator import SCREEN_PIXEL_SIZE, SCREEN_WIDTH, SCREEN_HEIGHT, emulator_display_buffer_as_rgbx
 
-from desmume.emulator import SCREEN_PIXEL_SIZE, SCREEN_WIDTH, SCREEN_HEIGHT
-from desmume.frontend.gtk_drawing_impl.software import SoftwareRenderer
-from skytemple_ssb_debugger.emulator_thread import EmulatorThread, FRAMES_PER_SECOND
-from skytemple_ssb_debugger.threadsafe import synchronized
+FRAMES_PER_SECOND = 60
 
-image_lock = Lock()
 
-
-class AsyncSoftwareRenderer(SoftwareRenderer):
-    """Asynchronous, thread-safe implementation of the Software renderer."""
-
-    @synchronized(image_lock)
-    def __init__(self, emu_thread: EmulatorThread,
-                 top_screen: Gtk.Widget, bottom_screen: Gtk.Widget,
-                 after_render_hook: Callable[[cairo.Context, int], None] = None):
+class AsyncSoftwareRenderer:
+    def __init__(self, top_screen: Gtk.Widget, bottom_screen: Gtk.Widget,
+                 after_render_hook: Optional[Callable[[cairo.Context, int], None]] = None):
         self._boost = False
-        self._upper_image = None
-        self._lower_image = None
-        self.emu_thread = emu_thread
+        self._upper_image: Optional[cairo.ImageSurface] = None
+        self._lower_image: Optional[cairo.ImageSurface] = None
         self._after_render_hook = after_render_hook
         self.top_screen = top_screen
         self.bottom_screen = bottom_screen
-        super().__init__(None, after_render_hook)
+        self._screen_rotation_degrees = 0
+        self._scale = 1.0
+        self.decode_screen()
 
-    @synchronized(image_lock)
     def screen(self, base_w, base_h, ctx: cairo.Context, display_id: int):
         if self._upper_image is not None and self._lower_image is not None:
-            super().screen(base_w, base_h, ctx, display_id)
+            if display_id == 0:
+                self.decode_screen()
+
+            ctx.translate(base_w * self._scale / 2, base_h * self._scale / 2)
+            ctx.rotate(-radians(self._screen_rotation_degrees))
+            if self._screen_rotation_degrees == 90 or self._screen_rotation_degrees == 270:
+                ctx.translate(-base_h * self._scale / 2, -base_w * self._scale / 2)
+            else:
+                ctx.translate(-base_w * self._scale / 2, -base_h * self._scale / 2)
+            ctx.scale(self._scale, self._scale)
+            if display_id == 0:
+                ctx.set_source_surface(self._upper_image)
+            else:
+                ctx.set_source_surface(self._lower_image)
+            ctx.get_source().set_filter(cairo.Filter.NEAREST)
+            ctx.paint()
+
+            if self._after_render_hook:
+                self._after_render_hook(ctx, display_id)
 
     def decode_screen(self):
-        gpu_framebuffer = self.emu_thread.display_buffer_as_rgbx()
+        gpu_framebuffer = memoryview(bytearray(emulator_display_buffer_as_rgbx()))
         self._upper_image = cairo.ImageSurface.create_for_data(
             gpu_framebuffer[:SCREEN_PIXEL_SIZE*4], cairo.FORMAT_RGB24, SCREEN_WIDTH, SCREEN_HEIGHT
         )
 
         self._lower_image = cairo.ImageSurface.create_for_data(
             gpu_framebuffer[SCREEN_PIXEL_SIZE*4:], cairo.FORMAT_RGB24, SCREEN_WIDTH, SCREEN_HEIGHT
         )
@@ -67,9 +78,24 @@
     def _tick(self):
         if self.top_screen is None or self.bottom_screen is None:
             return False
         self.top_screen.queue_draw()
         self.bottom_screen.queue_draw()
         return True
 
+    def reshape(self, draw: Gtk.DrawingArea, display_id: int):
+        pass
+
     def set_boost(self, state):
         self._boost = state
+
+    def set_scale(self, value):
+        self._scale = value
+
+    def get_scale(self):
+        return self._scale
+
+    def get_screen_rotation(self):
+        return self._screen_rotation_degrees
+
+    def set_screen_rotation(self, value):
+        self._screen_rotation_degrees = value
```

## Comparing `skytemple_ssb_debugger-1.4.4.dist-info/LICENSE` & `skytemple_ssb_debugger-1.6.0a1.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `skytemple_ssb_debugger-1.4.4.dist-info/METADATA` & `skytemple_ssb_debugger-1.6.0a1.dist-info/METADATA`

 * *Files 4% similar despite different names*

```diff
@@ -1,43 +1,43 @@
 Metadata-Version: 2.1
 Name: skytemple-ssb-debugger
-Version: 1.4.4
+Version: 1.6.0a1
 Summary: Script Engine Debugger for Pokmon Mystery Dungeon Explorers of Sky (EU/US)
 Home-page: https://github.com/SkyTemple/skytemple-ssb-debugger
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: Python
 Classifier: License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Description-Content-Type: text/x-rst
 License-File: LICENSE
 Requires-Dist: ndspy (>=3.0.0)
-Requires-Dist: skytemple-files (>=1.4.2)
+Requires-Dist: skytemple-files (>=1.6.0a1)
 Requires-Dist: pmdsky-debug-py
 Requires-Dist: skytemple-icons (>=0.1.0)
 Requires-Dist: range-typed-integers (>=1.0.0)
 Requires-Dist: pygobject (>=3.26.0)
 Requires-Dist: pycairo (>=1.16.0)
-Requires-Dist: py-desmume (>=0.0.5)
+Requires-Dist: skytemple-ssb-emulator (>=1.6.0a1)
 Requires-Dist: explorerscript (>=0.1.2)
 Requires-Dist: nest-asyncio (>=1.4.1)
 Requires-Dist: pygtkspellcheck (>=5.0)
 
 |logo|
 
 SkyTemple Script Engine Debugger
 ================================
 
 |build| |pypi-version| |pypi-downloads| |pypi-license| |pypi-pyversions| |discord|
 
 .. |logo| image:: https://raw.githubusercontent.com/SkyTemple/skytemple-ssb-debugger/master/skytemple_ssb_debugger/data/icons/hicolor/256x256/apps/skytemple-debugger.png
 
-.. |build| image:: https://img.shields.io/github/workflow/status/SkyTemple/skytemple-ssb-debugger/Build,%20test%20and%20publish
+.. |build| image:: https://img.shields.io/github/actions/workflow/status/SkyTemple/skytemple-ssb-debugger/build-test-publish.yml
     :target: https://pypi.org/project/skytemple-ssb-debugger/
     :alt: Build Status
 
 .. |pypi-version| image:: https://img.shields.io/pypi/v/skytemple-ssb-debugger
     :target: https://pypi.org/project/skytemple-ssb-debugger/
     :alt: Version
```

## Comparing `skytemple_ssb_debugger-1.4.4.dist-info/RECORD` & `skytemple_ssb_debugger-1.6.0a1.dist-info/RECORD`

 * *Files 6% similar despite different names*

```diff
@@ -1,29 +1,31 @@
 skytemple_ssb_debugger/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-skytemple_ssb_debugger/debugger.glade,sha256=Zl3lPgF5_O_aC8KSLdT_5i-zGxFvId4mrrWk63HF8QY,226635
-skytemple_ssb_debugger/emulator_thread.py,sha256=nmm2kZFyCRYL8tHU4mlLhsbW6E-xjlMG0iJrqD7nh_M,9098
-skytemple_ssb_debugger/exps.lang,sha256=9WziwOoiiuU3tbeu1J5CqbTSHpBZq26MJCDadvjfh_4,3893
-skytemple_ssb_debugger/main.py,sha256=Ve9wrcSoSO3_-AasSHuW8ltCa1Ka3DoPOh5Tn0BTMqM,3444
+skytemple_ssb_debugger/debugger.glade,sha256=VK8H0VOBM5xiHgooYXVjKl5vZYAmmr9poS83L8xNyG8,226747
+skytemple_ssb_debugger/exps.lang,sha256=ExsSzRK6euwMiacfWjR0pGTIAG-2HkBidVN5bZpawcY,3928
+skytemple_ssb_debugger/main.py,sha256=0oNuYwK1ULzBt05hvvgj1k-fTgX30uCXwfUp789GfU4,3411
 skytemple_ssb_debugger/py.typed,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
-skytemple_ssb_debugger/ssbs.lang,sha256=NnC3ORcL7XAZVVihjEAggvFKt6uZ6pzGGSTf4rYKFHc,6028
-skytemple_ssb_debugger/threadsafe.py,sha256=sSe75KkvfbYiAJVcHLQqSxYZ-eygHu1BTpLhlzaYzpo,6091
-skytemple_ssb_debugger/context/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/context/abstract.py,sha256=UXLxHgHcx_Ad-lxdYu72DmSAlvEgP1-CtbZgWWcG2vI,8127
-skytemple_ssb_debugger/context/standalone.py,sha256=kgarvRSY5Z8iB-6Epn0ignzKEriRPNfza5aPAc2qWzk,7698
-skytemple_ssb_debugger/controller/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/controller/debug_overlay.py,sha256=kc8xALV79PX6t9D20dgRL7YWPekddNwMiQTNIyDwtfY,7996
-skytemple_ssb_debugger/controller/debugger.py,sha256=KJocUkp52sVBDZLgljGMjJTW6F349IB4p3ypcUYN7zY,20859
-skytemple_ssb_debugger/controller/editor_notebook.py,sha256=IuGIK3EG2XUck-4-yE1ln2MzMkoJ3Lnc-7fNqEhODA8,17516
-skytemple_ssb_debugger/controller/global_state.py,sha256=TfmvDorO18eKL5ENS2GJJ0ozXDhvDoLW6c2rf41hIPI,7303
-skytemple_ssb_debugger/controller/ground_state.py,sha256=8Bkok7aOYPsgP22OOIpu08e-CVfl92KYY2R5BuUWZKk,18606
-skytemple_ssb_debugger/controller/local_variable.py,sha256=OcW3UsvTVdtaiIExyNhx5riYaESZ3bZIjKnNtez2cac,5609
-skytemple_ssb_debugger/controller/main.py,sha256=wVkxAwp-Yi0fPOHa8rweCngjTXTquMcceX-O6ezmc3A,77862
-skytemple_ssb_debugger/controller/script_editor.py,sha256=vKEmOfH1pI3Fu7fKF_3W1bJey3PN5-nGFndY1MpbKwo,48242
+skytemple_ssb_debugger/ssbs.lang,sha256=nrmDbZjFOFlPZvzAYXkskumZsIcmbvmdXGQRbC-z4jo,6063
+skytemple_ssb_debugger/context/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/context/abstract.py,sha256=Ue-OwyCsNVq_7JZx6pPfLFb254wFJwZIfnOR2xlsLXQ,8162
+skytemple_ssb_debugger/context/standalone.py,sha256=YgrTp2xmjCYizWy1X8gLCX_S-7bLDL1PzY3BHwoEcLo,7809
+skytemple_ssb_debugger/controller/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/controller/debug_overlay.py,sha256=yy3c11u6uy8oOC_1VOvoP-sPLcopzjCW-zHLGXz9hIc,7533
+skytemple_ssb_debugger/controller/debugger.py,sha256=yLV3TLA-s0bq5qZjC6e4OSYfYOCGz0ZA7hT_P8E0czs,6954
+skytemple_ssb_debugger/controller/editor_notebook.py,sha256=DSoqO0A3-RSVBhGabVIRTQfGXAXpm9MAbJY2Du3xhhA,17241
+skytemple_ssb_debugger/controller/global_state.py,sha256=D1-gmAUOWPCrE6NUGQNOOrdgj927WVrLhfZVaQ4HN1g,4182
+skytemple_ssb_debugger/controller/ground_state.py,sha256=DxgCD84U07lrQcTDzwm-8liTbTmgoKjoBzW_YHtUJhc,18676
+skytemple_ssb_debugger/controller/local_variable.py,sha256=mfKu0IlNTAFY_WBD0ZSfhaO2I64WH6DbE7B1HpShqWg,4848
+skytemple_ssb_debugger/controller/main.py,sha256=2siJqJ-xxR1V0aWBFtlqU8aWXrBvyWLMO4kvydFxU2M,79131
+skytemple_ssb_debugger/controller/script_editor.py,sha256=0QviX66fb5LrYWoz-8yfYQUZXXxJGGnCF8dJuaShhkQ,48721
 skytemple_ssb_debugger/controller/ssb_editor.glade,sha256=KKAjOOa1FJqo7Es6UcUpP390M50yh8Xefc4dVzSh4ok,29755
-skytemple_ssb_debugger/controller/variable.py,sha256=7edSKVLdh9us-VxTdgAf3e7w2-ri0XAfhi2dBZYlmLI,19625
+skytemple_ssb_debugger/controller/variable.py,sha256=HtzANTeuuWaXRDAAD379j-6EEXOo5bgfyf5UZhIr0Zg,17233
+skytemple_ssb_debugger/controller/desmume_control_ui/PyDeSmuMe_controls.glade,sha256=MA1N17B3jRvkDMGFMlzY6UQLsP1fjHq2cxzN23dJDkc,59943
+skytemple_ssb_debugger/controller/desmume_control_ui/__init__.py,sha256=duYFhO3PDMty0xy494QTVrf0alJue0B0FgqisNPXjqY,1773
+skytemple_ssb_debugger/controller/desmume_control_ui/joystick_controls.py,sha256=HWZDYpZO-bo_HVhQ3H3kArxQ2OxSoB2C_R0QziWcUF8,4862
+skytemple_ssb_debugger/controller/desmume_control_ui/keyboard_controls.py,sha256=bEa84gvzhJBJHxrM5mI7AcIwOsZWRACZNAlcPHmYbpA,3781
 skytemple_ssb_debugger/data/icons/hicolor/1024x1024/apps/skytemple-debugger.png,sha256=8JA3Z7jE5c8r_ukJhcfHrFuuLgTRSTbkxk7Rh6hbXbQ,967861
 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-debug-symbolic.symbolic.png,sha256=xSCzel1dIj7RW6bvfM9LkIBWz8B0nzwbHTBbmJjXY54,5442
 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-disable-breaks-symbolic.symbolic.png,sha256=NtgUKNvwo8zDF1d7wxzHaygWwS46J3WD5Ee-WkMevYI,2495
 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-into-symbolic.symbolic.png,sha256=OIcmNX_zaBsYTWL5SiP5nY1uN01UeTSmmQN44MjlFNs,837
 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-next-symbolic.symbolic.png,sha256=i_HyPBSx246Bm1PnXP6S6UT8Kn8IPjZP75R9RQ_9OGE,1287
 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-out-symbolic.symbolic.png,sha256=yBf7C2CTWumgjFjUhjKTokasecSO8ykaZJ-_8UjfKaQ,768
 skytemple_ssb_debugger/data/icons/hicolor/128x128/apps/skytemple-debugger-step-over-symbolic.symbolic.png,sha256=DkdIDmq4MiUrEmtqSzFtfAbczhBQITpUZtUmlx1oCyI,564
@@ -65,55 +67,51 @@
 skytemple_ssb_debugger/data/icons/hicolor/64x64/apps/skytemple-debugger.png,sha256=iNcqAiDyIxOwzslmLfvhvkvuraogN-4wcilvr8JVVy4,19434
 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-debug-symbolic.svg,sha256=WpRKffGV0wrtuwxfOetpOgH89qlAD8BebLvw_OeMv0w,12862
 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-disable-breaks-symbolic.svg,sha256=L_L2phZoG0m-LJZI_gsf68xXk41lkTm_kFMIXFFIU18,4900
 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-into-symbolic.svg,sha256=9Lgd7sMFYd4AHcKSrib1QETUbLTknH1slvuTahgh4CI,6943
 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-next-symbolic.svg,sha256=Y95iiDqv7JM92cC1A_I1P9NWp8ea4xC7TBm7AmLCREw,7357
 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-out-symbolic.svg,sha256=fW818vzfYk6W4oqF_A74iEi2Rf8BueF8_78I-FgfnsU,6986
 skytemple_ssb_debugger/data/icons/hicolor/scalable/apps/skytemple-debugger-step-over-symbolic.svg,sha256=Wy1HBMlN8vpe-LHknj8HZcf5OpEKiQzaQyPjhmz9pMs,6939
-skytemple_ssb_debugger/model/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/model/address_container.py,sha256=69B0GdXytfZ-T6ahhG9qZnd8hW4maJm_w2o8HFpJl38,1193
-skytemple_ssb_debugger/model/breakpoint_file_state.py,sha256=13u7y2lLWX02QzGVMvweIJdl4dh31kg3cxYBK2KTNwY,5832
-skytemple_ssb_debugger/model/breakpoint_manager.py,sha256=OWg-bw9xHm62qFSVZpPGVGR5jKVLyWHUOVO--psof8U,8163
-skytemple_ssb_debugger/model/breakpoint_state.py,sha256=GIDPOTwSHSKtmRxFz13Ef4JyWhgqgHR5AC8UOv4gDY8,6073
-skytemple_ssb_debugger/model/constants.py,sha256=EHQ07SErYxk_nZu1jWrzns21ZC_mcWFsiiYzoO6VxFw,1047
-skytemple_ssb_debugger/model/editor_text_mark_util.py,sha256=CsAHuewNL7z3Fup0BZ5hWvWXILHMdkLqCCYUM2uqcMc,7267
-skytemple_ssb_debugger/model/game_variable.py,sha256=7nLvspe8na1wcohITZcxIGgtvPv2EZGqdore9winvW4,11584
-skytemple_ssb_debugger/model/ground_engine_state.py,sha256=JUrOF7HH0xNrR7LpaUFq9R5cPsctVyddfKEAwIyzUDU,17365
-skytemple_ssb_debugger/model/script_runtime_struct.py,sha256=3ZWw2bHiBgvp0gTCuKNKtwFBwmTrRM1N_054Phx8tY0,6953
-skytemple_ssb_debugger/model/settings.py,sha256=Sw7YHrno6AtH7lphpl8Y8nyoZCZbX4vnIEop1iPvipQ,7599
-skytemple_ssb_debugger/model/completion/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/model/completion/constants.py,sha256=bAP2fUkkyAax1cjmz-0qNyn6aFU7vWTp8l0vV20ssYM,4902
-skytemple_ssb_debugger/model/completion/exps_statements.py,sha256=49F1sri1UFXImFBv6Ll6soYsKV0smwMsp_zuwpi3w7Q,3183
-skytemple_ssb_debugger/model/completion/functions.py,sha256=8cNlfUMCk2w44l3yhMSCv8M2t7qWQLRLmzox2K9refA,3181
-skytemple_ssb_debugger/model/completion/util.py,sha256=cPgDH2nYc13G4egPAK4Y0ESRggd3Hz_CJir2pU5lfzs,3149
-skytemple_ssb_debugger/model/completion/calltips/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/model/completion/calltips/calltip_emitter.py,sha256=AnnurfNhquNf0e8kCxggTCuWkJm-UyApWt0nB4m1Vd4,6948
-skytemple_ssb_debugger/model/completion/calltips/position_mark.py,sha256=3XlojhV2NU3LTmvF8GKA6nKPaWdioMJBGAYYBiiEC2M,5850
-skytemple_ssb_debugger/model/completion/calltips/string_event_emitter.py,sha256=rO7BE8WfeDKgNdCD0ax_9Z1fRk3pncT-geaLrMybXlI,3354
-skytemple_ssb_debugger/model/ground_state/__init__.py,sha256=KjZF3DQB6F43a5Yno7RzHOf6gSgw_DF9r-bdtMz_TmI,2908
-skytemple_ssb_debugger/model/ground_state/actor.py,sha256=mjdAC2t8XUZdRgxGxJEManVsOJgN-j9EsNUgrWHUkk8,4363
-skytemple_ssb_debugger/model/ground_state/event.py,sha256=-HSXKlmqDoFwcOTSNzcVFfqCL7lJukhfG982DljkvF0,3682
-skytemple_ssb_debugger/model/ground_state/global_script.py,sha256=S6VcSZoTVbQQr1rSZVTk8c9QGrHnNcUKRX6KMTjyPM8,1372
-skytemple_ssb_debugger/model/ground_state/map.py,sha256=gMuDTO4NSVAD0LvhENPLC4d8BqSHmV60d3KViAAjTtw,1833
-skytemple_ssb_debugger/model/ground_state/object.py,sha256=lYdLWxfrlArZbwAMKRKZbr2SEEQQ5hHWXFJ9yZJ_Xw8,4264
-skytemple_ssb_debugger/model/ground_state/performer.py,sha256=riN0RPX65uiqW_TrKHyrPtDnni2ERsfOYKITQSAj8UQ,3940
-skytemple_ssb_debugger/model/ground_state/ssb_file_in_ram.py,sha256=ZJwYn1u5MQFRxhS7oZmlwqeVZXM2NogkGqBE5Jyuk5o,1549
-skytemple_ssb_debugger/model/ground_state/ssx_file_in_ram.py,sha256=qXgqzggXZx8oRF14Ywbvxyq7jybAU55m5k3lzho5ZVI,877
-skytemple_ssb_debugger/model/script_file_context/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/model/script_file_context/abstract.py,sha256=OQl_ZEb5IeZfHniAY-dxadyPNe0ycWjWXLTgg3JbOTo,4818
-skytemple_ssb_debugger/model/script_file_context/exps_macro.py,sha256=KzNZXi02gS2qAKKPaxo5Gz1AiqyfKXHPzb_rCB14HQc,13832
-skytemple_ssb_debugger/model/script_file_context/ssb_file.py,sha256=cbU43QP6lB8NdztKkzNytTzAHv-nGitDGKf2NgwLBMI,11321
-skytemple_ssb_debugger/model/ssb_files/__init__.py,sha256=w0sCk-aUJPGFLvIykXsQVP6AA1zMRO0-qj6mnCKq0kA,1139
-skytemple_ssb_debugger/model/ssb_files/explorerscript.py,sha256=Xc528FiwPfmqHVLphb5IoMbTLRdPeX_HaxtTlnSt-ZM,3236
-skytemple_ssb_debugger/model/ssb_files/file.py,sha256=mqQIc4rbSKc_St0ac4zBFLECnU3W3WobIW0cp7jreWA,5733
-skytemple_ssb_debugger/model/ssb_files/file_manager.py,sha256=6bap-pt6kofIaCPdlaYLENeczJoMJjj8yD-YwO4WEcc,11435
-skytemple_ssb_debugger/model/ssb_files/ssb_script.py,sha256=_RgvtObz5Oxyff5yUitKyU7DYJNq-qv7pKAD3h4x3uM,1767
-skytemple_ssb_debugger/pixbuf/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/pixbuf/icons.py,sha256=vJGrwvydtXOK60TAJowxMne0EFv9s4_ImpRQKPAjlZU,3391
-skytemple_ssb_debugger/renderer/__init__.py,sha256=-k8EgiUK1mjNnmaq2pXo30tl-Dhfxz8z2fO0ZePTVZo,739
-skytemple_ssb_debugger/renderer/async_software.py,sha256=VuqYRIKyE3iSulj2XpOFxQqxhJyHOHCTedb3Do1SeDg,2952
-skytemple_ssb_debugger-1.4.4.dist-info/LICENSE,sha256=ixuiBLtpoK3iv89l7ylKkg9rs2GzF9ukPH7ynZYzK5s,35148
-skytemple_ssb_debugger-1.4.4.dist-info/METADATA,sha256=G1VHPjBq8HlInCbO8m_eClT0BL7Yc9jHW1T5NW5S42U,2572
-skytemple_ssb_debugger-1.4.4.dist-info/WHEEL,sha256=2wepM1nk4DS4eFpYrW1TTqPcoGNfHhhO_i5m4cOimbo,92
-skytemple_ssb_debugger-1.4.4.dist-info/entry_points.txt,sha256=vDMh1RiToam3T2DwLgMMzIFXtPLKHi8u-RJDOq2quBw,76
-skytemple_ssb_debugger-1.4.4.dist-info/top_level.txt,sha256=7BeY_h3SrlUZfJJACPiZTGiwJCN2HRR9t65uJbXcCOU,23
-skytemple_ssb_debugger-1.4.4.dist-info/RECORD,,
+skytemple_ssb_debugger/model/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/model/breakpoint_file_state.py,sha256=VLKDjGvP3idNR9ozkMx6nnmRCw57dU-V_B5AbXKJ-Ow,5844
+skytemple_ssb_debugger/model/constants.py,sha256=NZfwLptfq9_EkKTE2etGM-qHGU-cWZ-J9UcGKij_oQc,1082
+skytemple_ssb_debugger/model/editor_text_mark_util.py,sha256=p-ku9S0Fav2p2hhCoLOS0KgKAn7btGvvT6GzGObef9c,7302
+skytemple_ssb_debugger/model/ground_engine_state.py,sha256=NfE4dvxyKcd4whUR4_XBbwRqMW3JIUc7T1vBT-Ca7gs,16201
+skytemple_ssb_debugger/model/script_runtime_struct.py,sha256=6Ffadzb92B-3JRZahaxTB6u8GYARa526cdYzt_9ZDOM,6181
+skytemple_ssb_debugger/model/settings.py,sha256=FXiRGM5u_jYUlQS2DDTl0CYCNTiiTnqID3iDtdC_w3k,7062
+skytemple_ssb_debugger/model/completion/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/model/completion/constants.py,sha256=WonwIE3Ee2RBxpNP7hle90MvWr6BXzemPGp2WDCKyhE,4934
+skytemple_ssb_debugger/model/completion/exps_statements.py,sha256=Scrb_qF71Tc5Y1bOplx170CyaTFqNthfiINbRKRgGGk,3215
+skytemple_ssb_debugger/model/completion/functions.py,sha256=Vc_8VUfSYbIljn5Zd86AeQOgUPh_Mge2BHE2bu8fz7M,3213
+skytemple_ssb_debugger/model/completion/util.py,sha256=lSprx1HPFiuURFEAKMqyHHMm8Mh3XocueOrgakoxUO4,3184
+skytemple_ssb_debugger/model/completion/calltips/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/model/completion/calltips/calltip_emitter.py,sha256=d3K1E9jaWURqh37LEQOsss_Xt3DsMDqw7F7xOrD-GcI,6983
+skytemple_ssb_debugger/model/completion/calltips/position_mark.py,sha256=fwhTqSnG2vvaAlbD-VDEqj0b8OkwtAos1rKws4yQo_Y,5885
+skytemple_ssb_debugger/model/completion/calltips/string_event_emitter.py,sha256=vzvAnomPDVUXg6-aR_E3AxYBuhClIK_l0sQIdwK1nl8,3094
+skytemple_ssb_debugger/model/ground_state/__init__.py,sha256=NcSuSIVWkipLnTILT-RVRzPWuQrvGeN6LMyRrEbMdUA,3450
+skytemple_ssb_debugger/model/ground_state/actor.py,sha256=8oUDnzlg4fa3rnq2LXiaHk1PL71zRkm2rwWa1ln2U2A,3302
+skytemple_ssb_debugger/model/ground_state/event.py,sha256=I95PGzvmAgb5zX5eA1Xmlz_hBRO55oOqMvpL8nnc474,2686
+skytemple_ssb_debugger/model/ground_state/global_script.py,sha256=d55OZHZ5qXW1T2m0UTTrRRrQox9GSXnMLRaD8aV0CZY,1252
+skytemple_ssb_debugger/model/ground_state/map.py,sha256=eG_D5cVgnJMMlxNDCw02i4NrjnxLKopY_KVWNFJFkow,1503
+skytemple_ssb_debugger/model/ground_state/object.py,sha256=2S17uPZA9XF_3hrXupaah1DAFMTgbfAS568kSZI-wo0,3243
+skytemple_ssb_debugger/model/ground_state/performer.py,sha256=vsdnOskau7GBMgF3zJ5S_AlHU0sQTgD4cyRgIBN6FSg,2941
+skytemple_ssb_debugger/model/ground_state/ssb_file_in_ram.py,sha256=u2I0-mHZGrDaTIQaBonGT0W__Glu5Ab_UkKZij7EmQo,1594
+skytemple_ssb_debugger/model/ground_state/ssx_file_in_ram.py,sha256=ajqYtF4awFrgvZnmJyFhh_b-oFgTs7z0KUCJD1ENeTM,912
+skytemple_ssb_debugger/model/script_file_context/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/model/script_file_context/abstract.py,sha256=4M8P3efpB72cHAR5w8pZ9U6N5otm94N5dwO3abD9olc,4624
+skytemple_ssb_debugger/model/script_file_context/exps_macro.py,sha256=lS5mfDq-7A8qusNg3GK9uta5In0ExQKw_N9cs8uyRWU,13694
+skytemple_ssb_debugger/model/script_file_context/ssb_file.py,sha256=zuRt815wakqcdCYbcJglJs7lMSIEPwZ8Tk-9XaSQn1s,11249
+skytemple_ssb_debugger/model/ssb_files/__init__.py,sha256=He2ZdHqssO5z6eisr8ep6RxZfEkvjD7olUC7LY6A854,1158
+skytemple_ssb_debugger/model/ssb_files/explorerscript.py,sha256=qEZYNsFc_86wjJCaC5X7rvLdKp8H9o82yUBaenwz7cY,3271
+skytemple_ssb_debugger/model/ssb_files/file.py,sha256=26rxzXM-5rkbtJ0-I8ZOPBP7ZvlNy22mc7zWYOcKLCE,6040
+skytemple_ssb_debugger/model/ssb_files/file_manager.py,sha256=ZZ_fl4oz-vohdauiCAnPM06sLvrkXVz8zLNICThcp_I,11174
+skytemple_ssb_debugger/model/ssb_files/ssb_script.py,sha256=pR6G4IM6DzEgxr1wlHfjy6iPFld86s3Y5eGrzyBeejo,1802
+skytemple_ssb_debugger/pixbuf/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/pixbuf/icons.py,sha256=SeGUZDi-Oqz_tFxjuskqo-1AjeV01evIyD1j6UTrsw8,3426
+skytemple_ssb_debugger/renderer/__init__.py,sha256=1Z8FNSPH5A9eiutE5r_kKx2si6Jwa_lRD4qE3yK_Fhs,774
+skytemple_ssb_debugger/renderer/async_software.py,sha256=mpeUxWjBNSYLY5u34g1Gb1NlQu7GBAYsg_Zod9OZAuA,3904
+skytemple_ssb_debugger-1.6.0a1.dist-info/LICENSE,sha256=ixuiBLtpoK3iv89l7ylKkg9rs2GzF9ukPH7ynZYzK5s,35148
+skytemple_ssb_debugger-1.6.0a1.dist-info/METADATA,sha256=8P0Ak1AJLcqqe_twAL9y86GhppqlmCNEe_XAZyOyqQI,2591
+skytemple_ssb_debugger-1.6.0a1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+skytemple_ssb_debugger-1.6.0a1.dist-info/entry_points.txt,sha256=vDMh1RiToam3T2DwLgMMzIFXtPLKHi8u-RJDOq2quBw,76
+skytemple_ssb_debugger-1.6.0a1.dist-info/top_level.txt,sha256=7BeY_h3SrlUZfJJACPiZTGiwJCN2HRR9t65uJbXcCOU,23
+skytemple_ssb_debugger-1.6.0a1.dist-info/RECORD,,
```

